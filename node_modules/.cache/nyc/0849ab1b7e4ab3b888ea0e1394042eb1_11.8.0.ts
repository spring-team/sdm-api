"use strict";/*
 * Copyright Â© 2018 Atomist, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var cov_jol20qds5=function(){var path="/Users/rodjohnson/sforzando-dev/idea-projects/my-flow/src/common/delivery/goals/support/storeGoals.ts",hash="fb9b90fb7c98aea91af6a2953b0ce433438279f1",Function=function(){}.constructor,global=new Function('return this')(),gcv="__coverage__",coverageData={path:"/Users/rodjohnson/sforzando-dev/idea-projects/my-flow/src/common/delivery/goals/support/storeGoals.ts",statementMap:{"0":{start:{line:17,column:0},end:{line:17,column:62}},"1":{start:{line:18,column:28},end:{line:18,column:65}},"2":{start:{line:19,column:24},end:{line:19,column:87}},"3":{start:{line:20,column:10},end:{line:20,column:27}},"4":{start:{line:21,column:21},end:{line:21,column:42}},"5":{start:{line:22,column:23},end:{line:22,column:90}},"6":{start:{line:23,column:26},end:{line:23,column:74}},"7":{start:{line:24,column:15},end:{line:24,column:33}},"8":{start:{line:26,column:4},end:{line:26,column:58}},"9":{start:{line:28,column:0},end:{line:28,column:50}},"10":{start:{line:30,column:24},end:{line:30,column:42}},"11":{start:{line:31,column:21},end:{line:32,column:46}},"12":{start:{line:33,column:17},end:{line:35,column:42}},"13":{start:{line:36,column:20},end:{line:36,column:346}},"14":{start:{line:37,column:4},end:{line:37,column:115}},"15":{start:{line:38,column:4},end:{line:38,column:105}},"16":{start:{line:40,column:0},end:{line:40,column:32}},"17":{start:{line:42,column:4},end:{line:42,column:91}},"18":{start:{line:44,column:0},end:{line:44,column:60}},"19":{start:{line:46,column:4},end:{line:49,column:6}},"20":{start:{line:51,column:0},end:{line:51,column:72}},"21":{start:{line:53,column:69},end:{line:53,column:79}},"22":{start:{line:54,column:24},end:{line:54,column:90}},"23":{start:{line:55,column:4},end:{line:57,column:5}},"24":{start:{line:56,column:8},end:{line:56,column:109}},"25":{start:{line:58,column:4},end:{line:60,column:5}},"26":{start:{line:59,column:8},end:{line:59,column:106}},"27":{start:{line:61,column:26},end:{line:61,column:28}},"28":{start:{line:62,column:24},end:{line:62,column:57}},"29":{start:{line:63,column:24},end:{line:63,column:49}},"30":{start:{line:64,column:4},end:{line:70,column:5}},"31":{start:{line:65,column:8},end:{line:69,column:13}},"32":{start:{line:65,column:55},end:{line:69,column:9}},"33":{start:{line:71,column:4},end:{line:93,column:6}},"34":{start:{line:95,column:0},end:{line:95,column:44}},"35":{start:{line:97,column:4},end:{line:97,column:65}},"36":{start:{line:98,column:4},end:{line:99,column:29}},"37":{start:{line:99,column:20},end:{line:99,column:27}},"38":{start:{line:101,column:0},end:{line:101,column:30}},"39":{start:{line:103,column:4},end:{line:109,column:6}},"40":{start:{line:112,column:4},end:{line:128,column:5}},"41":{start:{line:115,column:12},end:{line:115,column:45}},"42":{start:{line:117,column:12},end:{line:117,column:45}},"43":{start:{line:119,column:12},end:{line:119,column:54}},"44":{start:{line:121,column:12},end:{line:121,column:43}},"45":{start:{line:123,column:12},end:{line:123,column:43}},"46":{start:{line:125,column:12},end:{line:125,column:29}},"47":{start:{line:127,column:12},end:{line:127,column:59}},"48":{start:{line:130,column:0},end:{line:130,column:52}}},fnMap:{"0":{name:"environmentFromGoal",decl:{start:{line:25,column:9},end:{line:25,column:28}},loc:{start:{line:25,column:35},end:{line:27,column:1}},line:25},"1":{name:"updateGoal",decl:{start:{line:29,column:9},end:{line:29,column:19}},loc:{start:{line:29,column:41},end:{line:39,column:1}},line:29},"2":{name:"goalCorrespondsToSdmGoal",decl:{start:{line:41,column:9},end:{line:41,column:33}},loc:{start:{line:41,column:49},end:{line:43,column:1}},line:41},"3":{name:"constructSdmGoalImplementation",decl:{start:{line:45,column:9},end:{line:45,column:39}},loc:{start:{line:45,column:44},end:{line:50,column:1}},line:45},"4":{name:"constructSdmGoal",decl:{start:{line:52,column:9},end:{line:52,column:25}},loc:{start:{line:52,column:43},end:{line:94,column:1}},line:52},"5":{name:"(anonymous_5)",decl:{start:{line:65,column:49},end:{line:65,column:50}},loc:{start:{line:65,column:55},end:{line:69,column:9}},line:65},"6":{name:"storeGoal",decl:{start:{line:96,column:9},end:{line:96,column:18}},loc:{start:{line:96,column:33},end:{line:100,column:1}},line:96},"7":{name:"(anonymous_7)",decl:{start:{line:99,column:14},end:{line:99,column:15}},loc:{start:{line:99,column:20},end:{line:99,column:27}},line:99},"8":{name:"constructProvenance",decl:{start:{line:102,column:9},end:{line:102,column:28}},loc:{start:{line:102,column:34},end:{line:110,column:1}},line:102},"9":{name:"descriptionFromState",decl:{start:{line:111,column:9},end:{line:111,column:29}},loc:{start:{line:111,column:43},end:{line:129,column:1}},line:111}},branchMap:{"0":{loc:{start:{line:31,column:21},end:{line:32,column:46}},type:"cond-expr",locations:[{start:{line:31,column:39},end:{line:31,column:63}},{start:{line:32,column:8},end:{line:32,column:46}}],line:31},"1":{loc:{start:{line:32,column:8},end:{line:32,column:46}},type:"cond-expr",locations:[{start:{line:32,column:19},end:{line:32,column:34}},{start:{line:32,column:37},end:{line:32,column:46}}],line:32},"2":{loc:{start:{line:33,column:17},end:{line:35,column:42}},type:"cond-expr",locations:[{start:{line:34,column:8},end:{line:34,column:19}},{start:{line:35,column:8},end:{line:35,column:42}}],line:33},"3":{loc:{start:{line:35,column:8},end:{line:35,column:42}},type:"cond-expr",locations:[{start:{line:35,column:19},end:{line:35,column:30}},{start:{line:35,column:33},end:{line:35,column:42}}],line:35},"4":{loc:{start:{line:36,column:55},end:{line:36,column:160}},type:"cond-expr",locations:[{start:{line:36,column:123},end:{line:36,column:145}},{start:{line:36,column:148},end:{line:36,column:160}}],line:36},"5":{loc:{start:{line:36,column:55},end:{line:36,column:120}},type:"binary-expr",locations:[{start:{line:36,column:55},end:{line:36,column:81}},{start:{line:36,column:85},end:{line:36,column:93}},{start:{line:36,column:97},end:{line:36,column:120}}],line:36},"6":{loc:{start:{line:36,column:264},end:{line:36,column:297}},type:"cond-expr",locations:[{start:{line:36,column:275},end:{line:36,column:292}},{start:{line:36,column:295},end:{line:36,column:297}}],line:36},"7":{loc:{start:{line:42,column:11},end:{line:42,column:90}},type:"binary-expr",locations:[{start:{line:42,column:11},end:{line:42,column:37}},{start:{line:42,column:41},end:{line:42,column:90}}],line:42},"8":{loc:{start:{line:54,column:24},end:{line:54,column:90}},type:"binary-expr",locations:[{start:{line:54,column:24},end:{line:54,column:46}},{start:{line:54,column:50},end:{line:54,column:90}}],line:54},"9":{loc:{start:{line:55,column:4},end:{line:57,column:5}},type:"if",locations:[{start:{line:55,column:4},end:{line:57,column:5}},{start:{line:55,column:4},end:{line:57,column:5}}],line:55},"10":{loc:{start:{line:58,column:4},end:{line:60,column:5}},type:"if",locations:[{start:{line:58,column:4},end:{line:60,column:5}},{start:{line:58,column:4},end:{line:60,column:5}}],line:58},"11":{loc:{start:{line:64,column:4},end:{line:70,column:5}},type:"if",locations:[{start:{line:64,column:4},end:{line:70,column:5}},{start:{line:64,column:4},end:{line:70,column:5}}],line:64},"12":{loc:{start:{line:90,column:26},end:{line:90,column:101}},type:"cond-expr",locations:[{start:{line:90,column:61},end:{line:90,column:93}},{start:{line:90,column:96},end:{line:90,column:101}}],line:90},"13":{loc:{start:{line:112,column:4},end:{line:128,column:5}},type:"switch",locations:[{start:{line:113,column:8},end:{line:113,column:23}},{start:{line:114,column:8},end:{line:115,column:45}},{start:{line:116,column:8},end:{line:117,column:45}},{start:{line:118,column:8},end:{line:119,column:54}},{start:{line:120,column:8},end:{line:121,column:43}},{start:{line:122,column:8},end:{line:123,column:43}},{start:{line:124,column:8},end:{line:125,column:29}},{start:{line:126,column:8},end:{line:127,column:59}}],line:112}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0,0,0,0,0,0,0]},_coverageSchema:"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c"},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();cov_jol20qds5.s[0]++;Object.defineProperty(exports,"__esModule",{value:true});const automation_client_1=(cov_jol20qds5.s[1]++,require("@atomist/automation-client"));const MessageClient_1=(cov_jol20qds5.s[2]++,require("@atomist/automation-client/spi/message/MessageClient"));const _=(cov_jol20qds5.s[3]++,require("lodash"));const sprintf_js_1=(cov_jol20qds5.s[4]++,require("sprintf-js"));const approvalGate_1=(cov_jol20qds5.s[5]++,require("../../../../handlers/events/delivery/verify/approvalGate"));const sdmGoalIngester_1=(cov_jol20qds5.s[6]++,require("../../../../ingesters/sdmGoalIngester"));const Goal_1=(cov_jol20qds5.s[7]++,require("../Goal"));function environmentFromGoal(goal){cov_jol20qds5.f[0]++;cov_jol20qds5.s[8]++;return goal.definition.environment.replace(/\/$/,"");// remove trailing slash at least
}cov_jol20qds5.s[9]++;exports.environmentFromGoal=environmentFromGoal;function updateGoal(ctx,before,params){cov_jol20qds5.f[1]++;const description=(cov_jol20qds5.s[10]++,params.description);const approval=(cov_jol20qds5.s[11]++,params.approved?(cov_jol20qds5.b[0][0]++,constructProvenance(ctx)):(cov_jol20qds5.b[0][1]++,!!before?(cov_jol20qds5.b[1][0]++,before.approval):(cov_jol20qds5.b[1][1]++,undefined)));const data=(cov_jol20qds5.s[12]++,params.data?(cov_jol20qds5.b[2][0]++,params.data):(cov_jol20qds5.b[2][1]++,!!before?(cov_jol20qds5.b[3][0]++,before.data):(cov_jol20qds5.b[3][1]++,undefined)));const sdmGoal=(cov_jol20qds5.s[13]++,Object.assign({},before,{state:(cov_jol20qds5.b[5][0]++,params.state==="success")&&(cov_jol20qds5.b[5][1]++,!!before)&&(cov_jol20qds5.b[5][2]++,before.approvalRequired)?(cov_jol20qds5.b[4][0]++,"waiting_for_approval"):(cov_jol20qds5.b[4][1]++,params.state),description,url:params.url,approval,ts:Date.now(),provenance:[constructProvenance(ctx)].concat(!!before?(cov_jol20qds5.b[6][0]++,before.provenance):(cov_jol20qds5.b[6][1]++,[])),error:_.get(params,"error.message"),data}));cov_jol20qds5.s[14]++;automation_client_1.logger.debug("Updating SdmGoal %s to %s: %j",sdmGoal.externalKey,sdmGoal.state,sdmGoal);cov_jol20qds5.s[15]++;return ctx.messageClient.send(sdmGoal,MessageClient_1.addressEvent(sdmGoalIngester_1.GoalRootType));}cov_jol20qds5.s[16]++;exports.updateGoal=updateGoal;function goalCorrespondsToSdmGoal(goal,sdmGoal){cov_jol20qds5.f[2]++;cov_jol20qds5.s[17]++;return(cov_jol20qds5.b[7][0]++,goal.name===sdmGoal.name)&&(cov_jol20qds5.b[7][1]++,environmentFromGoal(goal)===sdmGoal.environment);}cov_jol20qds5.s[18]++;exports.goalCorrespondsToSdmGoal=goalCorrespondsToSdmGoal;function constructSdmGoalImplementation(gi){cov_jol20qds5.f[3]++;cov_jol20qds5.s[19]++;return{method:"SDM fulfill on requested",name:gi.implementationName};}cov_jol20qds5.s[20]++;exports.constructSdmGoalImplementation=constructSdmGoalImplementation;function constructSdmGoal(ctx,parameters){cov_jol20qds5.f[4]++;const{goalSet,goal,goalSetId,state,id,providerId,url}=(cov_jol20qds5.s[21]++,parameters);const fulfillment=(cov_jol20qds5.s[22]++,(cov_jol20qds5.b[8][0]++,parameters.fulfillment)||(cov_jol20qds5.b[8][1]++,{method:"other",name:"unspecified"}));cov_jol20qds5.s[23]++;if(!id.branch){cov_jol20qds5.b[9][0]++;cov_jol20qds5.s[24]++;throw new Error(sprintf_js_1.sprintf("Please provide a branch in the RemoteRepoRef %j",parameters));}else{cov_jol20qds5.b[9][1]++;}cov_jol20qds5.s[25]++;if(!id.sha){cov_jol20qds5.b[10][0]++;cov_jol20qds5.s[26]++;throw new Error(sprintf_js_1.sprintf("Please provide a sha in the RemoteRepoRef %j",parameters));}else{cov_jol20qds5.b[10][1]++;}const preConditions=(cov_jol20qds5.s[27]++,[]);const description=(cov_jol20qds5.s[28]++,descriptionFromState(goal,state));const environment=(cov_jol20qds5.s[29]++,environmentFromGoal(goal));cov_jol20qds5.s[30]++;if(Goal_1.hasPreconditions(goal)){cov_jol20qds5.b[11][0]++;cov_jol20qds5.s[31]++;preConditions.push(...goal.dependsOn.map(d=>{cov_jol20qds5.f[5]++;cov_jol20qds5.s[32]++;return{goalSet,name:d.name,environment:environmentFromGoal(d)};}));}else{cov_jol20qds5.b[11][1]++;}cov_jol20qds5.s[33]++;return{goalSet,goalSetId,name:goal.name,uniqueName:goal.definition.uniqueName,environment,fulfillment,sha:id.sha,branch:id.branch,repo:{name:id.repo,owner:id.owner,providerId},state,description,url:approvalGate_1.disregardApproval(url),externalKey:goal.context,ts:Date.now(),approvalRequired:goal.definition.approvalRequired?(cov_jol20qds5.b[12][0]++,goal.definition.approvalRequired):(cov_jol20qds5.b[12][1]++,false),provenance:[constructProvenance(ctx)],preConditions};}cov_jol20qds5.s[34]++;exports.constructSdmGoal=constructSdmGoal;function storeGoal(ctx,sdmGoal){cov_jol20qds5.f[6]++;cov_jol20qds5.s[35]++;automation_client_1.logger.info("Storing goal: %j",sdmGoal);cov_jol20qds5.s[36]++;return ctx.messageClient.send(sdmGoal,MessageClient_1.addressEvent(sdmGoalIngester_1.GoalRootType)).then(()=>{cov_jol20qds5.f[7]++;cov_jol20qds5.s[37]++;return sdmGoal;});}cov_jol20qds5.s[38]++;exports.storeGoal=storeGoal;function constructProvenance(ctx){cov_jol20qds5.f[8]++;cov_jol20qds5.s[39]++;return{registration:ctx.context.name,version:ctx.context.version,name:ctx.context.operation,correlationId:ctx.correlationId,ts:Date.now()};}function descriptionFromState(goal,state){cov_jol20qds5.f[9]++;cov_jol20qds5.s[40]++;switch(state){case"planned":cov_jol20qds5.b[13][0]++;case"requested":cov_jol20qds5.b[13][1]++;cov_jol20qds5.s[41]++;return goal.requestedDescription;case"in_process":cov_jol20qds5.b[13][2]++;cov_jol20qds5.s[42]++;return goal.inProcessDescription;case"waiting_for_approval":cov_jol20qds5.b[13][3]++;cov_jol20qds5.s[43]++;return goal.waitingForApprovalDescription;case"success":cov_jol20qds5.b[13][4]++;cov_jol20qds5.s[44]++;return goal.successDescription;case"failure":cov_jol20qds5.b[13][5]++;cov_jol20qds5.s[45]++;return goal.failureDescription;case"skipped":cov_jol20qds5.b[13][6]++;cov_jol20qds5.s[46]++;return"Skipped";// you probably want to use something that describes the reason instead. but don't error.
default:cov_jol20qds5.b[13][7]++;cov_jol20qds5.s[47]++;throw new Error("Unknown goal state "+state);}}cov_jol20qds5.s[48]++;exports.descriptionFromState=descriptionFromState;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL1VzZXJzL3JvZGpvaG5zb24vc2ZvcnphbmRvLWRldi9pZGVhLXByb2plY3RzL215LWZsb3cvc3JjL2NvbW1vbi9kZWxpdmVyeS9nb2Fscy9zdXBwb3J0L3N0b3JlR29hbHMudHMiLCJzb3VyY2VzIjpbIi9Vc2Vycy9yb2Rqb2huc29uL3Nmb3J6YW5kby1kZXYvaWRlYS1wcm9qZWN0cy9teS1mbG93L3NyYy9jb21tb24vZGVsaXZlcnkvZ29hbHMvc3VwcG9ydC9zdG9yZUdvYWxzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTs7Ozs7Ozs7Ozs7Ozs7R0FjRzs7QUFFSCxrRUFBNEY7QUFFNUYsd0ZBQW9GO0FBQ3BGLDRCQUE0QjtBQUM1QiwyQ0FBcUM7QUFDckMsMkZBQTZGO0FBQzdGLDJFQUcrQztBQUMvQyxrQ0FBaUQ7QUFHakQsNkJBQW9DLElBQVU7SUFDMUMsT0FBTyxJQUFJLENBQUMsVUFBVSxDQUFDLFdBQVcsQ0FBQyxPQUFPLENBQUMsS0FBSyxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUMsaUNBQWlDO0FBQzVGLENBQUM7QUFGRCxrREFFQztBQVdELG9CQUEyQixHQUFtQixFQUFFLE1BQWUsRUFBRSxNQUEyQjtJQUN4RixNQUFNLFdBQVcsR0FBRyxNQUFNLENBQUMsV0FBVyxDQUFDO0lBQ3ZDLE1BQU0sUUFBUSxHQUFHLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLG1CQUFtQixDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDekQsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDO0lBQzNDLE1BQU0sSUFBSSxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUN0QixNQUFNLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDYixDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUM7SUFD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QUFTO1FBQzlELGFBQWEsRUFBRSxHQUFHLENBQUMsYUFBYTtRQUNoQyxFQUFFLEVBQUUsSUFBSSxDQUFDLEdBQUcsRUFBRTtLQUNqQixDQUFDO0FBQ04sQ0FBQztBQUVELDhCQUFxQyxJQUFVLEVBQUUsS0FBbUI7SUFDaEUsUUFBUSxLQUFLLEVBQUU7UUFDWCxLQUFLLFNBQVMsQ0FBQztRQUNmLEtBQUssV0FBVztZQUNaLE9BQU8sSUFBSSxDQUFDLG9CQUFvQixDQUFDO1FBQ3JDLEtBQUssWUFBWTtZQUNiLE9BQU8sSUFBSSxDQUFDLG9CQUFvQixDQUFDO1FBQ3JDLEtBQUssc0JBQXNCO1lBQ3ZCLE9BQU8sSUFBSSxDQUFDLDZCQUE2QixDQUFDO1FBQzlDLEtBQUssU0FBUztZQUNWLE9BQU8sSUFBSSxDQUFDLGtCQUFrQixDQUFDO1FBQ25DLEtBQUssU0FBUztZQUNWLE9BQU8sSUFBSSxDQUFDLGtCQUFrQixDQUFDO1FBQ25DLEtBQUssU0FBUztZQUNWLE9BQU8sU0FBUyxDQUFDLENBQUMseUZBQXlGO1FBQy9HO1lBQ0ksTUFBTSxJQUFJLEtBQUssQ0FBQyxxQkFBcUIsR0FBRyxLQUFLLENBQUMsQ0FBQztLQUN0RDtBQUNMLENBQUM7QUFsQkQsb0RBa0JDIiwic291cmNlc0NvbnRlbnQiOlsiLypcbiAqIENvcHlyaWdodCDCqSAyMDE4IEF0b21pc3QsIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHsgQXV0b21hdGlvbkNvbnRleHRBd2FyZSwgSGFuZGxlckNvbnRleHQsIGxvZ2dlciB9IGZyb20gXCJAYXRvbWlzdC9hdXRvbWF0aW9uLWNsaWVudFwiO1xuaW1wb3J0IHsgUmVtb3RlUmVwb1JlZiB9IGZyb20gXCJAYXRvbWlzdC9hdXRvbWF0aW9uLWNsaWVudC9vcGVyYXRpb25zL2NvbW1vbi9SZXBvSWRcIjtcbmltcG9ydCB7IGFkZHJlc3NFdmVudCB9IGZyb20gXCJAYXRvbWlzdC9hdXRvbWF0aW9uLWNsaWVudC9zcGkvbWVzc2FnZS9NZXNzYWdlQ2xpZW50XCI7XG5pbXBvcnQgKiBhcyBfIGZyb20gXCJsb2Rhc2hcIjtcbmltcG9ydCB7IHNwcmludGYgfSBmcm9tIFwic3ByaW50Zi1qc1wiO1xuaW1wb3J0IHsgZGlzcmVnYXJkQXBwcm92YWwgfSBmcm9tIFwiLi4vLi4vLi4vLi4vaGFuZGxlcnMvZXZlbnRzL2RlbGl2ZXJ5L3ZlcmlmeS9hcHByb3ZhbEdhdGVcIjtcbmltcG9ydCB7XG4gICAgR29hbFJvb3RUeXBlLCBTZG1Hb2FsLCBTZG1Hb2FsRnVsZmlsbG1lbnQsIFNkbUdvYWxLZXksIFNkbUdvYWxTdGF0ZSxcbiAgICBTZG1Qcm92ZW5hbmNlLFxufSBmcm9tIFwiLi4vLi4vLi4vLi4vaW5nZXN0ZXJzL3NkbUdvYWxJbmdlc3RlclwiO1xuaW1wb3J0IHsgR29hbCwgaGFzUHJlY29uZGl0aW9ucyB9IGZyb20gXCIuLi9Hb2FsXCI7XG5pbXBvcnQgeyBHb2FsSW1wbGVtZW50YXRpb24gfSBmcm9tIFwiLi9TZG1Hb2FsSW1wbGVtZW50YXRpb25NYXBwZXJcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIGVudmlyb25tZW50RnJvbUdvYWwoZ29hbDogR29hbCkge1xuICAgIHJldHVybiBnb2FsLmRlZmluaXRpb24uZW52aXJvbm1lbnQucmVwbGFjZSgvXFwvJC8sIFwiXCIpOyAvLyByZW1vdmUgdHJhaWxpbmcgc2xhc2ggYXQgbGVhc3Rcbn1cblxuZXhwb3J0IGludGVyZmFjZSBVcGRhdGVTZG1Hb2FsUGFyYW1zIHtcbiAgICBzdGF0ZTogU2RtR29hbFN0YXRlO1xuICAgIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG4gICAgdXJsPzogc3RyaW5nO1xuICAgIGFwcHJvdmVkPzogYm9vbGVhbjtcbiAgICBlcnJvcj86IEVycm9yO1xuICAgIGRhdGE/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVHb2FsKGN0eDogSGFuZGxlckNvbnRleHQsIGJlZm9yZTogU2RtR29hbCwgcGFyYW1zOiBVcGRhdGVTZG1Hb2FsUGFyYW1zKSB7XG4gICAgY29uc3QgZGVzY3JpcHRpb24gPSBwYXJhbXMuZGVzY3JpcHRpb247XG4gICAgY29uc3QgYXBwcm92YWwgPSBwYXJhbXMuYXBwcm92ZWQgPyBjb25zdHJ1Y3RQcm92ZW5hbmNlKGN0eCkgOlxuICAgICAgICAhIWJlZm9yZSA/IGJlZm9yZS5hcHByb3ZhbCA6IHVuZGVmaW5lZDtcbiAgICBjb25zdCBkYXRhID0gcGFyYW1zLmRhdGEgP1xuICAgICAgICBwYXJhbXMuZGF0YSA6XG4gICAgICAgICEhYmVmb3JlID8gYmVmb3JlLmRhdGEgOiB1bmRlZmluZWQ7XG4gICAgY29uc3Qgc2RtR29hbCA9IHtcbiAgICAgICAgLi4uYmVmb3JlLFxuICAgICAgICBzdGF0ZTogcGFyYW1zLnN0YXRlID09PSBcInN1Y2Nlc3NcIiAmJiAhIWJlZm9yZSAmJiBiZWZvcmUuYXBwcm92YWxSZXF1aXJlZCA/IFwid2FpdGluZ19mb3JfYXBwcm92YWxcIiA6IHBhcmFtcy5zdGF0ZSxcbiAgICAgICAgZGVzY3JpcHRpb24sXG4gICAgICAgIHVybDogcGFyYW1zLnVybCxcbiAgICAgICAgYXBwcm92YWwsXG4gICAgICAgIHRzOiBEYXRlLm5vdygpLFxuICAgICAgICBwcm92ZW5hbmNlOiBbY29uc3RydWN0UHJvdmVuYW5jZShjdHgpXS5jb25jYXQoISFiZWZvcmUgPyBiZWZvcmUucHJvdmVuYW5jZSA6IFtdKSxcbiAgICAgICAgZXJyb3I6IF8uZ2V0KHBhcmFtcywgXCJlcnJvci5tZXNzYWdlXCIpLFxuICAgICAgICBkYXRhLFxuICAgIH07XG4gICAgbG9nZ2VyLmRlYnVnKFwiVXBkYXRpbmcgU2RtR29hbCAlcyB0byAlczogJWpcIiwgc2RtR29hbC5leHRlcm5hbEtleSwgc2RtR29hbC5zdGF0ZSwgc2RtR29hbCk7XG4gICAgcmV0dXJuIGN0eC5tZXNzYWdlQ2xpZW50LnNlbmQoc2RtR29hbCwgYWRkcmVzc0V2ZW50KEdvYWxSb290VHlwZSkpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ29hbENvcnJlc3BvbmRzVG9TZG1Hb2FsKGdvYWw6IEdvYWwsIHNkbUdvYWw6IFNkbUdvYWwpOiBib29sZWFuIHtcbiAgICByZXR1cm4gZ29hbC5uYW1lID09PSBzZG1Hb2FsLm5hbWUgJiYgZW52aXJvbm1lbnRGcm9tR29hbChnb2FsKSA9PT0gc2RtR29hbC5lbnZpcm9ubWVudDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNvbnN0cnVjdFNkbUdvYWxJbXBsZW1lbnRhdGlvbihnaTogR29hbEltcGxlbWVudGF0aW9uKTogU2RtR29hbEZ1bGZpbGxtZW50IHtcbiAgICByZXR1cm4ge1xuICAgICAgICBtZXRob2Q6IFwiU0RNIGZ1bGZpbGwgb24gcmVxdWVzdGVkXCIsXG4gICAgICAgIG5hbWU6IGdpLmltcGxlbWVudGF0aW9uTmFtZSxcbiAgICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY29uc3RydWN0U2RtR29hbChjdHg6IEhhbmRsZXJDb250ZXh0LCBwYXJhbWV0ZXJzOiB7XG4gICAgZ29hbFNldDogc3RyaW5nLFxuICAgIGdvYWxTZXRJZDogc3RyaW5nLFxuICAgIGdvYWw6IEdvYWwsXG4gICAgc3RhdGU6IFNkbUdvYWxTdGF0ZSxcbiAgICBpZDogUmVtb3RlUmVwb1JlZixcbiAgICBwcm92aWRlcklkOiBzdHJpbmdcbiAgICB1cmw/OiBzdHJpbmcsXG4gICAgZnVsZmlsbG1lbnQ/OiBTZG1Hb2FsRnVsZmlsbG1lbnQsXG59KTogU2RtR29hbCB7XG4gICAgY29uc3Qge2dvYWxTZXQsIGdvYWwsIGdvYWxTZXRJZCwgc3RhdGUsIGlkLCBwcm92aWRlcklkLCB1cmx9ID0gcGFyYW1ldGVycztcbiAgICBjb25zdCBmdWxmaWxsbWVudCA9IHBhcmFtZXRlcnMuZnVsZmlsbG1lbnQgfHwge21ldGhvZDogXCJvdGhlclwiLCBuYW1lOiBcInVuc3BlY2lmaWVkXCJ9O1xuXG4gICAgaWYgKCFpZC5icmFuY2gpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKHNwcmludGYoXCJQbGVhc2UgcHJvdmlkZSBhIGJyYW5jaCBpbiB0aGUgUmVtb3RlUmVwb1JlZiAlalwiLCBwYXJhbWV0ZXJzKSk7XG4gICAgfVxuICAgIGlmICghaWQuc2hhKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihzcHJpbnRmKFwiUGxlYXNlIHByb3ZpZGUgYSBzaGEgaW4gdGhlIFJlbW90ZVJlcG9SZWYgJWpcIiwgcGFyYW1ldGVycykpO1xuICAgIH1cblxuICAgIGNvbnN0IHByZUNvbmRpdGlvbnM6IFNkbUdvYWxLZXlbXSA9IFtdO1xuICAgIGNvbnN0IGRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb25Gcm9tU3RhdGUoZ29hbCwgc3RhdGUpO1xuICAgIGNvbnN0IGVudmlyb25tZW50ID0gZW52aXJvbm1lbnRGcm9tR29hbChnb2FsKTtcbiAgICBpZiAoaGFzUHJlY29uZGl0aW9ucyhnb2FsKSkge1xuICAgICAgICBwcmVDb25kaXRpb25zLnB1c2goLi4uZ29hbC5kZXBlbmRzT24ubWFwKGQgPT4gKHtcbiAgICAgICAgICAgIGdvYWxTZXQsXG4gICAgICAgICAgICBuYW1lOiBkLm5hbWUsXG4gICAgICAgICAgICBlbnZpcm9ubWVudDogZW52aXJvbm1lbnRGcm9tR29hbChkKSxcbiAgICAgICAgfSkpKTtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBnb2FsU2V0LFxuICAgICAgICBnb2FsU2V0SWQsXG4gICAgICAgIG5hbWU6IGdvYWwubmFtZSxcbiAgICAgICAgdW5pcXVlTmFtZTogZ29hbC5kZWZpbml0aW9uLnVuaXF1ZU5hbWUsXG4gICAgICAgIGVudmlyb25tZW50LFxuICAgICAgICBmdWxmaWxsbWVudCxcbiAgICAgICAgc2hhOiBpZC5zaGEsXG4gICAgICAgIGJyYW5jaDogaWQuYnJhbmNoLFxuICAgICAgICByZXBvOiB7XG4gICAgICAgICAgICBuYW1lOiBpZC5yZXBvLFxuICAgICAgICAgICAgb3duZXI6IGlkLm93bmVyLFxuICAgICAgICAgICAgcHJvdmlkZXJJZCxcbiAgICAgICAgfSxcbiAgICAgICAgc3RhdGUsXG4gICAgICAgIGRlc2NyaXB0aW9uLFxuICAgICAgICB1cmw6IGRpc3JlZ2FyZEFwcHJvdmFsKHVybCksIC8vIHdoZW4gd2UgdXNlIGdvYWxzIGluIGxpZmVjeWNsZSB0aGlzIGNhbiBnb1xuICAgICAgICBleHRlcm5hbEtleTogZ29hbC5jb250ZXh0LFxuICAgICAgICB0czogRGF0ZS5ub3coKSxcbiAgICAgICAgYXBwcm92YWxSZXF1aXJlZDogZ29hbC5kZWZpbml0aW9uLmFwcHJvdmFsUmVxdWlyZWQgPyBnb2FsLmRlZmluaXRpb24uYXBwcm92YWxSZXF1aXJlZCA6IGZhbHNlLFxuICAgICAgICBwcm92ZW5hbmNlOiBbY29uc3RydWN0UHJvdmVuYW5jZShjdHgpXSxcbiAgICAgICAgcHJlQ29uZGl0aW9ucyxcbiAgICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc3RvcmVHb2FsKGN0eDogSGFuZGxlckNvbnRleHQsIHNkbUdvYWw6IFNkbUdvYWwpIHtcbiAgICBsb2dnZXIuaW5mbyhcIlN0b3JpbmcgZ29hbDogJWpcIiwgc2RtR29hbCk7XG4gICAgcmV0dXJuIGN0eC5tZXNzYWdlQ2xpZW50LnNlbmQoc2RtR29hbCwgYWRkcmVzc0V2ZW50KEdvYWxSb290VHlwZSkpXG4gICAgICAgIC50aGVuKCgpID0+IHNkbUdvYWwpO1xufVxuXG5mdW5jdGlvbiBjb25zdHJ1Y3RQcm92ZW5hbmNlKGN0eDogSGFuZGxlckNvbnRleHQpOiBTZG1Qcm92ZW5hbmNlIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZWdpc3RyYXRpb246IChjdHggYXMgYW55IGFzIEF1dG9tYXRpb25Db250ZXh0QXdhcmUpLmNvbnRleHQubmFtZSxcbiAgICAgICAgdmVyc2lvbjogKGN0eCBhcyBhbnkgYXMgQXV0b21hdGlvbkNvbnRleHRBd2FyZSkuY29udGV4dC52ZXJzaW9uLFxuICAgICAgICBuYW1lOiAoY3R4IGFzIGFueSBhcyBBdXRvbWF0aW9uQ29udGV4dEF3YXJlKS5jb250ZXh0Lm9wZXJhdGlvbixcbiAgICAgICAgY29ycmVsYXRpb25JZDogY3R4LmNvcnJlbGF0aW9uSWQsXG4gICAgICAgIHRzOiBEYXRlLm5vdygpLFxuICAgIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkZXNjcmlwdGlvbkZyb21TdGF0ZShnb2FsOiBHb2FsLCBzdGF0ZTogU2RtR29hbFN0YXRlKTogc3RyaW5nIHtcbiAgICBzd2l0Y2ggKHN0YXRlKSB7XG4gICAgICAgIGNhc2UgXCJwbGFubmVkXCI6XG4gICAgICAgIGNhc2UgXCJyZXF1ZXN0ZWRcIjpcbiAgICAgICAgICAgIHJldHVybiBnb2FsLnJlcXVlc3RlZERlc2NyaXB0aW9uO1xuICAgICAgICBjYXNlIFwiaW5fcHJvY2Vzc1wiOlxuICAgICAgICAgICAgcmV0dXJuIGdvYWwuaW5Qcm9jZXNzRGVzY3JpcHRpb247XG4gICAgICAgIGNhc2UgXCJ3YWl0aW5nX2Zvcl9hcHByb3ZhbFwiOlxuICAgICAgICAgICAgcmV0dXJuIGdvYWwud2FpdGluZ0ZvckFwcHJvdmFsRGVzY3JpcHRpb247XG4gICAgICAgIGNhc2UgXCJzdWNjZXNzXCI6XG4gICAgICAgICAgICByZXR1cm4gZ29hbC5zdWNjZXNzRGVzY3JpcHRpb247XG4gICAgICAgIGNhc2UgXCJmYWlsdXJlXCI6XG4gICAgICAgICAgICByZXR1cm4gZ29hbC5mYWlsdXJlRGVzY3JpcHRpb247XG4gICAgICAgIGNhc2UgXCJza2lwcGVkXCI6XG4gICAgICAgICAgICByZXR1cm4gXCJTa2lwcGVkXCI7IC8vIHlvdSBwcm9iYWJseSB3YW50IHRvIHVzZSBzb21ldGhpbmcgdGhhdCBkZXNjcmliZXMgdGhlIHJlYXNvbiBpbnN0ZWFkLiBidXQgZG9uJ3QgZXJyb3IuXG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJVbmtub3duIGdvYWwgc3RhdGUgXCIgKyBzdGF0ZSk7XG4gICAgfVxufVxuIl19