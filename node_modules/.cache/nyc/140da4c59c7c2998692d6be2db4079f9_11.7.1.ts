"use strict";/*
 * Copyright Â© 2018 Atomist, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var cov_9hyft1qc=function(){var path="/Users/rodjohnson/sforzando-dev/idea-projects/my-flow/src/common/delivery/goals/storeGoals.ts",hash="bc19174d273b1f209b9fe8aa01567b1abda5bae5",Function=function(){}.constructor,global=new Function('return this')(),gcv="__coverage__",coverageData={path:"/Users/rodjohnson/sforzando-dev/idea-projects/my-flow/src/common/delivery/goals/storeGoals.ts",statementMap:{"0":{start:{line:17,column:0},end:{line:17,column:62}},"1":{start:{line:18,column:28},end:{line:18,column:65}},"2":{start:{line:19,column:24},end:{line:19,column:87}},"3":{start:{line:20,column:10},end:{line:20,column:27}},"4":{start:{line:21,column:21},end:{line:21,column:42}},"5":{start:{line:22,column:23},end:{line:22,column:87}},"6":{start:{line:23,column:26},end:{line:23,column:71}},"7":{start:{line:24,column:15},end:{line:24,column:32}},"8":{start:{line:26,column:4},end:{line:26,column:58}},"9":{start:{line:28,column:0},end:{line:28,column:50}},"10":{start:{line:30,column:24},end:{line:30,column:42}},"11":{start:{line:31,column:21},end:{line:32,column:46}},"12":{start:{line:33,column:17},end:{line:35,column:42}},"13":{start:{line:36,column:20},end:{line:36,column:346}},"14":{start:{line:37,column:4},end:{line:37,column:115}},"15":{start:{line:38,column:4},end:{line:38,column:105}},"16":{start:{line:40,column:0},end:{line:40,column:32}},"17":{start:{line:42,column:4},end:{line:42,column:91}},"18":{start:{line:44,column:0},end:{line:44,column:60}},"19":{start:{line:46,column:4},end:{line:49,column:6}},"20":{start:{line:51,column:0},end:{line:51,column:72}},"21":{start:{line:53,column:69},end:{line:53,column:79}},"22":{start:{line:54,column:24},end:{line:54,column:90}},"23":{start:{line:55,column:4},end:{line:57,column:5}},"24":{start:{line:56,column:8},end:{line:56,column:109}},"25":{start:{line:58,column:4},end:{line:60,column:5}},"26":{start:{line:59,column:8},end:{line:59,column:106}},"27":{start:{line:61,column:26},end:{line:61,column:28}},"28":{start:{line:62,column:24},end:{line:62,column:57}},"29":{start:{line:63,column:24},end:{line:63,column:49}},"30":{start:{line:64,column:4},end:{line:70,column:5}},"31":{start:{line:65,column:8},end:{line:69,column:13}},"32":{start:{line:65,column:55},end:{line:69,column:9}},"33":{start:{line:71,column:4},end:{line:93,column:6}},"34":{start:{line:95,column:0},end:{line:95,column:44}},"35":{start:{line:97,column:4},end:{line:97,column:65}},"36":{start:{line:98,column:4},end:{line:99,column:29}},"37":{start:{line:99,column:20},end:{line:99,column:27}},"38":{start:{line:101,column:0},end:{line:101,column:30}},"39":{start:{line:103,column:4},end:{line:109,column:6}},"40":{start:{line:112,column:4},end:{line:128,column:5}},"41":{start:{line:115,column:12},end:{line:115,column:45}},"42":{start:{line:117,column:12},end:{line:117,column:45}},"43":{start:{line:119,column:12},end:{line:119,column:54}},"44":{start:{line:121,column:12},end:{line:121,column:43}},"45":{start:{line:123,column:12},end:{line:123,column:43}},"46":{start:{line:125,column:12},end:{line:125,column:29}},"47":{start:{line:127,column:12},end:{line:127,column:59}},"48":{start:{line:130,column:0},end:{line:130,column:52}}},fnMap:{"0":{name:"environmentFromGoal",decl:{start:{line:25,column:9},end:{line:25,column:28}},loc:{start:{line:25,column:35},end:{line:27,column:1}},line:25},"1":{name:"updateGoal",decl:{start:{line:29,column:9},end:{line:29,column:19}},loc:{start:{line:29,column:41},end:{line:39,column:1}},line:29},"2":{name:"goalCorrespondsToSdmGoal",decl:{start:{line:41,column:9},end:{line:41,column:33}},loc:{start:{line:41,column:49},end:{line:43,column:1}},line:41},"3":{name:"constructSdmGoalImplementation",decl:{start:{line:45,column:9},end:{line:45,column:39}},loc:{start:{line:45,column:44},end:{line:50,column:1}},line:45},"4":{name:"constructSdmGoal",decl:{start:{line:52,column:9},end:{line:52,column:25}},loc:{start:{line:52,column:43},end:{line:94,column:1}},line:52},"5":{name:"(anonymous_5)",decl:{start:{line:65,column:49},end:{line:65,column:50}},loc:{start:{line:65,column:55},end:{line:69,column:9}},line:65},"6":{name:"storeGoal",decl:{start:{line:96,column:9},end:{line:96,column:18}},loc:{start:{line:96,column:33},end:{line:100,column:1}},line:96},"7":{name:"(anonymous_7)",decl:{start:{line:99,column:14},end:{line:99,column:15}},loc:{start:{line:99,column:20},end:{line:99,column:27}},line:99},"8":{name:"constructProvenance",decl:{start:{line:102,column:9},end:{line:102,column:28}},loc:{start:{line:102,column:34},end:{line:110,column:1}},line:102},"9":{name:"descriptionFromState",decl:{start:{line:111,column:9},end:{line:111,column:29}},loc:{start:{line:111,column:43},end:{line:129,column:1}},line:111}},branchMap:{"0":{loc:{start:{line:31,column:21},end:{line:32,column:46}},type:"cond-expr",locations:[{start:{line:31,column:39},end:{line:31,column:63}},{start:{line:32,column:8},end:{line:32,column:46}}],line:31},"1":{loc:{start:{line:32,column:8},end:{line:32,column:46}},type:"cond-expr",locations:[{start:{line:32,column:19},end:{line:32,column:34}},{start:{line:32,column:37},end:{line:32,column:46}}],line:32},"2":{loc:{start:{line:33,column:17},end:{line:35,column:42}},type:"cond-expr",locations:[{start:{line:34,column:8},end:{line:34,column:19}},{start:{line:35,column:8},end:{line:35,column:42}}],line:33},"3":{loc:{start:{line:35,column:8},end:{line:35,column:42}},type:"cond-expr",locations:[{start:{line:35,column:19},end:{line:35,column:30}},{start:{line:35,column:33},end:{line:35,column:42}}],line:35},"4":{loc:{start:{line:36,column:55},end:{line:36,column:160}},type:"cond-expr",locations:[{start:{line:36,column:123},end:{line:36,column:145}},{start:{line:36,column:148},end:{line:36,column:160}}],line:36},"5":{loc:{start:{line:36,column:55},end:{line:36,column:120}},type:"binary-expr",locations:[{start:{line:36,column:55},end:{line:36,column:81}},{start:{line:36,column:85},end:{line:36,column:93}},{start:{line:36,column:97},end:{line:36,column:120}}],line:36},"6":{loc:{start:{line:36,column:264},end:{line:36,column:297}},type:"cond-expr",locations:[{start:{line:36,column:275},end:{line:36,column:292}},{start:{line:36,column:295},end:{line:36,column:297}}],line:36},"7":{loc:{start:{line:42,column:11},end:{line:42,column:90}},type:"binary-expr",locations:[{start:{line:42,column:11},end:{line:42,column:37}},{start:{line:42,column:41},end:{line:42,column:90}}],line:42},"8":{loc:{start:{line:54,column:24},end:{line:54,column:90}},type:"binary-expr",locations:[{start:{line:54,column:24},end:{line:54,column:46}},{start:{line:54,column:50},end:{line:54,column:90}}],line:54},"9":{loc:{start:{line:55,column:4},end:{line:57,column:5}},type:"if",locations:[{start:{line:55,column:4},end:{line:57,column:5}},{start:{line:55,column:4},end:{line:57,column:5}}],line:55},"10":{loc:{start:{line:58,column:4},end:{line:60,column:5}},type:"if",locations:[{start:{line:58,column:4},end:{line:60,column:5}},{start:{line:58,column:4},end:{line:60,column:5}}],line:58},"11":{loc:{start:{line:64,column:4},end:{line:70,column:5}},type:"if",locations:[{start:{line:64,column:4},end:{line:70,column:5}},{start:{line:64,column:4},end:{line:70,column:5}}],line:64},"12":{loc:{start:{line:90,column:26},end:{line:90,column:101}},type:"cond-expr",locations:[{start:{line:90,column:61},end:{line:90,column:93}},{start:{line:90,column:96},end:{line:90,column:101}}],line:90},"13":{loc:{start:{line:112,column:4},end:{line:128,column:5}},type:"switch",locations:[{start:{line:113,column:8},end:{line:113,column:23}},{start:{line:114,column:8},end:{line:115,column:45}},{start:{line:116,column:8},end:{line:117,column:45}},{start:{line:118,column:8},end:{line:119,column:54}},{start:{line:120,column:8},end:{line:121,column:43}},{start:{line:122,column:8},end:{line:123,column:43}},{start:{line:124,column:8},end:{line:125,column:29}},{start:{line:126,column:8},end:{line:127,column:59}}],line:112}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0,0,0,0,0,0,0]},_coverageSchema:"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c"},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();cov_9hyft1qc.s[0]++;Object.defineProperty(exports,"__esModule",{value:true});const automation_client_1=(cov_9hyft1qc.s[1]++,require("@atomist/automation-client"));const MessageClient_1=(cov_9hyft1qc.s[2]++,require("@atomist/automation-client/spi/message/MessageClient"));const _=(cov_9hyft1qc.s[3]++,require("lodash"));const sprintf_js_1=(cov_9hyft1qc.s[4]++,require("sprintf-js"));const approvalGate_1=(cov_9hyft1qc.s[5]++,require("../../../handlers/events/delivery/verify/approvalGate"));const sdmGoalIngester_1=(cov_9hyft1qc.s[6]++,require("../../../ingesters/sdmGoalIngester"));const Goal_1=(cov_9hyft1qc.s[7]++,require("./Goal"));function environmentFromGoal(goal){cov_9hyft1qc.f[0]++;cov_9hyft1qc.s[8]++;return goal.definition.environment.replace(/\/$/,"");// remove trailing slash at least
}cov_9hyft1qc.s[9]++;exports.environmentFromGoal=environmentFromGoal;function updateGoal(ctx,before,params){cov_9hyft1qc.f[1]++;const description=(cov_9hyft1qc.s[10]++,params.description);const approval=(cov_9hyft1qc.s[11]++,params.approved?(cov_9hyft1qc.b[0][0]++,constructProvenance(ctx)):(cov_9hyft1qc.b[0][1]++,!!before?(cov_9hyft1qc.b[1][0]++,before.approval):(cov_9hyft1qc.b[1][1]++,undefined)));const data=(cov_9hyft1qc.s[12]++,params.data?(cov_9hyft1qc.b[2][0]++,params.data):(cov_9hyft1qc.b[2][1]++,!!before?(cov_9hyft1qc.b[3][0]++,before.data):(cov_9hyft1qc.b[3][1]++,undefined)));const sdmGoal=(cov_9hyft1qc.s[13]++,Object.assign({},before,{state:(cov_9hyft1qc.b[5][0]++,params.state==="success")&&(cov_9hyft1qc.b[5][1]++,!!before)&&(cov_9hyft1qc.b[5][2]++,before.approvalRequired)?(cov_9hyft1qc.b[4][0]++,"waiting_for_approval"):(cov_9hyft1qc.b[4][1]++,params.state),description,url:params.url,approval,ts:Date.now(),provenance:[constructProvenance(ctx)].concat(!!before?(cov_9hyft1qc.b[6][0]++,before.provenance):(cov_9hyft1qc.b[6][1]++,[])),error:_.get(params,"error.message"),data}));cov_9hyft1qc.s[14]++;automation_client_1.logger.debug("Updating SdmGoal %s to %s: %j",sdmGoal.externalKey,sdmGoal.state,sdmGoal);cov_9hyft1qc.s[15]++;return ctx.messageClient.send(sdmGoal,MessageClient_1.addressEvent(sdmGoalIngester_1.GoalRootType));}cov_9hyft1qc.s[16]++;exports.updateGoal=updateGoal;function goalCorrespondsToSdmGoal(goal,sdmGoal){cov_9hyft1qc.f[2]++;cov_9hyft1qc.s[17]++;return(cov_9hyft1qc.b[7][0]++,goal.name===sdmGoal.name)&&(cov_9hyft1qc.b[7][1]++,environmentFromGoal(goal)===sdmGoal.environment);}cov_9hyft1qc.s[18]++;exports.goalCorrespondsToSdmGoal=goalCorrespondsToSdmGoal;function constructSdmGoalImplementation(gi){cov_9hyft1qc.f[3]++;cov_9hyft1qc.s[19]++;return{method:"SDM fulfill on requested",name:gi.implementationName};}cov_9hyft1qc.s[20]++;exports.constructSdmGoalImplementation=constructSdmGoalImplementation;function constructSdmGoal(ctx,parameters){cov_9hyft1qc.f[4]++;const{goalSet,goal,goalSetId,state,id,providerId,url}=(cov_9hyft1qc.s[21]++,parameters);const fulfillment=(cov_9hyft1qc.s[22]++,(cov_9hyft1qc.b[8][0]++,parameters.fulfillment)||(cov_9hyft1qc.b[8][1]++,{method:"other",name:"unspecified"}));cov_9hyft1qc.s[23]++;if(!id.branch){cov_9hyft1qc.b[9][0]++;cov_9hyft1qc.s[24]++;throw new Error(sprintf_js_1.sprintf("Please provide a branch in the RemoteRepoRef %j",parameters));}else{cov_9hyft1qc.b[9][1]++;}cov_9hyft1qc.s[25]++;if(!id.sha){cov_9hyft1qc.b[10][0]++;cov_9hyft1qc.s[26]++;throw new Error(sprintf_js_1.sprintf("Please provide a sha in the RemoteRepoRef %j",parameters));}else{cov_9hyft1qc.b[10][1]++;}const preConditions=(cov_9hyft1qc.s[27]++,[]);const description=(cov_9hyft1qc.s[28]++,descriptionFromState(goal,state));const environment=(cov_9hyft1qc.s[29]++,environmentFromGoal(goal));cov_9hyft1qc.s[30]++;if(Goal_1.hasPreconditions(goal)){cov_9hyft1qc.b[11][0]++;cov_9hyft1qc.s[31]++;preConditions.push(...goal.dependsOn.map(d=>{cov_9hyft1qc.f[5]++;cov_9hyft1qc.s[32]++;return{goalSet,name:d.name,environment:environmentFromGoal(d)};}));}else{cov_9hyft1qc.b[11][1]++;}cov_9hyft1qc.s[33]++;return{goalSet,goalSetId,name:goal.name,uniqueName:goal.definition.uniqueName,environment,fulfillment,sha:id.sha,branch:id.branch,repo:{name:id.repo,owner:id.owner,providerId},state,description,url:approvalGate_1.disregardApproval(url),externalKey:goal.context,ts:Date.now(),approvalRequired:goal.definition.approvalRequired?(cov_9hyft1qc.b[12][0]++,goal.definition.approvalRequired):(cov_9hyft1qc.b[12][1]++,false),provenance:[constructProvenance(ctx)],preConditions};}cov_9hyft1qc.s[34]++;exports.constructSdmGoal=constructSdmGoal;function storeGoal(ctx,sdmGoal){cov_9hyft1qc.f[6]++;cov_9hyft1qc.s[35]++;automation_client_1.logger.info("Storing goal: %j",sdmGoal);cov_9hyft1qc.s[36]++;return ctx.messageClient.send(sdmGoal,MessageClient_1.addressEvent(sdmGoalIngester_1.GoalRootType)).then(()=>{cov_9hyft1qc.f[7]++;cov_9hyft1qc.s[37]++;return sdmGoal;});}cov_9hyft1qc.s[38]++;exports.storeGoal=storeGoal;function constructProvenance(ctx){cov_9hyft1qc.f[8]++;cov_9hyft1qc.s[39]++;return{registration:ctx.context.name,version:ctx.context.version,name:ctx.context.operation,correlationId:ctx.correlationId,ts:Date.now()};}function descriptionFromState(goal,state){cov_9hyft1qc.f[9]++;cov_9hyft1qc.s[40]++;switch(state){case"planned":cov_9hyft1qc.b[13][0]++;case"requested":cov_9hyft1qc.b[13][1]++;cov_9hyft1qc.s[41]++;return goal.requestedDescription;case"in_process":cov_9hyft1qc.b[13][2]++;cov_9hyft1qc.s[42]++;return goal.inProcessDescription;case"waiting_for_approval":cov_9hyft1qc.b[13][3]++;cov_9hyft1qc.s[43]++;return goal.waitingForApprovalDescription;case"success":cov_9hyft1qc.b[13][4]++;cov_9hyft1qc.s[44]++;return goal.successDescription;case"failure":cov_9hyft1qc.b[13][5]++;cov_9hyft1qc.s[45]++;return goal.failureDescription;case"skipped":cov_9hyft1qc.b[13][6]++;cov_9hyft1qc.s[46]++;return"Skipped";// you probably want to use something that describes the reason instead. but don't error.
default:cov_9hyft1qc.b[13][7]++;cov_9hyft1qc.s[47]++;throw new Error("Unknown goal state "+state);}}cov_9hyft1qc.s[48]++;exports.descriptionFromState=descriptionFromState;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL1VzZXJzL3JvZGpvaG5zb24vc2ZvcnphbmRvLWRldi9pZGVhLXByb2plY3RzL215LWZsb3cvc3JjL2NvbW1vbi9kZWxpdmVyeS9nb2Fscy9zdG9yZUdvYWxzLnRzIiwic291cmNlcyI6WyIvVXNlcnMvcm9kam9obnNvbi9zZm9yemFuZG8tZGV2L2lkZWEtcHJvamVjdHMvbXktZmxvdy9zcmMvY29tbW9uL2RlbGl2ZXJ5L2dvYWxzL3N0b3JlR29hbHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBOzs7Ozs7Ozs7Ozs7OztHQWNHOztBQUVILGtFQUE0RjtBQUU1Rix3RkFBb0Y7QUFDcEYsNEJBQTRCO0FBQzVCLDJDQUFxQztBQUNyQyx3RkFBMEY7QUFDMUYsd0VBRzRDO0FBQzVDLGlDQUFnRDtBQUdoRCw2QkFBb0MsSUFBVTtJQUMxQyxPQUFPLElBQUksQ0FBQyxVQUFVLENBQUMsV0FBVyxDQUFDLE9BQU8sQ0FBQyxLQUFLLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxpQ0FBaUM7QUFDNUYsQ0FBQztBQUZELGtEQUVDO0FBV0Qsb0JBQTJCLEdBQW1CLEVBQUUsTUFBZSxFQUFFLE1BQTJCO0lBQ3hGLE1BQU0sV0FBVyxHQUFHLE1BQU0sQ0FBQyxXQUFXLENBQUM7SUFDdkMsTUFBTSxRQUFRLEdBQUcsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsbUJBQW1CLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztRQUN6RCxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUM7SUFDM0MsTUFBTSxJQUFJLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ3RCLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUNiLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQztJQUN2QyxNQUFNLE9BQU8scUJB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QUFFLEdBQUcsQ0FBQyxhQUFhO1FBQ2hDLEVBQUUsRUFBRSxJQUFJLENBQUMsR0FBRyxFQUFFO0tBQ2pCLENBQUM7QUFDTixDQUFDO0FBRUQsOEJBQXFDLElBQVUsRUFBRSxLQUFtQjtJQUNoRSxRQUFRLEtBQUssRUFBRTtRQUNYLEtBQUssU0FBUyxDQUFDO1FBQ2YsS0FBSyxXQUFXO1lBQ1osT0FBTyxJQUFJLENBQUMsb0JBQW9CLENBQUM7UUFDckMsS0FBSyxZQUFZO1lBQ2IsT0FBTyxJQUFJLENBQUMsb0JBQW9CLENBQUM7UUFDckMsS0FBSyxzQkFBc0I7WUFDdkIsT0FBTyxJQUFJLENBQUMsNkJBQTZCLENBQUM7UUFDOUMsS0FBSyxTQUFTO1lBQ1YsT0FBTyxJQUFJLENBQUMsa0JBQWtCLENBQUM7UUFDbkMsS0FBSyxTQUFTO1lBQ1YsT0FBTyxJQUFJLENBQUMsa0JBQWtCLENBQUM7UUFDbkMsS0FBSyxTQUFTO1lBQ1YsT0FBTyxTQUFTLENBQUMsQ0FBQyx5RkFBeUY7UUFDL0c7WUFDSSxNQUFNLElBQUksS0FBSyxDQUFDLHFCQUFxQixHQUFHLEtBQUssQ0FBQyxDQUFDO0tBQ3REO0FBQ0wsQ0FBQztBQWxCRCxvREFrQkMiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICogQ29weXJpZ2h0IMKpIDIwMTggQXRvbWlzdCwgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBBdXRvbWF0aW9uQ29udGV4dEF3YXJlLCBIYW5kbGVyQ29udGV4dCwgbG9nZ2VyIH0gZnJvbSBcIkBhdG9taXN0L2F1dG9tYXRpb24tY2xpZW50XCI7XG5pbXBvcnQgeyBSZW1vdGVSZXBvUmVmIH0gZnJvbSBcIkBhdG9taXN0L2F1dG9tYXRpb24tY2xpZW50L29wZXJhdGlvbnMvY29tbW9uL1JlcG9JZFwiO1xuaW1wb3J0IHsgYWRkcmVzc0V2ZW50IH0gZnJvbSBcIkBhdG9taXN0L2F1dG9tYXRpb24tY2xpZW50L3NwaS9tZXNzYWdlL01lc3NhZ2VDbGllbnRcIjtcbmltcG9ydCAqIGFzIF8gZnJvbSBcImxvZGFzaFwiO1xuaW1wb3J0IHsgc3ByaW50ZiB9IGZyb20gXCJzcHJpbnRmLWpzXCI7XG5pbXBvcnQgeyBkaXNyZWdhcmRBcHByb3ZhbCB9IGZyb20gXCIuLi8uLi8uLi9oYW5kbGVycy9ldmVudHMvZGVsaXZlcnkvdmVyaWZ5L2FwcHJvdmFsR2F0ZVwiO1xuaW1wb3J0IHtcbiAgICBHb2FsUm9vdFR5cGUsIFNkbUdvYWwsIFNkbUdvYWxGdWxmaWxsbWVudCwgU2RtR29hbEtleSwgU2RtR29hbFN0YXRlLFxuICAgIFNkbVByb3ZlbmFuY2UsXG59IGZyb20gXCIuLi8uLi8uLi9pbmdlc3RlcnMvc2RtR29hbEluZ2VzdGVyXCI7XG5pbXBvcnQgeyBHb2FsLCBoYXNQcmVjb25kaXRpb25zIH0gZnJvbSBcIi4vR29hbFwiO1xuaW1wb3J0IHsgR29hbEltcGxlbWVudGF0aW9uIH0gZnJvbSBcIi4vU2RtR29hbEltcGxlbWVudGF0aW9uTWFwcGVyXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiBlbnZpcm9ubWVudEZyb21Hb2FsKGdvYWw6IEdvYWwpIHtcbiAgICByZXR1cm4gZ29hbC5kZWZpbml0aW9uLmVudmlyb25tZW50LnJlcGxhY2UoL1xcLyQvLCBcIlwiKTsgLy8gcmVtb3ZlIHRyYWlsaW5nIHNsYXNoIGF0IGxlYXN0XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVXBkYXRlU2RtR29hbFBhcmFtcyB7XG4gICAgc3RhdGU6IFNkbUdvYWxTdGF0ZTtcbiAgICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICAgIHVybD86IHN0cmluZztcbiAgICBhcHByb3ZlZD86IGJvb2xlYW47XG4gICAgZXJyb3I/OiBFcnJvcjtcbiAgICBkYXRhPzogc3RyaW5nO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlR29hbChjdHg6IEhhbmRsZXJDb250ZXh0LCBiZWZvcmU6IFNkbUdvYWwsIHBhcmFtczogVXBkYXRlU2RtR29hbFBhcmFtcykge1xuICAgIGNvbnN0IGRlc2NyaXB0aW9uID0gcGFyYW1zLmRlc2NyaXB0aW9uO1xuICAgIGNvbnN0IGFwcHJvdmFsID0gcGFyYW1zLmFwcHJvdmVkID8gY29uc3RydWN0UHJvdmVuYW5jZShjdHgpIDpcbiAgICAgICAgISFiZWZvcmUgPyBiZWZvcmUuYXBwcm92YWwgOiB1bmRlZmluZWQ7XG4gICAgY29uc3QgZGF0YSA9IHBhcmFtcy5kYXRhID9cbiAgICAgICAgcGFyYW1zLmRhdGEgOlxuICAgICAgICAhIWJlZm9yZSA/IGJlZm9yZS5kYXRhIDogdW5kZWZpbmVkO1xuICAgIGNvbnN0IHNkbUdvYWwgPSB7XG4gICAgICAgIC4uLmJlZm9yZSxcbiAgICAgICAgc3RhdGU6IHBhcmFtcy5zdGF0ZSA9PT0gXCJzdWNjZXNzXCIgJiYgISFiZWZvcmUgJiYgYmVmb3JlLmFwcHJvdmFsUmVxdWlyZWQgPyBcIndhaXRpbmdfZm9yX2FwcHJvdmFsXCIgOiBwYXJhbXMuc3RhdGUsXG4gICAgICAgIGRlc2NyaXB0aW9uLFxuICAgICAgICB1cmw6IHBhcmFtcy51cmwsXG4gICAgICAgIGFwcHJvdmFsLFxuICAgICAgICB0czogRGF0ZS5ub3coKSxcbiAgICAgICAgcHJvdmVuYW5jZTogW2NvbnN0cnVjdFByb3ZlbmFuY2UoY3R4KV0uY29uY2F0KCEhYmVmb3JlID8gYmVmb3JlLnByb3ZlbmFuY2UgOiBbXSksXG4gICAgICAgIGVycm9yOiBfLmdldChwYXJhbXMsIFwiZXJyb3IubWVzc2FnZVwiKSxcbiAgICAgICAgZGF0YSxcbiAgICB9O1xuICAgIGxvZ2dlci5kZWJ1ZyhcIlVwZGF0aW5nIFNkbUdvYWwgJXMgdG8gJXM6ICVqXCIsIHNkbUdvYWwuZXh0ZXJuYWxLZXksIHNkbUdvYWwuc3RhdGUsIHNkbUdvYWwpO1xuICAgIHJldHVybiBjdHgubWVzc2FnZUNsaWVudC5zZW5kKHNkbUdvYWwsIGFkZHJlc3NFdmVudChHb2FsUm9vdFR5cGUpKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdvYWxDb3JyZXNwb25kc1RvU2RtR29hbChnb2FsOiBHb2FsLCBzZG1Hb2FsOiBTZG1Hb2FsKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIGdvYWwubmFtZSA9PT0gc2RtR29hbC5uYW1lICYmIGVudmlyb25tZW50RnJvbUdvYWwoZ29hbCkgPT09IHNkbUdvYWwuZW52aXJvbm1lbnQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjb25zdHJ1Y3RTZG1Hb2FsSW1wbGVtZW50YXRpb24oZ2k6IEdvYWxJbXBsZW1lbnRhdGlvbik6IFNkbUdvYWxGdWxmaWxsbWVudCB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgbWV0aG9kOiBcIlNETSBmdWxmaWxsIG9uIHJlcXVlc3RlZFwiLFxuICAgICAgICBuYW1lOiBnaS5pbXBsZW1lbnRhdGlvbk5hbWUsXG4gICAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNvbnN0cnVjdFNkbUdvYWwoY3R4OiBIYW5kbGVyQ29udGV4dCwgcGFyYW1ldGVyczoge1xuICAgIGdvYWxTZXQ6IHN0cmluZyxcbiAgICBnb2FsU2V0SWQ6IHN0cmluZyxcbiAgICBnb2FsOiBHb2FsLFxuICAgIHN0YXRlOiBTZG1Hb2FsU3RhdGUsXG4gICAgaWQ6IFJlbW90ZVJlcG9SZWYsXG4gICAgcHJvdmlkZXJJZDogc3RyaW5nXG4gICAgdXJsPzogc3RyaW5nLFxuICAgIGZ1bGZpbGxtZW50PzogU2RtR29hbEZ1bGZpbGxtZW50LFxufSk6IFNkbUdvYWwge1xuICAgIGNvbnN0IHtnb2FsU2V0LCBnb2FsLCBnb2FsU2V0SWQsIHN0YXRlLCBpZCwgcHJvdmlkZXJJZCwgdXJsfSA9IHBhcmFtZXRlcnM7XG4gICAgY29uc3QgZnVsZmlsbG1lbnQgPSBwYXJhbWV0ZXJzLmZ1bGZpbGxtZW50IHx8IHttZXRob2Q6IFwib3RoZXJcIiwgbmFtZTogXCJ1bnNwZWNpZmllZFwifTtcblxuICAgIGlmICghaWQuYnJhbmNoKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihzcHJpbnRmKFwiUGxlYXNlIHByb3ZpZGUgYSBicmFuY2ggaW4gdGhlIFJlbW90ZVJlcG9SZWYgJWpcIiwgcGFyYW1ldGVycykpO1xuICAgIH1cbiAgICBpZiAoIWlkLnNoYSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3Ioc3ByaW50ZihcIlBsZWFzZSBwcm92aWRlIGEgc2hhIGluIHRoZSBSZW1vdGVSZXBvUmVmICVqXCIsIHBhcmFtZXRlcnMpKTtcbiAgICB9XG5cbiAgICBjb25zdCBwcmVDb25kaXRpb25zOiBTZG1Hb2FsS2V5W10gPSBbXTtcbiAgICBjb25zdCBkZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uRnJvbVN0YXRlKGdvYWwsIHN0YXRlKTtcbiAgICBjb25zdCBlbnZpcm9ubWVudCA9IGVudmlyb25tZW50RnJvbUdvYWwoZ29hbCk7XG4gICAgaWYgKGhhc1ByZWNvbmRpdGlvbnMoZ29hbCkpIHtcbiAgICAgICAgcHJlQ29uZGl0aW9ucy5wdXNoKC4uLmdvYWwuZGVwZW5kc09uLm1hcChkID0+ICh7XG4gICAgICAgICAgICBnb2FsU2V0LFxuICAgICAgICAgICAgbmFtZTogZC5uYW1lLFxuICAgICAgICAgICAgZW52aXJvbm1lbnQ6IGVudmlyb25tZW50RnJvbUdvYWwoZCksXG4gICAgICAgIH0pKSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgZ29hbFNldCxcbiAgICAgICAgZ29hbFNldElkLFxuICAgICAgICBuYW1lOiBnb2FsLm5hbWUsXG4gICAgICAgIHVuaXF1ZU5hbWU6IGdvYWwuZGVmaW5pdGlvbi51bmlxdWVOYW1lLFxuICAgICAgICBlbnZpcm9ubWVudCxcbiAgICAgICAgZnVsZmlsbG1lbnQsXG4gICAgICAgIHNoYTogaWQuc2hhLFxuICAgICAgICBicmFuY2g6IGlkLmJyYW5jaCxcbiAgICAgICAgcmVwbzoge1xuICAgICAgICAgICAgbmFtZTogaWQucmVwbyxcbiAgICAgICAgICAgIG93bmVyOiBpZC5vd25lcixcbiAgICAgICAgICAgIHByb3ZpZGVySWQsXG4gICAgICAgIH0sXG4gICAgICAgIHN0YXRlLFxuICAgICAgICBkZXNjcmlwdGlvbixcbiAgICAgICAgdXJsOiBkaXNyZWdhcmRBcHByb3ZhbCh1cmwpLCAvLyB3aGVuIHdlIHVzZSBnb2FscyBpbiBsaWZlY3ljbGUgdGhpcyBjYW4gZ29cbiAgICAgICAgZXh0ZXJuYWxLZXk6IGdvYWwuY29udGV4dCxcbiAgICAgICAgdHM6IERhdGUubm93KCksXG4gICAgICAgIGFwcHJvdmFsUmVxdWlyZWQ6IGdvYWwuZGVmaW5pdGlvbi5hcHByb3ZhbFJlcXVpcmVkID8gZ29hbC5kZWZpbml0aW9uLmFwcHJvdmFsUmVxdWlyZWQgOiBmYWxzZSxcbiAgICAgICAgcHJvdmVuYW5jZTogW2NvbnN0cnVjdFByb3ZlbmFuY2UoY3R4KV0sXG4gICAgICAgIHByZUNvbmRpdGlvbnMsXG4gICAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHN0b3JlR29hbChjdHg6IEhhbmRsZXJDb250ZXh0LCBzZG1Hb2FsOiBTZG1Hb2FsKSB7XG4gICAgbG9nZ2VyLmluZm8oXCJTdG9yaW5nIGdvYWw6ICVqXCIsIHNkbUdvYWwpO1xuICAgIHJldHVybiBjdHgubWVzc2FnZUNsaWVudC5zZW5kKHNkbUdvYWwsIGFkZHJlc3NFdmVudChHb2FsUm9vdFR5cGUpKVxuICAgICAgICAudGhlbigoKSA9PiBzZG1Hb2FsKTtcbn1cblxuZnVuY3Rpb24gY29uc3RydWN0UHJvdmVuYW5jZShjdHg6IEhhbmRsZXJDb250ZXh0KTogU2RtUHJvdmVuYW5jZSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVnaXN0cmF0aW9uOiAoY3R4IGFzIGFueSBhcyBBdXRvbWF0aW9uQ29udGV4dEF3YXJlKS5jb250ZXh0Lm5hbWUsXG4gICAgICAgIHZlcnNpb246IChjdHggYXMgYW55IGFzIEF1dG9tYXRpb25Db250ZXh0QXdhcmUpLmNvbnRleHQudmVyc2lvbixcbiAgICAgICAgbmFtZTogKGN0eCBhcyBhbnkgYXMgQXV0b21hdGlvbkNvbnRleHRBd2FyZSkuY29udGV4dC5vcGVyYXRpb24sXG4gICAgICAgIGNvcnJlbGF0aW9uSWQ6IGN0eC5jb3JyZWxhdGlvbklkLFxuICAgICAgICB0czogRGF0ZS5ub3coKSxcbiAgICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZGVzY3JpcHRpb25Gcm9tU3RhdGUoZ29hbDogR29hbCwgc3RhdGU6IFNkbUdvYWxTdGF0ZSk6IHN0cmluZyB7XG4gICAgc3dpdGNoIChzdGF0ZSkge1xuICAgICAgICBjYXNlIFwicGxhbm5lZFwiOlxuICAgICAgICBjYXNlIFwicmVxdWVzdGVkXCI6XG4gICAgICAgICAgICByZXR1cm4gZ29hbC5yZXF1ZXN0ZWREZXNjcmlwdGlvbjtcbiAgICAgICAgY2FzZSBcImluX3Byb2Nlc3NcIjpcbiAgICAgICAgICAgIHJldHVybiBnb2FsLmluUHJvY2Vzc0Rlc2NyaXB0aW9uO1xuICAgICAgICBjYXNlIFwid2FpdGluZ19mb3JfYXBwcm92YWxcIjpcbiAgICAgICAgICAgIHJldHVybiBnb2FsLndhaXRpbmdGb3JBcHByb3ZhbERlc2NyaXB0aW9uO1xuICAgICAgICBjYXNlIFwic3VjY2Vzc1wiOlxuICAgICAgICAgICAgcmV0dXJuIGdvYWwuc3VjY2Vzc0Rlc2NyaXB0aW9uO1xuICAgICAgICBjYXNlIFwiZmFpbHVyZVwiOlxuICAgICAgICAgICAgcmV0dXJuIGdvYWwuZmFpbHVyZURlc2NyaXB0aW9uO1xuICAgICAgICBjYXNlIFwic2tpcHBlZFwiOlxuICAgICAgICAgICAgcmV0dXJuIFwiU2tpcHBlZFwiOyAvLyB5b3UgcHJvYmFibHkgd2FudCB0byB1c2Ugc29tZXRoaW5nIHRoYXQgZGVzY3JpYmVzIHRoZSByZWFzb24gaW5zdGVhZC4gYnV0IGRvbid0IGVycm9yLlxuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVW5rbm93biBnb2FsIHN0YXRlIFwiICsgc3RhdGUpO1xuICAgIH1cbn1cbiJdfQ==