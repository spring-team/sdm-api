"use strict";/*
 * Copyright Â© 2018 Atomist, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var cov_jhasc7mj8=function(){var path="/Users/rodjohnson/sforzando-dev/idea-projects/my-flow/test/handlers/events/delivery/artifact/gitHubReleaseArtifactStoreTest.ts",hash="b4f51c912f3105dedd5ab6c1bfd401c0f1ce941d",Function=function(){}.constructor,global=new Function('return this')(),gcv="__coverage__",coverageData={path:"/Users/rodjohnson/sforzando-dev/idea-projects/my-flow/test/handlers/events/delivery/artifact/gitHubReleaseArtifactStoreTest.ts",statementMap:{"0":{start:{line:17,column:0},end:{line:17,column:62}},"1":{start:{line:18,column:24},end:{line:18,column:93}},"2":{start:{line:19,column:11},end:{line:19,column:24}},"3":{start:{line:20,column:15},end:{line:20,column:38}},"4":{start:{line:21,column:37},end:{line:21,column:116}},"5":{start:{line:22,column:22},end:{line:22,column:82}},"6":{start:{line:23,column:10},end:{line:23,column:25}},"7":{start:{line:24,column:14},end:{line:24,column:115}},"8":{start:{line:25,column:0},end:{line:51,column:3}},"9":{start:{line:26,column:4},end:{line:50,column:7}},"10":{start:{line:27,column:8},end:{line:38,column:26}},"11":{start:{line:28,column:26},end:{line:28,column:87}},"12":{start:{line:29,column:23},end:{line:29,column:81}},"13":{start:{line:30,column:12},end:{line:37,column:15}},"14":{start:{line:32,column:29},end:{line:32,column:55}},"15":{start:{line:33,column:16},end:{line:33,column:73}},"16":{start:{line:34,column:28},end:{line:34,column:43}},"17":{start:{line:35,column:33},end:{line:35,column:49}},"18":{start:{line:36,column:16},end:{line:36,column:78}},"19":{start:{line:39,column:8},end:{line:49,column:26}},"20":{start:{line:40,column:26},end:{line:40,column:87}},"21":{start:{line:41,column:23},end:{line:41,column:81}},"22":{start:{line:42,column:12},end:{line:48,column:15}},"23":{start:{line:44,column:16},end:{line:44,column:52}},"24":{start:{line:45,column:16},end:{line:45,column:50}},"25":{start:{line:46,column:16},end:{line:46,column:91}},"26":{start:{line:47,column:16},end:{line:47,column:116}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:25,column:39},end:{line:25,column:40}},loc:{start:{line:25,column:45},end:{line:51,column:1}},line:25},"1":{name:"(anonymous_1)",decl:{start:{line:26,column:25},end:{line:26,column:26}},loc:{start:{line:26,column:31},end:{line:50,column:5}},line:26},"2":{name:"(anonymous_2)",decl:{start:{line:27,column:44},end:{line:27,column:45}},loc:{start:{line:27,column:50},end:{line:38,column:9}},line:27},"3":{name:"(anonymous_3)",decl:{start:{line:31,column:22},end:{line:31,column:23}},loc:{start:{line:31,column:28},end:{line:37,column:13}},line:31},"4":{name:"(anonymous_4)",decl:{start:{line:39,column:62},end:{line:39,column:63}},loc:{start:{line:39,column:68},end:{line:49,column:9}},line:39},"5":{name:"(anonymous_5)",decl:{start:{line:43,column:22},end:{line:43,column:23}},loc:{start:{line:43,column:28},end:{line:48,column:13}},line:43}},branchMap:{},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0},b:{},_coverageSchema:"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c"},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();cov_jhasc7mj8.s[0]++;Object.defineProperty(exports,"__esModule",{value:true});const GitHubRepoRef_1=(cov_jhasc7mj8.s[1]++,require("@atomist/automation-client/operations/common/GitHubRepoRef"));const fs=(cov_jhasc7mj8.s[2]++,require("fs"));const assert=(cov_jhasc7mj8.s[3]++,require("power-assert"));const GitHubReleaseArtifactStore_1=(cov_jhasc7mj8.s[4]++,require("../../../../../src/common/artifact/github/GitHubReleaseArtifactStore"));const commandLine_1=(cov_jhasc7mj8.s[5]++,require("@atomist/automation-client/action/cli/commandLine"));const p=(cov_jhasc7mj8.s[6]++,require("path"));const asset=(cov_jhasc7mj8.s[7]++,"https://github.com/spring-team/fintan/releases/download/0.1.0-SNAPSHOT454/fintan-0.1.0-SNAPSHOT.jar");cov_jhasc7mj8.s[8]++;describe("GitHubReleaseArtifactStore",()=>{cov_jhasc7mj8.f[0]++;cov_jhasc7mj8.s[9]++;describe("checkout",()=>{cov_jhasc7mj8.f[1]++;cov_jhasc7mj8.s[10]++;it("should checkout existing file",()=>{cov_jhasc7mj8.f[2]++;const ghras=(cov_jhasc7mj8.s[11]++,new GitHubReleaseArtifactStore_1.GitHubReleaseArtifactStore());const id=(cov_jhasc7mj8.s[12]++,new GitHubRepoRef_1.GitHubRepoRef("spring-team","fintan"));cov_jhasc7mj8.s[13]++;return ghras.checkout(asset,id,{token:process.env.GITHUB_TOKEN}).then(da=>{cov_jhasc7mj8.f[3]++;const path=(cov_jhasc7mj8.s[14]++,`${da.cwd}/${da.filename}`);cov_jhasc7mj8.s[15]++;assert(fs.existsSync(path),`File [${path}] must exist`);const cwd=(cov_jhasc7mj8.s[16]++,p.dirname(path));const filename=(cov_jhasc7mj8.s[17]++,p.basename(path));cov_jhasc7mj8.s[18]++;return commandLine_1.runCommand(`unzip ${filename}`,{cwd});});}).timeout(60000);cov_jhasc7mj8.s[19]++;it("should checkout existing file and parse AppInfo",()=>{cov_jhasc7mj8.f[4]++;const ghras=(cov_jhasc7mj8.s[20]++,new GitHubReleaseArtifactStore_1.GitHubReleaseArtifactStore());const id=(cov_jhasc7mj8.s[21]++,new GitHubRepoRef_1.GitHubRepoRef("spring-team","fintan"));cov_jhasc7mj8.s[22]++;return ghras.checkout(asset,id,{token:process.env.GITHUB_TOKEN}).then(da=>{cov_jhasc7mj8.f[5]++;cov_jhasc7mj8.s[23]++;assert.equal(da.id.owner,id.owner);cov_jhasc7mj8.s[24]++;assert.equal(da.id.repo,id.repo);cov_jhasc7mj8.s[25]++;assert.equal(da.name,"fintan","name should be 'fintan', not "+da.name);cov_jhasc7mj8.s[26]++;assert.equal(da.version,"0.1.0-SNAPSHOT","version should be '0.1.0-SNAPSHOT', not "+da.version);});}).timeout(60000);});});//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL1VzZXJzL3JvZGpvaG5zb24vc2ZvcnphbmRvLWRldi9pZGVhLXByb2plY3RzL215LWZsb3cvdGVzdC9oYW5kbGVycy9ldmVudHMvZGVsaXZlcnkvYXJ0aWZhY3QvZ2l0SHViUmVsZWFzZUFydGlmYWN0U3RvcmVUZXN0LnRzIiwic291cmNlcyI6WyIvVXNlcnMvcm9kam9obnNvbi9zZm9yemFuZG8tZGV2L2lkZWEtcHJvamVjdHMvbXktZmxvdy90ZXN0L2hhbmRsZXJzL2V2ZW50cy9kZWxpdmVyeS9hcnRpZmFjdC9naXRIdWJSZWxlYXNlQXJ0aWZhY3RTdG9yZVRlc3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBOzs7Ozs7Ozs7Ozs7OztHQWNHOztBQUVILDhGQUEyRjtBQUMzRix5QkFBeUI7QUFDekIsdUNBQXVDO0FBQ3ZDLHFIQUU4RTtBQUU5RSxtRkFBK0U7QUFDL0UsMEJBQTBCO0FBRTFCLE1BQU0sS0FBSyxHQUFHLHFHQUFxRyxDQUFDO0FBRXBILFFBQVEsQ0FBQyw0QkFBNEIsRUFBRSxHQUFHLEVBQUU7SUFFeEMsUUFBUSxDQUFDLFVBQVUsRUFBRSxHQUFHLEVBQUU7UUFFdEIsRUFBRSxDQUFDLCtCQUErQixFQUFFLEdBQUcsRUFBRTtZQUNyQyxNQUFNLEtBQUssR0FBRyxJQUFJLHVEQUEwQixFQUFFLENBQUM7WUFDL0MsTUFBTSxFQUFFLEdBQUcsSUFBSSw2QkFBYSxDQUFDLGFBQWEsRUFBRSxRQUFRLENBQUMsQ0FBQztZQUN0RCxPQUFPLEtBQUssQ0FBQyxRQUFRLENBQUMsS0FBSyxFQUN2QixFQUFFLEVBQ0YsRUFBQyxLQUFLLEVBQUUsT0FBTyxDQUFDLEdBQUcsQ0FBQyxZQUFZLEVBQUMsQ0FBQztpQkFDakMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxFQUFFO2dCQUNQLE1BQU0sSUFBSSxHQUFHLEdBQUcsRUFBRSxDQUFDLEdBQUcsSUFBSSxFQUFFLENBQUMsUUFBUSxFQUFFLENBQUM7Z0JBQ3hDLE1BQU0sQ0FBQyxFQUFFLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxFQUFFLFNBQVMsSUFBSSxjQUFjLENBQUMsQ0FBQztnQkFDekQsTUFBTSxHQUFHLEdBQUcsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztnQkFDNUIsTUFBTSxRQUFRLEdBQUcsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQztnQkFDbEMsT0FBTyx3QkFBVSxDQUFDLFNBQVMsUUFBUSxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO1lBQ3BELENBQUMsQ0FBQyxDQUFDO1FBQ1gsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBRWxCLEVBQUUsQ0FBQyxpREFBaUQsRUFBRSxHQUFHLEVBQUU7WUFDdkQsTUFBTSxLQUFLLEdBQUcsSUFBSSx1REFBMEIsRUFBRSxDQUFDO1lBQy9DLE1BQU0sRUFBRSxHQUFHLElBQUksNkJBQWEsQ0FBQyxhQUFhLEVBQUUsUUFBUSxDQUFDLENBQUM7WUFDdEQsT0FBTyxLQUFLLENBQUMsUUFBUSxDQUFDLEtBQUssRUFDdkIsRUFBRSxFQUNGLEVBQUMsS0FBSyxFQUFFLE9BQU8sQ0FBQyxHQUFHLENBQUMsWUFBWSxFQUFDLENBQUM7aUJBQ2pDLElBQUksQ0FBQyxFQUFFLENBQUMsRUFBRTtnQkFDUCxNQUFNLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsS0FBSyxFQUFFLEVBQUUsQ0FBQyxLQUFLLENBQUMsQ0FBQztnQkFDcEMsTUFBTSxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLElBQUksRUFBRSxFQUFFLENBQUMsSUFBSSxDQUFDLENBQUM7Z0JBQ2xDLE1BQU0sQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDLElBQUksRUFBRSxRQUFRLEVBQUUsK0JBQStCLEdBQUcsRUFBRSxDQUFDLElBQUksQ0FBQyxDQUFDO2dCQUMzRSxNQUFNLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsMENBQTBDLEdBQUcsRUFBRSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1lBQ3hHLENBQUMsQ0FBQyxDQUFDO1FBQ1gsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ3RCLENBQUMsQ0FBQyxDQUFDO0FBRVAsQ0FBQyxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICogQ29weXJpZ2h0IMKpIDIwMTggQXRvbWlzdCwgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBHaXRIdWJSZXBvUmVmIH0gZnJvbSBcIkBhdG9taXN0L2F1dG9tYXRpb24tY2xpZW50L29wZXJhdGlvbnMvY29tbW9uL0dpdEh1YlJlcG9SZWZcIjtcbmltcG9ydCAqIGFzIGZzIGZyb20gXCJmc1wiO1xuaW1wb3J0ICogYXMgYXNzZXJ0IGZyb20gXCJwb3dlci1hc3NlcnRcIjtcbmltcG9ydCB7XG4gICAgR2l0SHViUmVsZWFzZUFydGlmYWN0U3RvcmUsXG59IGZyb20gXCIuLi8uLi8uLi8uLi8uLi9zcmMvY29tbW9uL2FydGlmYWN0L2dpdGh1Yi9HaXRIdWJSZWxlYXNlQXJ0aWZhY3RTdG9yZVwiO1xuXG5pbXBvcnQgeyBydW5Db21tYW5kIH0gZnJvbSBcIkBhdG9taXN0L2F1dG9tYXRpb24tY2xpZW50L2FjdGlvbi9jbGkvY29tbWFuZExpbmVcIjtcbmltcG9ydCAqIGFzIHAgZnJvbSBcInBhdGhcIjtcblxuY29uc3QgYXNzZXQgPSBcImh0dHBzOi8vZ2l0aHViLmNvbS9zcHJpbmctdGVhbS9maW50YW4vcmVsZWFzZXMvZG93bmxvYWQvMC4xLjAtU05BUFNIT1Q0NTQvZmludGFuLTAuMS4wLVNOQVBTSE9ULmphclwiO1xuXG5kZXNjcmliZShcIkdpdEh1YlJlbGVhc2VBcnRpZmFjdFN0b3JlXCIsICgpID0+IHtcblxuICAgIGRlc2NyaWJlKFwiY2hlY2tvdXRcIiwgKCkgPT4ge1xuXG4gICAgICAgIGl0KFwic2hvdWxkIGNoZWNrb3V0IGV4aXN0aW5nIGZpbGVcIiwgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZ2hyYXMgPSBuZXcgR2l0SHViUmVsZWFzZUFydGlmYWN0U3RvcmUoKTtcbiAgICAgICAgICAgIGNvbnN0IGlkID0gbmV3IEdpdEh1YlJlcG9SZWYoXCJzcHJpbmctdGVhbVwiLCBcImZpbnRhblwiKTtcbiAgICAgICAgICAgIHJldHVybiBnaHJhcy5jaGVja291dChhc3NldCxcbiAgICAgICAgICAgICAgICBpZCxcbiAgICAgICAgICAgICAgICB7dG9rZW46IHByb2Nlc3MuZW52LkdJVEhVQl9UT0tFTn0pXG4gICAgICAgICAgICAgICAgLnRoZW4oZGEgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXRoID0gYCR7ZGEuY3dkfS8ke2RhLmZpbGVuYW1lfWA7XG4gICAgICAgICAgICAgICAgICAgIGFzc2VydChmcy5leGlzdHNTeW5jKHBhdGgpLCBgRmlsZSBbJHtwYXRofV0gbXVzdCBleGlzdGApO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBjd2QgPSBwLmRpcm5hbWUocGF0aCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVuYW1lID0gcC5iYXNlbmFtZShwYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJ1bkNvbW1hbmQoYHVuemlwICR7ZmlsZW5hbWV9YCwgeyBjd2QgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pLnRpbWVvdXQoNjAwMDApO1xuXG4gICAgICAgIGl0KFwic2hvdWxkIGNoZWNrb3V0IGV4aXN0aW5nIGZpbGUgYW5kIHBhcnNlIEFwcEluZm9cIiwgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZ2hyYXMgPSBuZXcgR2l0SHViUmVsZWFzZUFydGlmYWN0U3RvcmUoKTtcbiAgICAgICAgICAgIGNvbnN0IGlkID0gbmV3IEdpdEh1YlJlcG9SZWYoXCJzcHJpbmctdGVhbVwiLCBcImZpbnRhblwiKTtcbiAgICAgICAgICAgIHJldHVybiBnaHJhcy5jaGVja291dChhc3NldCxcbiAgICAgICAgICAgICAgICBpZCxcbiAgICAgICAgICAgICAgICB7dG9rZW46IHByb2Nlc3MuZW52LkdJVEhVQl9UT0tFTn0pXG4gICAgICAgICAgICAgICAgLnRoZW4oZGEgPT4ge1xuICAgICAgICAgICAgICAgICAgICBhc3NlcnQuZXF1YWwoZGEuaWQub3duZXIsIGlkLm93bmVyKTtcbiAgICAgICAgICAgICAgICAgICAgYXNzZXJ0LmVxdWFsKGRhLmlkLnJlcG8sIGlkLnJlcG8pO1xuICAgICAgICAgICAgICAgICAgICBhc3NlcnQuZXF1YWwoZGEubmFtZSwgXCJmaW50YW5cIiwgXCJuYW1lIHNob3VsZCBiZSAnZmludGFuJywgbm90IFwiICsgZGEubmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIGFzc2VydC5lcXVhbChkYS52ZXJzaW9uLCBcIjAuMS4wLVNOQVBTSE9UXCIsIFwidmVyc2lvbiBzaG91bGQgYmUgJzAuMS4wLVNOQVBTSE9UJywgbm90IFwiICsgZGEudmVyc2lvbik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pLnRpbWVvdXQoNjAwMDApO1xuICAgIH0pO1xuXG59KTtcbiJdfQ==