"use strict";/*
 * Copyright Â© 2018 Atomist, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var cov_15qdrolsoz=function(){var path="/Users/rodjohnson/sforzando-dev/idea-projects/my-flow/src/util/webhook/sendFingerprint.ts",hash="55ff27de8a82ee91200f080ef1b1407eb5c195d4",Function=function(){}.constructor,global=new Function('return this')(),gcv="__coverage__",coverageData={path:"/Users/rodjohnson/sforzando-dev/idea-projects/my-flow/src/util/webhook/sendFingerprint.ts",statementMap:{"0":{start:{line:17,column:0},end:{line:17,column:62}},"1":{start:{line:18,column:28},end:{line:18,column:65}},"2":{start:{line:19,column:16},end:{line:19,column:32}},"3":{start:{line:28,column:16},end:{line:28,column:80}},"4":{start:{line:29,column:20},end:{line:37,column:5}},"5":{start:{line:38,column:4},end:{line:38,column:86}},"6":{start:{line:39,column:4},end:{line:42,column:7}},"7":{start:{line:41,column:8},end:{line:41,column:76}},"8":{start:{line:44,column:0},end:{line:44,column:42}}},fnMap:{"0":{name:"sendFingerprint",decl:{start:{line:27,column:9},end:{line:27,column:24}},loc:{start:{line:27,column:48},end:{line:43,column:1}},line:27},"1":{name:"(anonymous_1)",decl:{start:{line:40,column:15},end:{line:40,column:16}},loc:{start:{line:40,column:22},end:{line:42,column:5}},line:40}},branchMap:{},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0},f:{"0":0,"1":0},b:{},_coverageSchema:"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c"},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();cov_15qdrolsoz.s[0]++;Object.defineProperty(exports,"__esModule",{value:true});const automation_client_1=(cov_15qdrolsoz.s[1]++,require("@atomist/automation-client"));const axios_1=(cov_15qdrolsoz.s[2]++,require("axios"));/**
 * Publish the given fingerprint to Atomist in the given team
 * @param {GitHubRepoRef} id id of repo the fingerprint applies to
 * @param {Fingerprint} fingerprint fingerprint to publish
 * @param {string} team team to which this fingerprint applies
 * @return {Promise<any>}
 */function sendFingerprint(id,fingerprint,team){cov_15qdrolsoz.f[0]++;const url=(cov_15qdrolsoz.s[3]++,`https://webhook.atomist.com/atomist/fingerprints/teams/${team}`);const payload=(cov_15qdrolsoz.s[4]++,{commit:{provider:id.providerType,owner:id.owner,repo:id.repo,sha:id.sha},fingerprints:[fingerprint]});cov_15qdrolsoz.s[5]++;automation_client_1.logger.info("Sending up fingerprint to %s: %j",url,payload);cov_15qdrolsoz.s[6]++;return axios_1.default.post(url,payload).catch(err=>{cov_15qdrolsoz.f[1]++;cov_15qdrolsoz.s[7]++;return Promise.reject(`Axios error calling ${url}: ${err.message}`);});}cov_15qdrolsoz.s[8]++;exports.sendFingerprint=sendFingerprint;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL1VzZXJzL3JvZGpvaG5zb24vc2ZvcnphbmRvLWRldi9pZGVhLXByb2plY3RzL215LWZsb3cvc3JjL3V0aWwvd2ViaG9vay9zZW5kRmluZ2VycHJpbnQudHMiLCJzb3VyY2VzIjpbIi9Vc2Vycy9yb2Rqb2huc29uL3Nmb3J6YW5kby1kZXYvaWRlYS1wcm9qZWN0cy9teS1mbG93L3NyYy91dGlsL3dlYmhvb2svc2VuZEZpbmdlcnByaW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTs7Ozs7Ozs7Ozs7Ozs7R0FjRzs7QUFFSCxrRUFBb0Q7QUFHcEQsaUNBQTBCO0FBRTFCOzs7Ozs7R0FNRztBQUNILHlCQUFnQyxFQUFpQixFQUFFLFdBQXdCLEVBQUUsSUFBWTtJQUNyRixNQUFNLEdBQUcsR0FBRywwREFBMEQsSUFBSSxFQUFFLENBQUM7SUFDN0UsTUFBTSxPQUFPLEdBQUc7UUFDWixNQUFNLEVBQUU7WUFDSixRQUFRLEVBQUUsRUFBRSxDQUFDLFlBQVk7WUFDekIsS0FBSyxFQUFFLEVBQUUsQ0FBQyxLQUFLO1lBQ2YsSUFBSSxFQUFFLEVBQUUsQ0FBQyxJQUFJO1lBQ2IsR0FBRyxFQUFFLEVBQUUsQ0FBQyxHQUFHO1NBQ2Q7UUFDRCxZQUFZLEVBQUUsQ0FBQyxXQUFXLENBQUM7S0FDOUIsQ0FBQztJQUNGLDBCQUFNLENBQUMsSUFBSSxDQUFDLGtDQUFrQyxFQUFFLEdBQUcsRUFBRSxPQUFPLENBQUMsQ0FBQztJQUM5RCxPQUFPLGVBQUssQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLE9BQU8sQ0FBQztTQUMxQixLQUFLLENBQUMsR0FBRyxDQUFDLEVBQUU7UUFDVCxPQUFPLE9BQU8sQ0FBQyxNQUFNLENBQUMsdUJBQXVCLEdBQUcsS0FBSyxHQUFHLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQztJQUN4RSxDQUFDLENBQUMsQ0FBQztBQUNYLENBQUM7QUFoQkQsMENBZ0JDIiwic291cmNlc0NvbnRlbnQiOlsiLypcbiAqIENvcHlyaWdodCDCqSAyMDE4IEF0b21pc3QsIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHsgbG9nZ2VyIH0gZnJvbSBcIkBhdG9taXN0L2F1dG9tYXRpb24tY2xpZW50XCI7XG5pbXBvcnQgeyBSZW1vdGVSZXBvUmVmIH0gZnJvbSBcIkBhdG9taXN0L2F1dG9tYXRpb24tY2xpZW50L29wZXJhdGlvbnMvY29tbW9uL1JlcG9JZFwiO1xuaW1wb3J0IHsgRmluZ2VycHJpbnQgfSBmcm9tIFwiQGF0b21pc3QvYXV0b21hdGlvbi1jbGllbnQvcHJvamVjdC9maW5nZXJwcmludC9GaW5nZXJwcmludFwiO1xuaW1wb3J0IGF4aW9zIGZyb20gXCJheGlvc1wiO1xuXG4vKipcbiAqIFB1Ymxpc2ggdGhlIGdpdmVuIGZpbmdlcnByaW50IHRvIEF0b21pc3QgaW4gdGhlIGdpdmVuIHRlYW1cbiAqIEBwYXJhbSB7R2l0SHViUmVwb1JlZn0gaWQgaWQgb2YgcmVwbyB0aGUgZmluZ2VycHJpbnQgYXBwbGllcyB0b1xuICogQHBhcmFtIHtGaW5nZXJwcmludH0gZmluZ2VycHJpbnQgZmluZ2VycHJpbnQgdG8gcHVibGlzaFxuICogQHBhcmFtIHtzdHJpbmd9IHRlYW0gdGVhbSB0byB3aGljaCB0aGlzIGZpbmdlcnByaW50IGFwcGxpZXNcbiAqIEByZXR1cm4ge1Byb21pc2U8YW55Pn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNlbmRGaW5nZXJwcmludChpZDogUmVtb3RlUmVwb1JlZiwgZmluZ2VycHJpbnQ6IEZpbmdlcnByaW50LCB0ZWFtOiBzdHJpbmcpOiBQcm9taXNlPGFueT4ge1xuICAgIGNvbnN0IHVybCA9IGBodHRwczovL3dlYmhvb2suYXRvbWlzdC5jb20vYXRvbWlzdC9maW5nZXJwcmludHMvdGVhbXMvJHt0ZWFtfWA7XG4gICAgY29uc3QgcGF5bG9hZCA9IHtcbiAgICAgICAgY29tbWl0OiB7XG4gICAgICAgICAgICBwcm92aWRlcjogaWQucHJvdmlkZXJUeXBlLFxuICAgICAgICAgICAgb3duZXI6IGlkLm93bmVyLFxuICAgICAgICAgICAgcmVwbzogaWQucmVwbyxcbiAgICAgICAgICAgIHNoYTogaWQuc2hhLFxuICAgICAgICB9LFxuICAgICAgICBmaW5nZXJwcmludHM6IFtmaW5nZXJwcmludF0sXG4gICAgfTtcbiAgICBsb2dnZXIuaW5mbyhcIlNlbmRpbmcgdXAgZmluZ2VycHJpbnQgdG8gJXM6ICVqXCIsIHVybCwgcGF5bG9hZCk7XG4gICAgcmV0dXJuIGF4aW9zLnBvc3QodXJsLCBwYXlsb2FkKVxuICAgICAgICAuY2F0Y2goZXJyID0+IHtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgQXhpb3MgZXJyb3IgY2FsbGluZyAke3VybH06ICR7ZXJyLm1lc3NhZ2V9YCk7XG4gICAgICAgIH0pO1xufVxuIl19