"use strict";/*
 * Copyright Â© 2018 Atomist, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var cov_27aellg5nb=function(){var path="/Users/rodjohnson/sforzando-dev/idea-projects/my-flow/src/util/lifecycleHelpers.ts",hash="8e142003808df60f3b467517cb854b6c32538130",Function=function(){}.constructor,global=new Function('return this')(),gcv="__coverage__",coverageData={path:"/Users/rodjohnson/sforzando-dev/idea-projects/my-flow/src/util/lifecycleHelpers.ts",statementMap:{"0":{start:{line:17,column:0},end:{line:17,column:62}},"1":{start:{line:18,column:14},end:{line:18,column:62}},"2":{start:{line:19,column:10},end:{line:19,column:27}},"3":{start:{line:27,column:18},end:{line:27,column:40}},"4":{start:{line:28,column:25},end:{line:28,column:44}},"5":{start:{line:29,column:24},end:{line:29,column:54}},"6":{start:{line:30,column:4},end:{line:32,column:5}},"7":{start:{line:31,column:8},end:{line:31,column:27}},"8":{start:{line:33,column:24},end:{line:33,column:52}},"9":{start:{line:34,column:23},end:{line:34,column:53}},"10":{start:{line:35,column:25},end:{line:35,column:27}},"11":{start:{line:36,column:18},end:{line:36,column:19}},"12":{start:{line:38,column:4},end:{line:60,column:5}},"13":{start:{line:39,column:23},end:{line:39,column:37}},"14":{start:{line:40,column:8},end:{line:53,column:9}},"15":{start:{line:41,column:12},end:{line:41,column:38}},"16":{start:{line:43,column:13},end:{line:53,column:9}},"17":{start:{line:44,column:12},end:{line:44,column:28}},"18":{start:{line:46,column:13},end:{line:53,column:9}},"19":{start:{line:47,column:12},end:{line:47,column:24}},"20":{start:{line:48,column:12},end:{line:48,column:21}},"21":{start:{line:50,column:13},end:{line:53,column:9}},"22":{start:{line:51,column:12},end:{line:51,column:24}},"23":{start:{line:52,column:12},end:{line:52,column:21}},"24":{start:{line:54,column:8},end:{line:58,column:9}},"25":{start:{line:55,column:22},end:{line:55,column:42}},"26":{start:{line:56,column:12},end:{line:56,column:62}},"27":{start:{line:57,column:12},end:{line:57,column:18}},"28":{start:{line:59,column:8},end:{line:59,column:34}},"29":{start:{line:61,column:4},end:{line:61,column:53}},"30":{start:{line:63,column:0},end:{line:63,column:54}},"31":{start:{line:71,column:4},end:{line:71,column:40}},"32":{start:{line:73,column:0},end:{line:73,column:28}},"33":{start:{line:75,column:4},end:{line:84,column:5}},"34":{start:{line:76,column:26},end:{line:76,column:47}},"35":{start:{line:77,column:8},end:{line:79,column:9}},"36":{start:{line:78,column:12},end:{line:78,column:51}},"37":{start:{line:80,column:8},end:{line:80,column:27}},"38":{start:{line:83,column:8},end:{line:83,column:36}},"39":{start:{line:86,column:0},end:{line:86,column:26}},"40":{start:{line:87,column:0},end:{line:87,column:56}},"41":{start:{line:89,column:4},end:{line:98,column:5}},"42":{start:{line:90,column:26},end:{line:90,column:50}},"43":{start:{line:91,column:8},end:{line:93,column:9}},"44":{start:{line:92,column:12},end:{line:92,column:51}},"45":{start:{line:94,column:8},end:{line:94,column:27}},"46":{start:{line:97,column:8},end:{line:97,column:43}},"47":{start:{line:100,column:0},end:{line:100,column:24}},"48":{start:{line:102,column:4},end:{line:102,column:39}},"49":{start:{line:104,column:0},end:{line:104,column:26}},"50":{start:{line:106,column:4},end:{line:111,column:5}},"51":{start:{line:107,column:8},end:{line:107,column:51}},"52":{start:{line:110,column:8},end:{line:110,column:64}},"53":{start:{line:113,column:0},end:{line:113,column:30}},"54":{start:{line:115,column:4},end:{line:115,column:69}},"55":{start:{line:117,column:0},end:{line:117,column:30}},"56":{start:{line:126,column:24},end:{line:126,column:57}},"57":{start:{line:127,column:23},end:{line:127,column:44}},"58":{start:{line:128,column:4},end:{line:138,column:5}},"59":{start:{line:129,column:22},end:{line:129,column:35}},"60":{start:{line:130,column:8},end:{line:134,column:10}},"61":{start:{line:137,column:8},end:{line:137,column:20}},"62":{start:{line:151,column:28},end:{line:151,column:59}},"63":{start:{line:153,column:22},end:{line:153,column:81}},"64":{start:{line:154,column:24},end:{line:154,column:26}},"65":{start:{line:155,column:22},end:{line:155,column:49}},"66":{start:{line:156,column:4},end:{line:175,column:5}},"67":{start:{line:157,column:8},end:{line:174,column:9}},"68":{start:{line:160,column:12},end:{line:166,column:13}},"69":{start:{line:161,column:28},end:{line:161,column:36}},"70":{start:{line:162,column:35},end:{line:162,column:60}},"71":{start:{line:163,column:16},end:{line:165,column:17}},"72":{start:{line:164,column:20},end:{line:164,column:49}},"73":{start:{line:169,column:24},end:{line:169,column:36}},"74":{start:{line:170,column:31},end:{line:170,column:56}},"75":{start:{line:171,column:12},end:{line:173,column:13}},"76":{start:{line:172,column:16},end:{line:172,column:45}},"77":{start:{line:176,column:30},end:{line:176,column:32}},"78":{start:{line:177,column:4},end:{line:181,column:7}},"79":{start:{line:178,column:8},end:{line:180,column:9}},"80":{start:{line:178,column:42},end:{line:178,column:70}},"81":{start:{line:179,column:12},end:{line:179,column:38}},"82":{start:{line:182,column:4},end:{line:182,column:29}},"83":{start:{line:184,column:0},end:{line:184,column:44}},"84":{start:{line:193,column:4},end:{line:195,column:5}},"85":{start:{line:194,column:8},end:{line:194,column:20}},"86":{start:{line:196,column:21},end:{line:196,column:95}},"87":{start:{line:197,column:22},end:{line:197,column:42}},"88":{start:{line:198,column:20},end:{line:198,column:33}},"89":{start:{line:199,column:4},end:{line:211,column:5}},"90":{start:{line:200,column:22},end:{line:200,column:34}},"91":{start:{line:201,column:33},end:{line:201,column:58}},"92":{start:{line:202,column:8},end:{line:209,column:11}},"93":{start:{line:203,column:33},end:{line:203,column:88}},"94":{start:{line:204,column:28},end:{line:204,column:75}},"95":{start:{line:205,column:26},end:{line:205,column:87}},"96":{start:{line:206,column:29},end:{line:206,column:59}},"97":{start:{line:207,column:26},end:{line:207,column:64}},"98":{start:{line:208,column:12},end:{line:208,column:62}},"99":{start:{line:210,column:8},end:{line:210,column:31}},"100":{start:{line:212,column:4},end:{line:212,column:30}},"101":{start:{line:214,column:0},end:{line:214,column:32}},"102":{start:{line:215,column:24},end:{line:215,column:56}},"103":{start:{line:229,column:29},end:{line:229,column:42}},"104":{start:{line:231,column:26},end:{line:231,column:126}},"105":{start:{line:232,column:27},end:{line:232,column:61}},"106":{start:{line:241,column:24},end:{line:241,column:26}},"107":{start:{line:244,column:4},end:{line:250,column:5}},"108":{start:{line:245,column:22},end:{line:245,column:32}},"109":{start:{line:246,column:21},end:{line:246,column:31}},"110":{start:{line:247,column:22},end:{line:247,column:32}},"111":{start:{line:248,column:21},end:{line:248,column:62}},"112":{start:{line:249,column:8},end:{line:249,column:45}},"113":{start:{line:251,column:4},end:{line:251,column:31}},"114":{start:{line:253,column:0},end:{line:253,column:44}}},fnMap:{"0":{name:"truncateCommitMessage",decl:{start:{line:26,column:9},end:{line:26,column:30}},loc:{start:{line:26,column:46},end:{line:62,column:1}},line:26},"1":{name:"repoSlug",decl:{start:{line:70,column:9},end:{line:70,column:17}},loc:{start:{line:70,column:24},end:{line:72,column:1}},line:70},"2":{name:"htmlUrl",decl:{start:{line:74,column:9},end:{line:74,column:16}},loc:{start:{line:74,column:23},end:{line:85,column:1}},line:74},"3":{name:"apiUrl",decl:{start:{line:88,column:9},end:{line:88,column:15}},loc:{start:{line:88,column:22},end:{line:99,column:1}},line:88},"4":{name:"userUrl",decl:{start:{line:101,column:9},end:{line:101,column:16}},loc:{start:{line:101,column:30},end:{line:103,column:1}},line:101},"5":{name:"avatarUrl",decl:{start:{line:105,column:9},end:{line:105,column:18}},loc:{start:{line:105,column:32},end:{line:112,column:1}},line:105},"6":{name:"commitUrl",decl:{start:{line:114,column:9},end:{line:114,column:18}},loc:{start:{line:114,column:33},end:{line:116,column:1}},line:114},"7":{name:"urlToImageAttachment",decl:{start:{line:125,column:9},end:{line:125,column:29}},loc:{start:{line:125,column:35},end:{line:139,column:1}},line:125},"8":{name:"extractImageUrls",decl:{start:{line:150,column:9},end:{line:150,column:25}},loc:{start:{line:150,column:32},end:{line:183,column:1}},line:150},"9":{name:"(anonymous_9)",decl:{start:{line:177,column:24},end:{line:177,column:25}},loc:{start:{line:177,column:29},end:{line:181,column:5}},line:177},"10":{name:"(anonymous_10)",decl:{start:{line:178,column:36},end:{line:178,column:37}},loc:{start:{line:178,column:42},end:{line:178,column:70}},line:178},"11":{name:"linkIssues",decl:{start:{line:192,column:9},end:{line:192,column:19}},loc:{start:{line:192,column:32},end:{line:213,column:1}},line:192},"12":{name:"(anonymous_12)",decl:{start:{line:202,column:33},end:{line:202,column:34}},loc:{start:{line:202,column:38},end:{line:209,column:9}},line:202},"13":{name:"getIssueMentions",decl:{start:{line:240,column:9},end:{line:240,column:25}},loc:{start:{line:240,column:36},end:{line:252,column:1}},line:240}},branchMap:{"0":{loc:{start:{line:30,column:4},end:{line:32,column:5}},type:"if",locations:[{start:{line:30,column:4},end:{line:32,column:5}},{start:{line:30,column:4},end:{line:32,column:5}}],line:30},"1":{loc:{start:{line:40,column:8},end:{line:53,column:9}},type:"if",locations:[{start:{line:40,column:8},end:{line:53,column:9}},{start:{line:40,column:8},end:{line:53,column:9}}],line:40},"2":{loc:{start:{line:43,column:13},end:{line:53,column:9}},type:"if",locations:[{start:{line:43,column:13},end:{line:53,column:9}},{start:{line:43,column:13},end:{line:53,column:9}}],line:43},"3":{loc:{start:{line:46,column:13},end:{line:53,column:9}},type:"if",locations:[{start:{line:46,column:13},end:{line:53,column:9}},{start:{line:46,column:13},end:{line:53,column:9}}],line:46},"4":{loc:{start:{line:50,column:13},end:{line:53,column:9}},type:"if",locations:[{start:{line:50,column:13},end:{line:53,column:9}},{start:{line:50,column:13},end:{line:53,column:9}}],line:50},"5":{loc:{start:{line:54,column:8},end:{line:58,column:9}},type:"if",locations:[{start:{line:54,column:8},end:{line:58,column:9}},{start:{line:54,column:8},end:{line:58,column:9}}],line:54},"6":{loc:{start:{line:75,column:4},end:{line:84,column:5}},type:"if",locations:[{start:{line:75,column:4},end:{line:84,column:5}},{start:{line:75,column:4},end:{line:84,column:5}}],line:75},"7":{loc:{start:{line:75,column:8},end:{line:75,column:62}},type:"binary-expr",locations:[{start:{line:75,column:8},end:{line:75,column:16}},{start:{line:75,column:20},end:{line:75,column:37}},{start:{line:75,column:41},end:{line:75,column:62}}],line:75},"8":{loc:{start:{line:77,column:8},end:{line:79,column:9}},type:"if",locations:[{start:{line:77,column:8},end:{line:79,column:9}},{start:{line:77,column:8},end:{line:79,column:9}}],line:77},"9":{loc:{start:{line:89,column:4},end:{line:98,column:5}},type:"if",locations:[{start:{line:89,column:4},end:{line:98,column:5}},{start:{line:89,column:4},end:{line:98,column:5}}],line:89},"10":{loc:{start:{line:89,column:8},end:{line:89,column:62}},type:"binary-expr",locations:[{start:{line:89,column:8},end:{line:89,column:16}},{start:{line:89,column:20},end:{line:89,column:37}},{start:{line:89,column:41},end:{line:89,column:62}}],line:89},"11":{loc:{start:{line:91,column:8},end:{line:93,column:9}},type:"if",locations:[{start:{line:91,column:8},end:{line:93,column:9}},{start:{line:91,column:8},end:{line:93,column:9}}],line:91},"12":{loc:{start:{line:106,column:4},end:{line:111,column:5}},type:"if",locations:[{start:{line:106,column:4},end:{line:111,column:5}},{start:{line:106,column:4},end:{line:111,column:5}}],line:106},"13":{loc:{start:{line:106,column:8},end:{line:106,column:86}},type:"binary-expr",locations:[{start:{line:106,column:8},end:{line:106,column:24}},{start:{line:106,column:28},end:{line:106,column:53}},{start:{line:106,column:57},end:{line:106,column:86}}],line:106},"14":{loc:{start:{line:128,column:4},end:{line:138,column:5}},type:"if",locations:[{start:{line:128,column:4},end:{line:138,column:5}},{start:{line:128,column:4},end:{line:138,column:5}}],line:128},"15":{loc:{start:{line:157,column:8},end:{line:174,column:9}},type:"if",locations:[{start:{line:157,column:8},end:{line:174,column:9}},{start:{line:157,column:8},end:{line:174,column:9}}],line:157},"16":{loc:{start:{line:163,column:16},end:{line:165,column:17}},type:"if",locations:[{start:{line:163,column:16},end:{line:165,column:17}},{start:{line:163,column:16},end:{line:165,column:17}}],line:163},"17":{loc:{start:{line:171,column:12},end:{line:173,column:13}},type:"if",locations:[{start:{line:171,column:12},end:{line:173,column:13}},{start:{line:171,column:12},end:{line:173,column:13}}],line:171},"18":{loc:{start:{line:178,column:8},end:{line:180,column:9}},type:"if",locations:[{start:{line:178,column:8},end:{line:180,column:9}},{start:{line:178,column:8},end:{line:180,column:9}}],line:178},"19":{loc:{start:{line:193,column:4},end:{line:195,column:5}},type:"if",locations:[{start:{line:193,column:4},end:{line:195,column:5}},{start:{line:193,column:4},end:{line:195,column:5}}],line:193},"20":{loc:{start:{line:193,column:8},end:{line:193,column:34}},type:"binary-expr",locations:[{start:{line:193,column:8},end:{line:193,column:13}},{start:{line:193,column:17},end:{line:193,column:34}}],line:193},"21":{loc:{start:{line:203,column:33},end:{line:203,column:88}},type:"cond-expr",locations:[{start:{line:203,column:58},end:{line:203,column:65}},{start:{line:203,column:68},end:{line:203,column:88}}],line:203},"22":{loc:{start:{line:205,column:26},end:{line:205,column:87}},type:"cond-expr",locations:[{start:{line:205,column:51},end:{line:205,column:83}},{start:{line:205,column:86},end:{line:205,column:87}}],line:205},"23":{loc:{start:{line:240,column:26},end:{line:240,column:34}},type:"default-arg",locations:[{start:{line:240,column:32},end:{line:240,column:34}}],line:240},"24":{loc:{start:{line:248,column:21},end:{line:248,column:62}},type:"cond-expr",locations:[{start:{line:248,column:39},end:{line:248,column:57}},{start:{line:248,column:60},end:{line:248,column:62}}],line:248},"25":{loc:{start:{line:248,column:22},end:{line:248,column:35}},type:"binary-expr",locations:[{start:{line:248,column:22},end:{line:248,column:27}},{start:{line:248,column:31},end:{line:248,column:35}}],line:248}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0,0],"8":[0,0],"9":[0,0],"10":[0,0,0],"11":[0,0],"12":[0,0],"13":[0,0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0],"24":[0,0],"25":[0,0]},_coverageSchema:"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c"},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();cov_27aellg5nb.s[0]++;Object.defineProperty(exports,"__esModule",{value:true});const slack=(cov_27aellg5nb.s[1]++,require("@atomist/slack-messages/SlackMessages"));const _=(cov_27aellg5nb.s[2]++,require("lodash"));// This file copied from atomist/lifecycle-automation
/**
 * Safely truncate the first line of a commit message to 50 characters
 * or less.  Only count printable characters, i.e., not link URLs or
 * markup.
 */function truncateCommitMessage(message,repo){cov_27aellg5nb.f[0]++;const title=(cov_27aellg5nb.s[3]++,message.split("\n")[0]);const escapedTitle=(cov_27aellg5nb.s[4]++,slack.escape(title));const linkedTitle=(cov_27aellg5nb.s[5]++,linkIssues(escapedTitle,repo));cov_27aellg5nb.s[6]++;if(linkedTitle.length<=50){cov_27aellg5nb.b[0][0]++;cov_27aellg5nb.s[7]++;return linkedTitle;}else{cov_27aellg5nb.b[0][1]++;}const splitRegExp=(cov_27aellg5nb.s[8]++,/(&(?:[gl]t|amp);|<.*?\||>)/);const titleParts=(cov_27aellg5nb.s[9]++,linkedTitle.split(splitRegExp));let truncatedTitle=(cov_27aellg5nb.s[10]++,"");let addNext=(cov_27aellg5nb.s[11]++,1);let i;cov_27aellg5nb.s[12]++;for(i=0;i<titleParts.length;i++){let newTitle=(cov_27aellg5nb.s[13]++,truncatedTitle);cov_27aellg5nb.s[14]++;if(i%2===0){cov_27aellg5nb.b[1][0]++;cov_27aellg5nb.s[15]++;newTitle+=titleParts[i];}else{cov_27aellg5nb.b[1][1]++;cov_27aellg5nb.s[16]++;if(/^&(?:[gl]t|amp);$/.test(titleParts[i])){cov_27aellg5nb.b[2][0]++;cov_27aellg5nb.s[17]++;newTitle+="&";}else{cov_27aellg5nb.b[2][1]++;cov_27aellg5nb.s[18]++;if(/^<.*\|$/.test(titleParts[i])){cov_27aellg5nb.b[3][0]++;cov_27aellg5nb.s[19]++;addNext=2;cov_27aellg5nb.s[20]++;continue;}else{cov_27aellg5nb.b[3][1]++;cov_27aellg5nb.s[21]++;if(titleParts[i]===">"){cov_27aellg5nb.b[4][0]++;cov_27aellg5nb.s[22]++;addNext=1;cov_27aellg5nb.s[23]++;continue;}else{cov_27aellg5nb.b[4][1]++;}}}}cov_27aellg5nb.s[24]++;if(newTitle.length>50){cov_27aellg5nb.b[5][0]++;const l=(cov_27aellg5nb.s[25]++,50-newTitle.length);cov_27aellg5nb.s[26]++;titleParts[i]=titleParts[i].slice(0,l)+"...";cov_27aellg5nb.s[27]++;break;}else{cov_27aellg5nb.b[5][1]++;}cov_27aellg5nb.s[28]++;truncatedTitle=newTitle;}cov_27aellg5nb.s[29]++;return titleParts.slice(0,i+addNext).join("");}cov_27aellg5nb.s[30]++;exports.truncateCommitMessage=truncateCommitMessage;/**
 * Generate GitHub repository "slug", i.e., owner/repo.
 *
 * @param repo repository with .owner and .name
 * @return owner/name string
 */function repoSlug(repo){cov_27aellg5nb.f[1]++;cov_27aellg5nb.s[31]++;return`${repo.owner}/${repo.name}`;}cov_27aellg5nb.s[32]++;exports.repoSlug=repoSlug;function htmlUrl(repo){cov_27aellg5nb.f[2]++;cov_27aellg5nb.s[33]++;if((cov_27aellg5nb.b[7][0]++,repo.org)&&(cov_27aellg5nb.b[7][1]++,repo.org.provider)&&(cov_27aellg5nb.b[7][2]++,repo.org.provider.url)){cov_27aellg5nb.b[6][0]++;let providerUrl=(cov_27aellg5nb.s[34]++,repo.org.provider.url);cov_27aellg5nb.s[35]++;if(providerUrl.slice(-1)==="/"){cov_27aellg5nb.b[8][0]++;cov_27aellg5nb.s[36]++;providerUrl=providerUrl.slice(0,-1);}else{cov_27aellg5nb.b[8][1]++;}cov_27aellg5nb.s[37]++;return providerUrl;}else{cov_27aellg5nb.b[6][1]++;cov_27aellg5nb.s[38]++;return"https://github.com";}}cov_27aellg5nb.s[39]++;exports.htmlUrl=htmlUrl;cov_27aellg5nb.s[40]++;exports.DefaultGitHubApiUrl="https://api.github.com/";function apiUrl(repo){cov_27aellg5nb.f[3]++;cov_27aellg5nb.s[41]++;if((cov_27aellg5nb.b[10][0]++,repo.org)&&(cov_27aellg5nb.b[10][1]++,repo.org.provider)&&(cov_27aellg5nb.b[10][2]++,repo.org.provider.url)){cov_27aellg5nb.b[9][0]++;let providerUrl=(cov_27aellg5nb.s[42]++,repo.org.provider.apiUrl);cov_27aellg5nb.s[43]++;if(providerUrl.slice(-1)==="/"){cov_27aellg5nb.b[11][0]++;cov_27aellg5nb.s[44]++;providerUrl=providerUrl.slice(0,-1);}else{cov_27aellg5nb.b[11][1]++;}cov_27aellg5nb.s[45]++;return providerUrl;}else{cov_27aellg5nb.b[9][1]++;cov_27aellg5nb.s[46]++;return exports.DefaultGitHubApiUrl;}}cov_27aellg5nb.s[47]++;exports.apiUrl=apiUrl;function userUrl(repo,login){cov_27aellg5nb.f[4]++;cov_27aellg5nb.s[48]++;return`${htmlUrl(repo)}/${login}`;}cov_27aellg5nb.s[49]++;exports.userUrl=userUrl;function avatarUrl(repo,login){cov_27aellg5nb.f[5]++;cov_27aellg5nb.s[50]++;if((cov_27aellg5nb.b[13][0]++,repo.org!=null)&&(cov_27aellg5nb.b[13][1]++,repo.org.provider!=null)&&(cov_27aellg5nb.b[13][2]++,repo.org.provider.url!=null)){cov_27aellg5nb.b[12][0]++;cov_27aellg5nb.s[51]++;return`${htmlUrl(repo)}/avatars/${login}`;}else{cov_27aellg5nb.b[12][1]++;cov_27aellg5nb.s[52]++;return`https://avatars.githubusercontent.com/${login}`;}}cov_27aellg5nb.s[53]++;exports.avatarUrl=avatarUrl;function commitUrl(repo,commit){cov_27aellg5nb.f[6]++;cov_27aellg5nb.s[54]++;return`${htmlUrl(repo)}/${repoSlug(repo)}/commit/${commit.sha}`;}cov_27aellg5nb.s[55]++;exports.commitUrl=commitUrl;/**
 * If the URL is of an image, return a Slack message attachment that
 * will render that image.  Otherwise return null.
 *
 * @param url full URL
 * @return Slack message attachment for image or null
 */function urlToImageAttachment(url){cov_27aellg5nb.f[7]++;const imageRegExp=(cov_27aellg5nb.s[56]++,/[^\/]+\.(?:png|jpe?g|gif|bmp)$/i);const imageMatch=(cov_27aellg5nb.s[57]++,imageRegExp.exec(url));cov_27aellg5nb.s[58]++;if(imageMatch){cov_27aellg5nb.b[14][0]++;const image=(cov_27aellg5nb.s[59]++,imageMatch[0]);cov_27aellg5nb.s[60]++;return{text:image,image_url:url,fallback:image};}else{cov_27aellg5nb.b[14][1]++;cov_27aellg5nb.s[61]++;return null;}}/**
 * Find image URLs in a message body, returning an array of Slack
 * message attachments, one for each image.  It expects the message to
 * be in Slack message markup.
 *
 * @param body message body
 * @return array of Slack message Attachments with the `image_url` set
 *         to the URL of the image and the `text` and `fallback` set
 *         to the image name.
 */function extractImageUrls(body){cov_27aellg5nb.f[8]++;const slackLinkRegExp=(cov_27aellg5nb.s[62]++,/<(https?:\/\/.*?)(?:\|.*?)?>/g);// inspired by https://stackoverflow.com/a/6927878/5464956
const urlRegExp=(cov_27aellg5nb.s[63]++,/\bhttps?:\/\/[^\s<>\[\]]+[^\s`!()\[\]{};:'".,<>?Â«Â»ââââ]/gi);const attachments=(cov_27aellg5nb.s[64]++,[]);const bodyParts=(cov_27aellg5nb.s[65]++,body.split(slackLinkRegExp));cov_27aellg5nb.s[66]++;for(let i=0;i<bodyParts.length;i++){cov_27aellg5nb.s[67]++;if(i%2===0){cov_27aellg5nb.b[15][0]++;let match;// tslint:disable-next-line:no-conditional-assignment
cov_27aellg5nb.s[68]++;while(match=urlRegExp.exec(bodyParts[i])){const url=(cov_27aellg5nb.s[69]++,match[0]);const attachment=(cov_27aellg5nb.s[70]++,urlToImageAttachment(url));cov_27aellg5nb.s[71]++;if(attachment){cov_27aellg5nb.b[16][0]++;cov_27aellg5nb.s[72]++;attachments.push(attachment);}else{cov_27aellg5nb.b[16][1]++;}}}else{cov_27aellg5nb.b[15][1]++;const url=(cov_27aellg5nb.s[73]++,bodyParts[i]);const attachment=(cov_27aellg5nb.s[74]++,urlToImageAttachment(url));cov_27aellg5nb.s[75]++;if(attachment){cov_27aellg5nb.b[17][0]++;cov_27aellg5nb.s[76]++;attachments.push(attachment);}else{cov_27aellg5nb.b[17][1]++;}}}const uniqueAttachments=(cov_27aellg5nb.s[77]++,[]);cov_27aellg5nb.s[78]++;attachments.forEach(a=>{cov_27aellg5nb.f[9]++;cov_27aellg5nb.s[79]++;if(!uniqueAttachments.some(ua=>{cov_27aellg5nb.f[10]++;cov_27aellg5nb.s[80]++;return ua.image_url===a.image_url;})){cov_27aellg5nb.b[18][0]++;cov_27aellg5nb.s[81]++;uniqueAttachments.push(a);}else{cov_27aellg5nb.b[18][1]++;}});cov_27aellg5nb.s[82]++;return uniqueAttachments;}cov_27aellg5nb.s[83]++;exports.extractImageUrls=extractImageUrls;/**
 * Find issue mentions in body and replace them with links.
 *
 * @param body message to modify
 * @param repo repository information
 * @return string with issue mentions replaced with links
 */function linkIssues(body,repo){cov_27aellg5nb.f[11]++;cov_27aellg5nb.s[84]++;if((cov_27aellg5nb.b[20][0]++,!body)||(cov_27aellg5nb.b[20][1]++,body.length===0)){cov_27aellg5nb.b[19][0]++;cov_27aellg5nb.s[85]++;return body;}else{cov_27aellg5nb.b[19][1]++;}const splitter=(cov_27aellg5nb.s[86]++,/(\[.+?\](?:\[.*?\]|\(.+?\)|:\s*http.*)|^```.*\n[\S\s]*?^```\s*\n|<.+?>)/m);const bodyParts=(cov_27aellg5nb.s[87]++,body.split(splitter));const baseUrl=(cov_27aellg5nb.s[88]++,htmlUrl(repo));cov_27aellg5nb.s[89]++;for(let j=0;j<bodyParts.length;j+=2){let newPart=(cov_27aellg5nb.s[90]++,bodyParts[j]);const allIssueMentions=(cov_27aellg5nb.s[91]++,getIssueMentions(newPart));cov_27aellg5nb.s[92]++;allIssueMentions.forEach(i=>{cov_27aellg5nb.f[12]++;const iMatchPrefix=(cov_27aellg5nb.s[93]++,i.indexOf("#")===0?(cov_27aellg5nb.b[21][0]++,`^|\\W`):(cov_27aellg5nb.b[21][1]++,repoIssueMatchPrefix));const iRegExp=(cov_27aellg5nb.s[94]++,new RegExp(`(${iMatchPrefix})${i}(?!\\w)`,"g"));const iSlug=(cov_27aellg5nb.s[95]++,i.indexOf("#")===0?(cov_27aellg5nb.b[22][0]++,`${repo.owner}/${repo.name}${i}`):(cov_27aellg5nb.b[22][1]++,i));const iUrlPath=(cov_27aellg5nb.s[96]++,iSlug.replace("#","/issues/"));const iLink=(cov_27aellg5nb.s[97]++,slack.url(`${baseUrl}/${iUrlPath}`,i));cov_27aellg5nb.s[98]++;newPart=newPart.replace(iRegExp,`\$1${iLink}`);});cov_27aellg5nb.s[99]++;bodyParts[j]=newPart;}cov_27aellg5nb.s[100]++;return bodyParts.join("");}cov_27aellg5nb.s[101]++;exports.linkIssues=linkIssues;const gitHubUserMatch=(cov_27aellg5nb.s[102]++,"[a-zA-Z\\d]+(?:-[a-zA-Z\\d]+)*");/**
 * Regular expression to find issue mentions.  There are capture
 * groups for the issue repository owner, repository name, and issue
 * number.  The capture groups for repository owner and name are
 * optional and therefore may be null, although if one is set, the
 * other should be as well.
 *
 * The rules for preceding characters is different for current repo
 * matches, e.g., "#43", and other repo matches, e.g., "some/repo#44".
 * Current repo matches allow anything but word characters to precede
 * them.  Other repo matches only allow a few other characters to
 * preceed them.
 */const repoIssueMatchPrefix=(cov_27aellg5nb.s[103]++,"^|[[\\s:({]");// tslint:disable-next-line:max-line-length
const issueMentionMatch=(cov_27aellg5nb.s[104]++,`(?:^|(?:${repoIssueMatchPrefix})(${gitHubUserMatch})\/(${gitHubUserMatch})|\\W)#([1-9]\\d*)(?!\\w)`);const issueMentionRegExp=(cov_27aellg5nb.s[105]++,new RegExp(issueMentionMatch,"g"));/**
 * Find all issue mentions and return an array of unique issue
 * mentions as "#3" and "owner/repo#5".
 *
 * @param msg string that may contain mentions
 * @return unique list of issue mentions as #N or O/R#N
 */function getIssueMentions(msg=(cov_27aellg5nb.b[23][0]++,"")){cov_27aellg5nb.f[13]++;const allMentions=(cov_27aellg5nb.s[106]++,[]);let matches;// tslint:disable-next-line:no-conditional-assignment
cov_27aellg5nb.s[107]++;while(matches=issueMentionRegExp.exec(msg)){const owner=(cov_27aellg5nb.s[108]++,matches[1]);const repo=(cov_27aellg5nb.s[109]++,matches[2]);const issue=(cov_27aellg5nb.s[110]++,matches[3]);const slug=(cov_27aellg5nb.s[111]++,(cov_27aellg5nb.b[25][0]++,owner)&&(cov_27aellg5nb.b[25][1]++,repo)?(cov_27aellg5nb.b[24][0]++,`${owner}/${repo}`):(cov_27aellg5nb.b[24][1]++,""));cov_27aellg5nb.s[112]++;allMentions.push(`${slug}#${issue}`);}cov_27aellg5nb.s[113]++;return _.uniq(allMentions);}cov_27aellg5nb.s[114]++;exports.getIssueMentions=getIssueMentions;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL1VzZXJzL3JvZGpvaG5zb24vc2ZvcnphbmRvLWRldi9pZGVhLXByb2plY3RzL215LWZsb3cvc3JjL3V0aWwvbGlmZWN5Y2xlSGVscGVycy50cyIsInNvdXJjZXMiOlsiL1VzZXJzL3JvZGpvaG5zb24vc2ZvcnphbmRvLWRldi9pZGVhLXByb2plY3RzL215LWZsb3cvc3JjL3V0aWwvbGlmZWN5Y2xlSGVscGVycy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7Ozs7Ozs7Ozs7Ozs7O0dBY0c7O0FBRUgsK0RBQStEO0FBQy9ELDRCQUE0QjtBQUU1QixxREFBcUQ7QUFFckQ7Ozs7R0FJRztBQUNILCtCQUFzQyxPQUFlLEVBQUUsSUFBUztJQUM1RCxNQUFNLEtBQUssR0FBRyxPQUFPLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ3JDLE1BQU0sWUFBWSxHQUFHLEtBQUssQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDekMsTUFBTSxXQUFXLEdBQUcsVUFBVSxDQUFDLFlBQVksRUFBRSxJQUFJLENBQUMsQ0FBQztJQUVuRCxJQUFJLFdBQVcsQ0FBQyxNQUFNLElBQUksRUFBRSxFQUFFO1FBQzFCLE9BQU8sV0FBVyxDQUFDO0tBQ3RCO0lBRUQsTUFBTSxXQUFXLEdBQUcsNEJBQTRCLENBQUM7SUFDakQsTUFBTSxVQUFVLEdBQUcsV0FBVyxDQUFDLEtBQUssQ0FBQyxXQUFXLENBQUMsQ0FBQztJQUNsRCxJQUFJLGNBQWMsR0FBRyxFQUFFLENBQUM7SUFDeEIsSUFBSSxPQUFPLEdBQUcsQ0FBQyxDQUFDO0lBQ2hCLElBQUksQ0FBQyxDQUFDO0lBQ04sS0FBSyxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxVQUFVLENBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxFQUFFO1FBQ3BDLElBQUksUUFBUSxHQUFHLGNBQWMsQ0FBQztRQUM5QixJQUFJLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxFQUFFO1lB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QyxHQUFHLElBQUksSUFBSSxLQUFLLEVBQUUsQ0FBQyxDQUFDO0tBQ3hDO0lBRUQsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDO0FBQy9CLENBQUM7QUFiRCw0Q0FhQyIsInNvdXJjZXNDb250ZW50IjpbIi8qXG4gKiBDb3B5cmlnaHQgwqkgMjAxOCBBdG9taXN0LCBJbmMuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCAqIGFzIHNsYWNrIGZyb20gXCJAYXRvbWlzdC9zbGFjay1tZXNzYWdlcy9TbGFja01lc3NhZ2VzXCI7XG5pbXBvcnQgKiBhcyBfIGZyb20gXCJsb2Rhc2hcIjtcblxuLy8gVGhpcyBmaWxlIGNvcGllZCBmcm9tIGF0b21pc3QvbGlmZWN5Y2xlLWF1dG9tYXRpb25cblxuLyoqXG4gKiBTYWZlbHkgdHJ1bmNhdGUgdGhlIGZpcnN0IGxpbmUgb2YgYSBjb21taXQgbWVzc2FnZSB0byA1MCBjaGFyYWN0ZXJzXG4gKiBvciBsZXNzLiAgT25seSBjb3VudCBwcmludGFibGUgY2hhcmFjdGVycywgaS5lLiwgbm90IGxpbmsgVVJMcyBvclxuICogbWFya3VwLlxuICovXG5leHBvcnQgZnVuY3Rpb24gdHJ1bmNhdGVDb21taXRNZXNzYWdlKG1lc3NhZ2U6IHN0cmluZywgcmVwbzogYW55KTogc3RyaW5nIHtcbiAgICBjb25zdCB0aXRsZSA9IG1lc3NhZ2Uuc3BsaXQoXCJcXG5cIilbMF07XG4gICAgY29uc3QgZXNjYXBlZFRpdGxlID0gc2xhY2suZXNjYXBlKHRpdGxlKTtcbiAgICBjb25zdCBsaW5rZWRUaXRsZSA9IGxpbmtJc3N1ZXMoZXNjYXBlZFRpdGxlLCByZXBvKTtcblxuICAgIGlmIChsaW5rZWRUaXRsZS5sZW5ndGggPD0gNTApIHtcbiAgICAgICAgcmV0dXJuIGxpbmtlZFRpdGxlO1xuICAgIH1cblxuICAgIGNvbnN0IHNwbGl0UmVnRXhwID0gLygmKD86W2dsXXR8YW1wKTt8PC4qP1xcfHw+KS87XG4gICAgY29uc3QgdGl0bGVQYXJ0cyA9IGxpbmtlZFRpdGxlLnNwbGl0KHNwbGl0UmVnRXhwKTtcbiAgICBsZXQgdHJ1bmNhdGVkVGl0bGUgPSBcIlwiO1xuICAgIGxldCBhZGROZXh0ID0gMTtcbiAgICBsZXQgaTtcbiAgICBmb3IgKGkgPSAwOyBpIDwgdGl0bGVQYXJ0cy5sZW5ndGg7IGkrKykge1xuICAgICAgICBsZXQgbmV3VGl0bGUgPSB0cnVuY2F0ZWRUaXRsZTtcbiAgICAgICAgaWYgKGkgJSAyID09PSAwKSB7XG4gICAgICAgICAgICBuZXdUaXRsZSArPSB0aXRsZVBhcnRzW2ldO1xuICAgICAgICB9IGVsc2UgaWYgKC9eJig/OltnbF10fGFtcCk7JC8udGVzdCh0aXRsZVBhcnRzW2ldKSkge1xuICAgICAgICAgICAgbmV3VGl0bGUgKz0gXCImXCI7XG4gICAgICAgIH0gZWxzZSBpZiAoL148LipcXHwkLy50ZXN0KHRpdGxlUGFydHNbaV0pKSB7XG4gICAgICAgICAgICBhZGROZXh0ID0gMjtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9IGVsc2UgaWYgKHRpdGxlUGFydHNbaV0gPT09IFwiPlwiKSB7XG4gICAgICAgICAgICBhZGROZXh0ID0gMTtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChuZXdUaXRsZS5sZW5ndGggPiA1MCkge1xuICAgICAgICAgICAgY29uc3QgbCA9IDUwIC0gbmV3VGl0bGUubGVuZ3RoO1xuICAgICAgICAgICAgdGl0bGVQYXJ0c1tpXSA9IHRpdGxlUGFydHNbaV0uc2xpY2UoMCwgbCkgKyBcIi4uLlwiO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgdHJ1bmNhdGVkVGl0bGUgPSBuZXdUaXRsZTtcbiAgICB9XG4gICAgcmV0dXJuIHRpdGxlUGFydHMuc2xpY2UoMCwgaSArIGFkZE5leHQpLmpvaW4oXCJcIik7XG59XG5cbi8qKlxuICogR2VuZXJhdGUgR2l0SHViIHJlcG9zaXRvcnkgXCJzbHVnXCIsIGkuZS4sIG93bmVyL3JlcG8uXG4gKlxuICogQHBhcmFtIHJlcG8gcmVwb3NpdG9yeSB3aXRoIC5vd25lciBhbmQgLm5hbWVcbiAqIEByZXR1cm4gb3duZXIvbmFtZSBzdHJpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlcG9TbHVnKHJlcG86IFJlcG9JbmZvKTogc3RyaW5nIHtcbiAgICByZXR1cm4gYCR7cmVwby5vd25lcn0vJHtyZXBvLm5hbWV9YDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGh0bWxVcmwocmVwbzogUmVwb0luZm8pOiBzdHJpbmcge1xuICAgIGlmIChyZXBvLm9yZyAmJiByZXBvLm9yZy5wcm92aWRlciAmJiByZXBvLm9yZy5wcm92aWRlci51cmwpIHtcbiAgICAgICAgbGV0IHByb3ZpZGVyVXJsID0gcmVwby5vcmcucHJvdmlkZXIudXJsO1xuICAgICAgICBpZiAocHJvdmlkZXJVcmwuc2xpY2UoLTEpID09PSBcIi9cIikge1xuICAgICAgICAgICAgcHJvdmlkZXJVcmwgPSBwcm92aWRlclVybC5zbGljZSgwLCAtMSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHByb3ZpZGVyVXJsO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBcImh0dHBzOi8vZ2l0aHViLmNvbVwiO1xuICAgIH1cbn1cblxuZXhwb3J0IGNvbnN0IERlZmF1bHRHaXRIdWJBcGlVcmwgPSBcImh0dHBzOi8vYXBpLmdpdGh1Yi5jb20vXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiBhcGlVcmwocmVwbzogYW55KTogc3RyaW5nIHtcbiAgICBpZiAocmVwby5vcmcgJiYgcmVwby5vcmcucHJvdmlkZXIgJiYgcmVwby5vcmcucHJvdmlkZXIudXJsKSB7XG4gICAgICAgIGxldCBwcm92aWRlclVybCA9IHJlcG8ub3JnLnByb3ZpZGVyLmFwaVVybDtcbiAgICAgICAgaWYgKHByb3ZpZGVyVXJsLnNsaWNlKC0xKSA9PT0gXCIvXCIpIHtcbiAgICAgICAgICAgIHByb3ZpZGVyVXJsID0gcHJvdmlkZXJVcmwuc2xpY2UoMCwgLTEpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwcm92aWRlclVybDtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gRGVmYXVsdEdpdEh1YkFwaVVybDtcbiAgICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1c2VyVXJsKHJlcG86IGFueSwgbG9naW46IHN0cmluZyk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGAke2h0bWxVcmwocmVwbyl9LyR7bG9naW59YDtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBSZXBvSW5mbyB7XG4gICAgb3duZXI6IHN0cmluZztcbiAgICBuYW1lOiBzdHJpbmc7XG4gICAgb3JnPzoge1xuICAgICAgICBwcm92aWRlcjogeyB1cmw/OiBzdHJpbmcgfSxcbiAgICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gYXZhdGFyVXJsKHJlcG86IGFueSwgbG9naW46IHN0cmluZyk6IHN0cmluZyB7XG4gICAgaWYgKHJlcG8ub3JnICE9IG51bGwgJiYgcmVwby5vcmcucHJvdmlkZXIgIT0gbnVsbCAmJiByZXBvLm9yZy5wcm92aWRlci51cmwgIT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gYCR7aHRtbFVybChyZXBvKX0vYXZhdGFycy8ke2xvZ2lufWA7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGBodHRwczovL2F2YXRhcnMuZ2l0aHVidXNlcmNvbnRlbnQuY29tLyR7bG9naW59YDtcbiAgICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjb21taXRVcmwocmVwbzogUmVwb0luZm8sIGNvbW1pdDogYW55KTogc3RyaW5nIHtcbiAgICByZXR1cm4gYCR7aHRtbFVybChyZXBvKX0vJHtyZXBvU2x1ZyhyZXBvKX0vY29tbWl0LyR7Y29tbWl0LnNoYX1gO1xufVxuXG4vKipcbiAqIElmIHRoZSBVUkwgaXMgb2YgYW4gaW1hZ2UsIHJldHVybiBhIFNsYWNrIG1lc3NhZ2UgYXR0YWNobWVudCB0aGF0XG4gKiB3aWxsIHJlbmRlciB0aGF0IGltYWdlLiAgT3RoZXJ3aXNlIHJldHVybiBudWxsLlxuICpcbiAqIEBwYXJhbSB1cmwgZnVsbCBVUkxcbiAqIEByZXR1cm4gU2xhY2sgbWVzc2FnZSBhdHRhY2htZW50IGZvciBpbWFnZSBvciBudWxsXG4gKi9cbmZ1bmN0aW9uIHVybFRvSW1hZ2VBdHRhY2htZW50KHVybDogc3RyaW5nKTogc2xhY2suQXR0YWNobWVudCB7XG4gICAgY29uc3QgaW1hZ2VSZWdFeHAgPSAvW15cXC9dK1xcLig/OnBuZ3xqcGU/Z3xnaWZ8Ym1wKSQvaTtcbiAgICBjb25zdCBpbWFnZU1hdGNoID0gaW1hZ2VSZWdFeHAuZXhlYyh1cmwpO1xuICAgIGlmIChpbWFnZU1hdGNoKSB7XG4gICAgICAgIGNvbnN0IGltYWdlID0gaW1hZ2VNYXRjaFswXTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHRleHQ6IGltYWdlLFxuICAgICAgICAgICAgaW1hZ2VfdXJsOiB1cmwsXG4gICAgICAgICAgICBmYWxsYmFjazogaW1hZ2UsXG4gICAgICAgIH07XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxufVxuXG4vKipcbiAqIEZpbmQgaW1hZ2UgVVJMcyBpbiBhIG1lc3NhZ2UgYm9keSwgcmV0dXJuaW5nIGFuIGFycmF5IG9mIFNsYWNrXG4gKiBtZXNzYWdlIGF0dGFjaG1lbnRzLCBvbmUgZm9yIGVhY2ggaW1hZ2UuICBJdCBleHBlY3RzIHRoZSBtZXNzYWdlIHRvXG4gKiBiZSBpbiBTbGFjayBtZXNzYWdlIG1hcmt1cC5cbiAqXG4gKiBAcGFyYW0gYm9keSBtZXNzYWdlIGJvZHlcbiAqIEByZXR1cm4gYXJyYXkgb2YgU2xhY2sgbWVzc2FnZSBBdHRhY2htZW50cyB3aXRoIHRoZSBgaW1hZ2VfdXJsYCBzZXRcbiAqICAgICAgICAgdG8gdGhlIFVSTCBvZiB0aGUgaW1hZ2UgYW5kIHRoZSBgdGV4dGAgYW5kIGBmYWxsYmFja2Agc2V0XG4gKiAgICAgICAgIHRvIHRoZSBpbWFnZSBuYW1lLlxuICovXG5leHBvcnQgZnVuY3Rpb24gZXh0cmFjdEltYWdlVXJscyhib2R5OiBzdHJpbmcpOiBzbGFjay5BdHRhY2htZW50W10ge1xuICAgIGNvbnN0IHNsYWNrTGlua1JlZ0V4cCA9IC88KGh0dHBzPzpcXC9cXC8uKj8pKD86XFx8Lio/KT8+L2c7XG4gICAgLy8gaW5zcGlyZWQgYnkgaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9hLzY5Mjc4NzgvNTQ2NDk1NlxuICAgIGNvbnN0IHVybFJlZ0V4cCA9IC9cXGJodHRwcz86XFwvXFwvW15cXHM8PlxcW1xcXV0rW15cXHNgISgpXFxbXFxde307OidcIi4sPD4/wqvCu+KAnOKAneKAmOKAmV0vZ2k7XG4gICAgY29uc3QgYXR0YWNobWVudHM6IHNsYWNrLkF0dGFjaG1lbnRbXSA9IFtdO1xuICAgIGNvbnN0IGJvZHlQYXJ0cyA9IGJvZHkuc3BsaXQoc2xhY2tMaW5rUmVnRXhwKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJvZHlQYXJ0cy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAoaSAlIDIgPT09IDApIHtcbiAgICAgICAgICAgIGxldCBtYXRjaDogUmVnRXhwRXhlY0FycmF5O1xuICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWNvbmRpdGlvbmFsLWFzc2lnbm1lbnRcbiAgICAgICAgICAgIHdoaWxlIChtYXRjaCA9IHVybFJlZ0V4cC5leGVjKGJvZHlQYXJ0c1tpXSkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB1cmwgPSBtYXRjaFswXTtcbiAgICAgICAgICAgICAgICBjb25zdCBhdHRhY2htZW50ID0gdXJsVG9JbWFnZUF0dGFjaG1lbnQodXJsKTtcbiAgICAgICAgICAgICAgICBpZiAoYXR0YWNobWVudCkge1xuICAgICAgICAgICAgICAgICAgICBhdHRhY2htZW50cy5wdXNoKGF0dGFjaG1lbnQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IHVybCA9IGJvZHlQYXJ0c1tpXTtcbiAgICAgICAgICAgIGNvbnN0IGF0dGFjaG1lbnQgPSB1cmxUb0ltYWdlQXR0YWNobWVudCh1cmwpO1xuICAgICAgICAgICAgaWYgKGF0dGFjaG1lbnQpIHtcbiAgICAgICAgICAgICAgICBhdHRhY2htZW50cy5wdXNoKGF0dGFjaG1lbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGNvbnN0IHVuaXF1ZUF0dGFjaG1lbnRzOiBzbGFjay5BdHRhY2htZW50W10gPSBbXTtcbiAgICBhdHRhY2htZW50cy5mb3JFYWNoKGEgPT4ge1xuICAgICAgICBpZiAoIXVuaXF1ZUF0dGFjaG1lbnRzLnNvbWUodWEgPT4gdWEuaW1hZ2VfdXJsID09PSBhLmltYWdlX3VybCkpIHtcbiAgICAgICAgICAgIHVuaXF1ZUF0dGFjaG1lbnRzLnB1c2goYSk7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gdW5pcXVlQXR0YWNobWVudHM7XG59XG5cbi8qKlxuICogRmluZCBpc3N1ZSBtZW50aW9ucyBpbiBib2R5IGFuZCByZXBsYWNlIHRoZW0gd2l0aCBsaW5rcy5cbiAqXG4gKiBAcGFyYW0gYm9keSBtZXNzYWdlIHRvIG1vZGlmeVxuICogQHBhcmFtIHJlcG8gcmVwb3NpdG9yeSBpbmZvcm1hdGlvblxuICogQHJldHVybiBzdHJpbmcgd2l0aCBpc3N1ZSBtZW50aW9ucyByZXBsYWNlZCB3aXRoIGxpbmtzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBsaW5rSXNzdWVzKGJvZHk6IHN0cmluZywgcmVwbzogYW55KTogc3RyaW5nIHtcbiAgICBpZiAoIWJvZHkgfHwgYm9keS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgcmV0dXJuIGJvZHk7XG4gICAgfVxuXG4gICAgY29uc3Qgc3BsaXR0ZXIgPSAvKFxcWy4rP1xcXSg/OlxcWy4qP1xcXXxcXCguKz9cXCl8OlxccypodHRwLiopfF5gYGAuKlxcbltcXFNcXHNdKj9eYGBgXFxzKlxcbnw8Lis/PikvbTtcbiAgICBjb25zdCBib2R5UGFydHMgPSBib2R5LnNwbGl0KHNwbGl0dGVyKTtcbiAgICBjb25zdCBiYXNlVXJsID0gaHRtbFVybChyZXBvKTtcblxuICAgIGZvciAobGV0IGogPSAwOyBqIDwgYm9keVBhcnRzLmxlbmd0aDsgaiArPSAyKSB7XG4gICAgICAgIGxldCBuZXdQYXJ0ID0gYm9keVBhcnRzW2pdO1xuICAgICAgICBjb25zdCBhbGxJc3N1ZU1lbnRpb25zID0gZ2V0SXNzdWVNZW50aW9ucyhuZXdQYXJ0KTtcbiAgICAgICAgYWxsSXNzdWVNZW50aW9ucy5mb3JFYWNoKGkgPT4ge1xuICAgICAgICAgICAgY29uc3QgaU1hdGNoUHJlZml4ID0gKGkuaW5kZXhPZihcIiNcIikgPT09IDApID8gYF58XFxcXFdgIDogcmVwb0lzc3VlTWF0Y2hQcmVmaXg7XG4gICAgICAgICAgICBjb25zdCBpUmVnRXhwID0gbmV3IFJlZ0V4cChgKCR7aU1hdGNoUHJlZml4fSkke2l9KD8hXFxcXHcpYCwgXCJnXCIpO1xuICAgICAgICAgICAgY29uc3QgaVNsdWcgPSAoaS5pbmRleE9mKFwiI1wiKSA9PT0gMCkgPyBgJHtyZXBvLm93bmVyfS8ke3JlcG8ubmFtZX0ke2l9YCA6IGk7XG4gICAgICAgICAgICBjb25zdCBpVXJsUGF0aCA9IGlTbHVnLnJlcGxhY2UoXCIjXCIsIFwiL2lzc3Vlcy9cIik7XG4gICAgICAgICAgICBjb25zdCBpTGluayA9IHNsYWNrLnVybChgJHtiYXNlVXJsfS8ke2lVcmxQYXRofWAsIGkpO1xuICAgICAgICAgICAgbmV3UGFydCA9IG5ld1BhcnQucmVwbGFjZShpUmVnRXhwLCBgXFwkMSR7aUxpbmt9YCk7XG4gICAgICAgIH0pO1xuICAgICAgICBib2R5UGFydHNbal0gPSBuZXdQYXJ0O1xuICAgIH1cblxuICAgIHJldHVybiBib2R5UGFydHMuam9pbihcIlwiKTtcbn1cblxuY29uc3QgZ2l0SHViVXNlck1hdGNoID0gXCJbYS16QS1aXFxcXGRdKyg/Oi1bYS16QS1aXFxcXGRdKykqXCI7XG5cbi8qKlxuICogUmVndWxhciBleHByZXNzaW9uIHRvIGZpbmQgaXNzdWUgbWVudGlvbnMuICBUaGVyZSBhcmUgY2FwdHVyZVxuICogZ3JvdXBzIGZvciB0aGUgaXNzdWUgcmVwb3NpdG9yeSBvd25lciwgcmVwb3NpdG9yeSBuYW1lLCBhbmQgaXNzdWVcbiAqIG51bWJlci4gIFRoZSBjYXB0dXJlIGdyb3VwcyBmb3IgcmVwb3NpdG9yeSBvd25lciBhbmQgbmFtZSBhcmVcbiAqIG9wdGlvbmFsIGFuZCB0aGVyZWZvcmUgbWF5IGJlIG51bGwsIGFsdGhvdWdoIGlmIG9uZSBpcyBzZXQsIHRoZVxuICogb3RoZXIgc2hvdWxkIGJlIGFzIHdlbGwuXG4gKlxuICogVGhlIHJ1bGVzIGZvciBwcmVjZWRpbmcgY2hhcmFjdGVycyBpcyBkaWZmZXJlbnQgZm9yIGN1cnJlbnQgcmVwb1xuICogbWF0Y2hlcywgZS5nLiwgXCIjNDNcIiwgYW5kIG90aGVyIHJlcG8gbWF0Y2hlcywgZS5nLiwgXCJzb21lL3JlcG8jNDRcIi5cbiAqIEN1cnJlbnQgcmVwbyBtYXRjaGVzIGFsbG93IGFueXRoaW5nIGJ1dCB3b3JkIGNoYXJhY3RlcnMgdG8gcHJlY2VkZVxuICogdGhlbS4gIE90aGVyIHJlcG8gbWF0Y2hlcyBvbmx5IGFsbG93IGEgZmV3IG90aGVyIGNoYXJhY3RlcnMgdG9cbiAqIHByZWNlZWQgdGhlbS5cbiAqL1xuY29uc3QgcmVwb0lzc3VlTWF0Y2hQcmVmaXggPSBcIl58W1tcXFxcczooe11cIjtcbi8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTptYXgtbGluZS1sZW5ndGhcbmNvbnN0IGlzc3VlTWVudGlvbk1hdGNoID0gYCg/Ol58KD86JHtyZXBvSXNzdWVNYXRjaFByZWZpeH0pKCR7Z2l0SHViVXNlck1hdGNofSlcXC8oJHtnaXRIdWJVc2VyTWF0Y2h9KXxcXFxcVykjKFsxLTldXFxcXGQqKSg/IVxcXFx3KWA7XG5jb25zdCBpc3N1ZU1lbnRpb25SZWdFeHAgPSBuZXcgUmVnRXhwKGlzc3VlTWVudGlvbk1hdGNoLCBcImdcIik7XG5cbi8qKlxuICogRmluZCBhbGwgaXNzdWUgbWVudGlvbnMgYW5kIHJldHVybiBhbiBhcnJheSBvZiB1bmlxdWUgaXNzdWVcbiAqIG1lbnRpb25zIGFzIFwiIzNcIiBhbmQgXCJvd25lci9yZXBvIzVcIi5cbiAqXG4gKiBAcGFyYW0gbXNnIHN0cmluZyB0aGF0IG1heSBjb250YWluIG1lbnRpb25zXG4gKiBAcmV0dXJuIHVuaXF1ZSBsaXN0IG9mIGlzc3VlIG1lbnRpb25zIGFzICNOIG9yIE8vUiNOXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRJc3N1ZU1lbnRpb25zKG1zZzogc3RyaW5nID0gXCJcIik6IHN0cmluZ1tdIHtcbiAgICBjb25zdCBhbGxNZW50aW9uczogc3RyaW5nW10gPSBbXTtcbiAgICBsZXQgbWF0Y2hlczogc3RyaW5nW107XG4gICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWNvbmRpdGlvbmFsLWFzc2lnbm1lbnRcbiAgICB3aGlsZSAobWF0Y2hlcyA9IGlzc3VlTWVudGlvblJlZ0V4cC5leGVjKG1zZykpIHtcbiAgICAgICAgY29uc3Qgb3duZXIgPSBtYXRjaGVzWzFdO1xuICAgICAgICBjb25zdCByZXBvID0gbWF0Y2hlc1syXTtcbiAgICAgICAgY29uc3QgaXNzdWUgPSBtYXRjaGVzWzNdO1xuICAgICAgICBjb25zdCBzbHVnID0gKG93bmVyICYmIHJlcG8pID8gYCR7b3duZXJ9LyR7cmVwb31gIDogXCJcIjtcbiAgICAgICAgYWxsTWVudGlvbnMucHVzaChgJHtzbHVnfSMke2lzc3VlfWApO1xuICAgIH1cblxuICAgIHJldHVybiBfLnVuaXEoYWxsTWVudGlvbnMpO1xufVxuIl19