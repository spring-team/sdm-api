"use strict";/*
 * Copyright Â© 2018 Atomist, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var cov_2ls4bj3eny=function(){var path="/Users/rodjohnson/sforzando-dev/idea-projects/my-flow/src/common/delivery/code/review/checkstyle/checkstyleReviewer.ts",hash="a62813e4b6c745a33bb875cd81f63aff7f3e1bf6",Function=function(){}.constructor,global=new Function('return this')(),gcv="__coverage__",coverageData={path:"/Users/rodjohnson/sforzando-dev/idea-projects/my-flow/src/common/delivery/code/review/checkstyle/checkstyleReviewer.ts",statementMap:{"0":{start:{line:17,column:16},end:{line:24,column:1}},"1":{start:{line:18,column:4},end:{line:23,column:7}},"2":{start:{line:19,column:36},end:{line:19,column:97}},"3":{start:{line:19,column:42},end:{line:19,column:70}},"4":{start:{line:19,column:85},end:{line:19,column:95}},"5":{start:{line:20,column:35},end:{line:20,column:100}},"6":{start:{line:20,column:41},end:{line:20,column:73}},"7":{start:{line:20,column:88},end:{line:20,column:98}},"8":{start:{line:21,column:32},end:{line:21,column:149}},"9":{start:{line:21,column:97},end:{line:21,column:119}},"10":{start:{line:22,column:8},end:{line:22,column:78}},"11":{start:{line:25,column:0},end:{line:25,column:62}},"12":{start:{line:26,column:28},end:{line:26,column:65}},"13":{start:{line:27,column:24},end:{line:27,column:75}},"14":{start:{line:28,column:24},end:{line:28,column:48}},"15":{start:{line:29,column:23},end:{line:29,column:88}},"16":{start:{line:30,column:24},end:{line:30,column:51}},"17":{start:{line:31,column:36},end:{line:31,column:74}},"18":{start:{line:32,column:35},end:{line:32,column:72}},"19":{start:{line:40,column:0},end:{line:69,column:2}},"20":{start:{line:40,column:49},end:{line:69,column:1}},"21":{start:{line:42,column:25},end:{line:51,column:6}},"22":{start:{line:52,column:17},end:{line:52,column:19}},"23":{start:{line:53,column:17},end:{line:53,column:19}},"24":{start:{line:54,column:4},end:{line:54,column:70}},"25":{start:{line:54,column:43},end:{line:54,column:68}},"26":{start:{line:55,column:4},end:{line:55,column:70}},"27":{start:{line:55,column:43},end:{line:55,column:68}},"28":{start:{line:56,column:4},end:{line:68,column:7}},"29":{start:{line:57,column:8},end:{line:59,column:11}},"30":{start:{line:58,column:12},end:{line:58,column:24}},"31":{start:{line:60,column:8},end:{line:67,column:11}},"32":{start:{line:61,column:12},end:{line:61,column:130}},"33":{start:{line:62,column:12},end:{line:64,column:13}},"34":{start:{line:63,column:16},end:{line:63,column:119}},"35":{start:{line:65,column:12},end:{line:66,column:192}},"36":{start:{line:66,column:28},end:{line:66,column:109}},"37":{start:{line:66,column:118},end:{line:66,column:190}},"38":{start:{line:71,column:4},end:{line:76,column:6}},"39":{start:{line:74,column:25},end:{line:74,column:194}},"40":{start:{line:74,column:72},end:{line:74,column:191}},"41":{start:{line:78,column:0},end:{line:78,column:72}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:17,column:44},end:{line:17,column:45}},loc:{start:{line:17,column:89},end:{line:24,column:1}},line:17},"1":{name:"(anonymous_1)",decl:{start:{line:18,column:36},end:{line:18,column:37}},loc:{start:{line:18,column:63},end:{line:23,column:5}},line:18},"2":{name:"fulfilled",decl:{start:{line:19,column:17},end:{line:19,column:26}},loc:{start:{line:19,column:34},end:{line:19,column:99}},line:19},"3":{name:"rejected",decl:{start:{line:20,column:17},end:{line:20,column:25}},loc:{start:{line:20,column:33},end:{line:20,column:102}},line:20},"4":{name:"step",decl:{start:{line:21,column:17},end:{line:21,column:21}},loc:{start:{line:21,column:30},end:{line:21,column:151}},line:21},"5":{name:"(anonymous_5)",decl:{start:{line:21,column:76},end:{line:21,column:77}},loc:{start:{line:21,column:95},end:{line:21,column:121}},line:21},"6":{name:"(anonymous_6)",decl:{start:{line:40,column:29},end:{line:40,column:30}},loc:{start:{line:40,column:49},end:{line:69,column:1}},line:40},"7":{name:"(anonymous_7)",decl:{start:{line:40,column:49},end:{line:40,column:50}},loc:{start:{line:40,column:61},end:{line:69,column:1}},line:40},"8":{name:"(anonymous_8)",decl:{start:{line:54,column:35},end:{line:54,column:36}},loc:{start:{line:54,column:43},end:{line:54,column:68}},line:54},"9":{name:"(anonymous_9)",decl:{start:{line:55,column:35},end:{line:55,column:36}},loc:{start:{line:55,column:43},end:{line:55,column:68}},line:55},"10":{name:"(anonymous_10)",decl:{start:{line:56,column:23},end:{line:56,column:24}},loc:{start:{line:56,column:44},end:{line:68,column:5}},line:56},"11":{name:"(anonymous_11)",decl:{start:{line:57,column:33},end:{line:57,column:34}},loc:{start:{line:57,column:40},end:{line:59,column:9}},line:57},"12":{name:"(anonymous_12)",decl:{start:{line:60,column:32},end:{line:60,column:33}},loc:{start:{line:60,column:50},end:{line:67,column:9}},line:60},"13":{name:"(anonymous_13)",decl:{start:{line:66,column:22},end:{line:66,column:23}},loc:{start:{line:66,column:28},end:{line:66,column:109}},line:66},"14":{name:"(anonymous_14)",decl:{start:{line:66,column:111},end:{line:66,column:112}},loc:{start:{line:66,column:118},end:{line:66,column:190}},line:66},"15":{name:"checkstyleReviewerRegistration",decl:{start:{line:70,column:9},end:{line:70,column:39}},loc:{start:{line:70,column:66},end:{line:77,column:1}},line:70},"16":{name:"(anonymous_16)",decl:{start:{line:74,column:16},end:{line:74,column:17}},loc:{start:{line:74,column:25},end:{line:74,column:194}},line:74},"17":{name:"(anonymous_17)",decl:{start:{line:74,column:57},end:{line:74,column:58}},loc:{start:{line:74,column:70},end:{line:74,column:193}},line:74}},branchMap:{"0":{loc:{start:{line:17,column:16},end:{line:24,column:1}},type:"binary-expr",locations:[{start:{line:17,column:17},end:{line:17,column:21}},{start:{line:17,column:25},end:{line:17,column:39}},{start:{line:17,column:44},end:{line:24,column:1}}],line:17},"1":{loc:{start:{line:18,column:16},end:{line:18,column:34}},type:"binary-expr",locations:[{start:{line:18,column:16},end:{line:18,column:17}},{start:{line:18,column:22},end:{line:18,column:33}}],line:18},"2":{loc:{start:{line:21,column:32},end:{line:21,column:148}},type:"cond-expr",locations:[{start:{line:21,column:46},end:{line:21,column:67}},{start:{line:21,column:70},end:{line:21,column:148}}],line:21},"3":{loc:{start:{line:22,column:51},end:{line:22,column:67}},type:"binary-expr",locations:[{start:{line:22,column:51},end:{line:22,column:61}},{start:{line:22,column:65},end:{line:22,column:67}}],line:22},"4":{loc:{start:{line:62,column:12},end:{line:64,column:13}},type:"if",locations:[{start:{line:62,column:12},end:{line:64,column:13}},{start:{line:62,column:12},end:{line:64,column:13}}],line:62},"5":{loc:{start:{line:62,column:16},end:{line:62,column:43}},type:"binary-expr",locations:[{start:{line:62,column:16},end:{line:62,column:26}},{start:{line:62,column:30},end:{line:62,column:43}}],line:62}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0},b:{"0":[0,0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0]},_coverageSchema:"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c"},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();var __awaiter=(cov_2ls4bj3eny.s[0]++,(cov_2ls4bj3eny.b[0][0]++,this)&&(cov_2ls4bj3eny.b[0][1]++,this.__awaiter)||(cov_2ls4bj3eny.b[0][2]++,function(thisArg,_arguments,P,generator){cov_2ls4bj3eny.f[0]++;cov_2ls4bj3eny.s[1]++;return new((cov_2ls4bj3eny.b[1][0]++,P)||(cov_2ls4bj3eny.b[1][1]++,P=Promise))(function(resolve,reject){cov_2ls4bj3eny.f[1]++;function fulfilled(value){cov_2ls4bj3eny.f[2]++;cov_2ls4bj3eny.s[2]++;try{cov_2ls4bj3eny.s[3]++;step(generator.next(value));}catch(e){cov_2ls4bj3eny.s[4]++;reject(e);}}function rejected(value){cov_2ls4bj3eny.f[3]++;cov_2ls4bj3eny.s[5]++;try{cov_2ls4bj3eny.s[6]++;step(generator["throw"](value));}catch(e){cov_2ls4bj3eny.s[7]++;reject(e);}}function step(result){cov_2ls4bj3eny.f[4]++;cov_2ls4bj3eny.s[8]++;result.done?(cov_2ls4bj3eny.b[2][0]++,resolve(result.value)):(cov_2ls4bj3eny.b[2][1]++,new P(function(resolve){cov_2ls4bj3eny.f[5]++;cov_2ls4bj3eny.s[9]++;resolve(result.value);}).then(fulfilled,rejected));}cov_2ls4bj3eny.s[10]++;step((generator=generator.apply(thisArg,(cov_2ls4bj3eny.b[3][0]++,_arguments)||(cov_2ls4bj3eny.b[3][1]++,[]))).next());});}));cov_2ls4bj3eny.s[11]++;Object.defineProperty(exports,"__esModule",{value:true});const automation_client_1=(cov_2ls4bj3eny.s[12]++,require("@atomist/automation-client"));const configuration_1=(cov_2ls4bj3eny.s[13]++,require("@atomist/automation-client/configuration"));const child_process_1=(cov_2ls4bj3eny.s[14]++,require("child_process"));const jvmPushTests_1=(cov_2ls4bj3eny.s[15]++,require("../../../../listener/support/pushtest/jvm/jvmPushTests"));const ReviewerError_1=(cov_2ls4bj3eny.s[16]++,require("../ReviewerError"));const checkstyleReportExtractor_1=(cov_2ls4bj3eny.s[17]++,require("./checkstyleReportExtractor"));const checkStyleReportToReview_1=(cov_2ls4bj3eny.s[18]++,require("./checkStyleReportToReview"));/**
 * Spawn Checkstyle Java process against the project directory.
 * Parse Checkstyle XML out and transform it into our ProjectReview structure.
 * An example of a common pattern for integrating third party static
 * analysis or security tools.
 * @param {string} checkstylePath the path to the CheckStyle jar on the local machine. (see README.md)
 */cov_2ls4bj3eny.s[19]++;exports.checkstyleReviewer=checkstylePath=>{cov_2ls4bj3eny.f[6]++;cov_2ls4bj3eny.s[20]++;return(p,ctx)=>{cov_2ls4bj3eny.f[7]++;// TODO switch to watchSpawned
const childProcess=(cov_2ls4bj3eny.s[21]++,child_process_1.spawn("java",["-jar",checkstylePath,"-c","/sun_checks.xml","src/main/java","-f","xml"],{cwd:p.baseDir}));let stdout=(cov_2ls4bj3eny.s[22]++,"");let stderr=(cov_2ls4bj3eny.s[23]++,"");cov_2ls4bj3eny.s[24]++;childProcess.stdout.on("data",data=>{cov_2ls4bj3eny.f[8]++;cov_2ls4bj3eny.s[25]++;return stdout+=data.toString();});cov_2ls4bj3eny.s[26]++;childProcess.stderr.on("data",data=>{cov_2ls4bj3eny.f[9]++;cov_2ls4bj3eny.s[27]++;return stderr+=data.toString();});cov_2ls4bj3eny.s[28]++;return new Promise((resolve,reject)=>{cov_2ls4bj3eny.f[10]++;cov_2ls4bj3eny.s[29]++;childProcess.on("error",err=>{cov_2ls4bj3eny.f[11]++;cov_2ls4bj3eny.s[30]++;reject(err);});cov_2ls4bj3eny.s[31]++;childProcess.on("exit",(code,signal)=>{cov_2ls4bj3eny.f[12]++;cov_2ls4bj3eny.s[32]++;automation_client_1.logger.debug("Checkstyle ran on %j, code=%d, stdout=\n%s\nstderr=%s",p.id,code,stdout,stderr);cov_2ls4bj3eny.s[33]++;if((cov_2ls4bj3eny.b[5][0]++,code!==0)&&(cov_2ls4bj3eny.b[5][1]++,stdout==="")){cov_2ls4bj3eny.b[4][0]++;cov_2ls4bj3eny.s[34]++;reject(new ReviewerError_1.ReviewerError("CheckStyle",`Process returned ${code}: ${stderr}`,stderr));}else{cov_2ls4bj3eny.b[4][1]++;}cov_2ls4bj3eny.s[35]++;return checkstyleReportExtractor_1.extract(stdout).then(cr=>{cov_2ls4bj3eny.f[13]++;cov_2ls4bj3eny.s[36]++;return resolve(checkStyleReportToReview_1.checkstyleReportToReview(p.id,cr,p.baseDir));},err=>{cov_2ls4bj3eny.f[14]++;cov_2ls4bj3eny.s[37]++;return reject(new ReviewerError_1.ReviewerError("CheckStyle",err.msg,stderr));});});});};};function checkstyleReviewerRegistration(considerOnlyChangedFiles){cov_2ls4bj3eny.f[15]++;cov_2ls4bj3eny.s[38]++;return{pushTest:jvmPushTests_1.IsJava,name:"Checkstyle",action:cri=>{cov_2ls4bj3eny.f[16]++;cov_2ls4bj3eny.s[39]++;return __awaiter(this,void 0,void 0,function*(){cov_2ls4bj3eny.f[17]++;cov_2ls4bj3eny.s[40]++;return exports.checkstyleReviewer(configuration_1.configurationValue("sdm.checkstyle.path"))(cri.project,cri.context);});},options:{considerOnlyChangedFiles}};}cov_2ls4bj3eny.s[41]++;exports.checkstyleReviewerRegistration=checkstyleReviewerRegistration;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL1VzZXJzL3JvZGpvaG5zb24vc2ZvcnphbmRvLWRldi9pZGVhLXByb2plY3RzL215LWZsb3cvc3JjL2NvbW1vbi9kZWxpdmVyeS9jb2RlL3Jldmlldy9jaGVja3N0eWxlL2NoZWNrc3R5bGVSZXZpZXdlci50cyIsInNvdXJjZXMiOlsiL1VzZXJzL3JvZGpvaG5zb24vc2ZvcnphbmRvLWRldi9pZGVhLXByb2plY3RzL215LWZsb3cvc3JjL2NvbW1vbi9kZWxpdmVyeS9jb2RlL3Jldmlldy9jaGVja3N0eWxlL2NoZWNrc3R5bGVSZXZpZXdlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7Ozs7Ozs7Ozs7Ozs7O0dBY0c7Ozs7Ozs7Ozs7QUFFSCxrRUFHb0M7QUFDcEMsNEVBQThFO0FBSTlFLGlEQUFzQztBQUN0Qyx5RkFBZ0Y7QUFDaEYsb0RBQWlEO0FBRWpELDJFQUFzRDtBQUN0RCx5RUFBc0U7QUFFdEU7Ozs7OztHQU1HO0FBQ1UsUUFBQSxrQkFBa0IsR0FFM0IsQ0FBQyxjQUFzQixFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQWEsRUFBRSxHQUFtQixFQUFFLEVBQUU7SUFDL0QsOEJBQThCO0lBQzlCLE1BQU0sWUFBWSxHQUFHLHFCQUFLLENBQ3RCLE1BQU0sRUFDTixDQUFDLE1BQU07UUFDSCxjQUFjO1FBQ2QsSUFBSTtRQUNKLGlCQUFpQjtRQUNqQixlQUFlO1FBQ2YsSUFBSTtRQUNKLEtBQUs7S0FDUixFQUNEO1FBQ0ksR0FBRyxFQUFFLENBQUMsQ0FBQyxPQUFPO0tBQ2pCLENBQUMsQ0FBQztJQUNQLElBQUksTUFBTSxHQUFHLEVBQUUsQ0FBQztJQUNoQixJQUFJLE1BQU0sR0FBRyxFQUFFLENBQUM7SUFDaEIsWUFBWSxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUMsTUFBTSxFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsTUFBTSxJQUFJLElBQUksQ0FBQyxRQUFRLEVBQUUsQ0FBQyxDQUFDO0lBQ2xFLFlBQVksQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLE1BQU0sRUFBRSxJQUFJLENBQUMsRUFBRSxDQUFDLE1BQU0sSUFBSSxJQUFJLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBQztJQUVsRSxPQUFPLElBQUksT0FBTyxDQUFDLENBQUMsT0FBTyxFQUFFLE1BQU0sRUFBRSxFQUFFO1FBQ25DLFlBQVksQ0FBQyxFQUFFLENBQUMsT0FBTyxFQUFFLEdBQUcsQ0FBQyxFQUFFO1lBQzNCLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUNoQixDQUFDLENBQUMsQ0FBQztRQUNILFlBQVksQ0FBQyxFQUFFLENBQUMsTUFBTSxFQUFFLENBQUMsSUFBSSxFQUFFLE1BQU0sRUFBRSxFQUFFO1lBQ3JDLDBCQUFNLENBQUMsS0FBSyxDQUFDLHVEQUF1RCxFQUFFLENBQUMsQ0FBQyxFQUFFLEVBQUUsSUFBSSxFQUFFLE1BQU0sRUFBRSxNQUFNLENBQUMsQ0FBQztZQUNsRyxJQUFJLElBQUksS0FBSyxDQUFDLElBQUksTUFBTSxLQUFLLEVBQUUsRUFBRTtnQkFDN0IsTUFBTSxDQUFDLElBQUksNkJBQWEsQ0FBQyxZQUFZLEVBQUUsb0JBQW9CLElBQUksS0FBSyxNQUFNLEVBQUUsRUFBRSxNQUFNLENBQUMsQ0FBQyxDQUFDO2FBQzFGO1lBQ0QsT0FBTyxtQ0FBTyxDQUFDLE1BQU0sQ0FBQztpQkFDakIsSUFBSSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsT0FBTyxDQUFDLG1EQUF3QixDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUUsRUFBRSxFQUFFLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxFQUM5RCxHQUFHLENBQUMsRUFBRSxDQUFDLE1BQU0sQ0FBQyxJQUFJLDZCQUFhLENBQUMsWUFBWSxFQUFFLEdBQUcsQ0FBQyxHQUFHLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzdFLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQyxDQUFDLENBQUM7QUFDUCxDQUFDLENBQUM7QUFFTix3Q0FBK0Msd0JBQWlDO0lBQzVFLE9BQU87UUFDSCxRQUFRLEVBQUUscUJBQU07UUFDaEIsSUFBSSxFQUFFLFlBQVk7UUFDbEIsTUFBTSxFQUFFLENBQU0sR0FBRyxFQUFDLEVBQUUsZ0RBQUMsT0FBQSwwQkFBa0IsQ0FBQyxrQ0FBa0IsQ0FBUyxxQkFBcUIsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLE9BQU8sRUFBRSxHQUFHLENBQUMsT0FBTyxDQUFDLENBQUEsR0FBQTtRQUNwSCxPQUFPLEVBQUUsRUFBQyx3QkFBd0IsRUFBQztLQUN0QyxDQUFDO0FBQ04sQ0FBQztBQVBELHdFQU9DIiwic291cmNlc0NvbnRlbnQiOlsiLypcbiAqIENvcHlyaWdodCDCqSAyMDE4IEF0b21pc3QsIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtcbiAgICBIYW5kbGVyQ29udGV4dCxcbiAgICBsb2dnZXIsXG59IGZyb20gXCJAYXRvbWlzdC9hdXRvbWF0aW9uLWNsaWVudFwiO1xuaW1wb3J0IHsgY29uZmlndXJhdGlvblZhbHVlIH0gZnJvbSBcIkBhdG9taXN0L2F1dG9tYXRpb24tY2xpZW50L2NvbmZpZ3VyYXRpb25cIjtcbmltcG9ydCB7IFByb2plY3RSZXZpZXcgfSBmcm9tIFwiQGF0b21pc3QvYXV0b21hdGlvbi1jbGllbnQvb3BlcmF0aW9ucy9yZXZpZXcvUmV2aWV3UmVzdWx0XCI7XG5pbXBvcnQgeyBHaXRQcm9qZWN0IH0gZnJvbSBcIkBhdG9taXN0L2F1dG9tYXRpb24tY2xpZW50L3Byb2plY3QvZ2l0L0dpdFByb2plY3RcIjtcbmltcG9ydCB7IExvY2FsUHJvamVjdCB9IGZyb20gXCJAYXRvbWlzdC9hdXRvbWF0aW9uLWNsaWVudC9wcm9qZWN0L2xvY2FsL0xvY2FsUHJvamVjdFwiO1xuaW1wb3J0IHsgc3Bhd24gfSBmcm9tIFwiY2hpbGRfcHJvY2Vzc1wiO1xuaW1wb3J0IHsgSXNKYXZhIH0gZnJvbSBcIi4uLy4uLy4uLy4uL2xpc3RlbmVyL3N1cHBvcnQvcHVzaHRlc3QvanZtL2p2bVB1c2hUZXN0c1wiO1xuaW1wb3J0IHsgUmV2aWV3ZXJFcnJvciB9IGZyb20gXCIuLi9SZXZpZXdlckVycm9yXCI7XG5pbXBvcnQgeyBSZXZpZXdlclJlZ2lzdHJhdGlvbiB9IGZyb20gXCIuLi9SZXZpZXdlclJlZ2lzdHJhdGlvblwiO1xuaW1wb3J0IHsgZXh0cmFjdCB9IGZyb20gXCIuL2NoZWNrc3R5bGVSZXBvcnRFeHRyYWN0b3JcIjtcbmltcG9ydCB7IGNoZWNrc3R5bGVSZXBvcnRUb1JldmlldyB9IGZyb20gXCIuL2NoZWNrU3R5bGVSZXBvcnRUb1Jldmlld1wiO1xuXG4vKipcbiAqIFNwYXduIENoZWNrc3R5bGUgSmF2YSBwcm9jZXNzIGFnYWluc3QgdGhlIHByb2plY3QgZGlyZWN0b3J5LlxuICogUGFyc2UgQ2hlY2tzdHlsZSBYTUwgb3V0IGFuZCB0cmFuc2Zvcm0gaXQgaW50byBvdXIgUHJvamVjdFJldmlldyBzdHJ1Y3R1cmUuXG4gKiBBbiBleGFtcGxlIG9mIGEgY29tbW9uIHBhdHRlcm4gZm9yIGludGVncmF0aW5nIHRoaXJkIHBhcnR5IHN0YXRpY1xuICogYW5hbHlzaXMgb3Igc2VjdXJpdHkgdG9vbHMuXG4gKiBAcGFyYW0ge3N0cmluZ30gY2hlY2tzdHlsZVBhdGggdGhlIHBhdGggdG8gdGhlIENoZWNrU3R5bGUgamFyIG9uIHRoZSBsb2NhbCBtYWNoaW5lLiAoc2VlIFJFQURNRS5tZClcbiAqL1xuZXhwb3J0IGNvbnN0IGNoZWNrc3R5bGVSZXZpZXdlcjogKGNoZWNrc3R5bGVQYXRoOiBzdHJpbmcpID0+XG4gICAgKHA6IExvY2FsUHJvamVjdCwgY3R4OiBIYW5kbGVyQ29udGV4dCkgPT4gUHJvbWlzZTxQcm9qZWN0UmV2aWV3IHwgUHJvamVjdFJldmlldz4gPVxuICAgIChjaGVja3N0eWxlUGF0aDogc3RyaW5nKSA9PiAocDogR2l0UHJvamVjdCwgY3R4OiBIYW5kbGVyQ29udGV4dCkgPT4ge1xuICAgICAgICAvLyBUT0RPIHN3aXRjaCB0byB3YXRjaFNwYXduZWRcbiAgICAgICAgY29uc3QgY2hpbGRQcm9jZXNzID0gc3Bhd24oXG4gICAgICAgICAgICBcImphdmFcIixcbiAgICAgICAgICAgIFtcIi1qYXJcIixcbiAgICAgICAgICAgICAgICBjaGVja3N0eWxlUGF0aCxcbiAgICAgICAgICAgICAgICBcIi1jXCIsXG4gICAgICAgICAgICAgICAgXCIvc3VuX2NoZWNrcy54bWxcIixcbiAgICAgICAgICAgICAgICBcInNyYy9tYWluL2phdmFcIixcbiAgICAgICAgICAgICAgICBcIi1mXCIsXG4gICAgICAgICAgICAgICAgXCJ4bWxcIixcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY3dkOiBwLmJhc2VEaXIsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgbGV0IHN0ZG91dCA9IFwiXCI7XG4gICAgICAgIGxldCBzdGRlcnIgPSBcIlwiO1xuICAgICAgICBjaGlsZFByb2Nlc3Muc3Rkb3V0Lm9uKFwiZGF0YVwiLCBkYXRhID0+IHN0ZG91dCArPSBkYXRhLnRvU3RyaW5nKCkpO1xuICAgICAgICBjaGlsZFByb2Nlc3Muc3RkZXJyLm9uKFwiZGF0YVwiLCBkYXRhID0+IHN0ZGVyciArPSBkYXRhLnRvU3RyaW5nKCkpO1xuXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICBjaGlsZFByb2Nlc3Mub24oXCJlcnJvclwiLCBlcnIgPT4ge1xuICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBjaGlsZFByb2Nlc3Mub24oXCJleGl0XCIsIChjb2RlLCBzaWduYWwpID0+IHtcbiAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoXCJDaGVja3N0eWxlIHJhbiBvbiAlaiwgY29kZT0lZCwgc3Rkb3V0PVxcbiVzXFxuc3RkZXJyPSVzXCIsIHAuaWQsIGNvZGUsIHN0ZG91dCwgc3RkZXJyKTtcbiAgICAgICAgICAgICAgICBpZiAoY29kZSAhPT0gMCAmJiBzdGRvdXQgPT09IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KG5ldyBSZXZpZXdlckVycm9yKFwiQ2hlY2tTdHlsZVwiLCBgUHJvY2VzcyByZXR1cm5lZCAke2NvZGV9OiAke3N0ZGVycn1gLCBzdGRlcnIpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGV4dHJhY3Qoc3Rkb3V0KVxuICAgICAgICAgICAgICAgICAgICAudGhlbihjciA9PiByZXNvbHZlKGNoZWNrc3R5bGVSZXBvcnRUb1JldmlldyhwLmlkLCBjciwgcC5iYXNlRGlyKSksXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnIgPT4gcmVqZWN0KG5ldyBSZXZpZXdlckVycm9yKFwiQ2hlY2tTdHlsZVwiLCBlcnIubXNnLCBzdGRlcnIpKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuZXhwb3J0IGZ1bmN0aW9uIGNoZWNrc3R5bGVSZXZpZXdlclJlZ2lzdHJhdGlvbihjb25zaWRlck9ubHlDaGFuZ2VkRmlsZXM6IGJvb2xlYW4pOiBSZXZpZXdlclJlZ2lzdHJhdGlvbiB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcHVzaFRlc3Q6IElzSmF2YSxcbiAgICAgICAgbmFtZTogXCJDaGVja3N0eWxlXCIsXG4gICAgICAgIGFjdGlvbjogYXN5bmMgY3JpID0+IGNoZWNrc3R5bGVSZXZpZXdlcihjb25maWd1cmF0aW9uVmFsdWU8c3RyaW5nPihcInNkbS5jaGVja3N0eWxlLnBhdGhcIikpKGNyaS5wcm9qZWN0LCBjcmkuY29udGV4dCksXG4gICAgICAgIG9wdGlvbnM6IHtjb25zaWRlck9ubHlDaGFuZ2VkRmlsZXN9LFxuICAgIH07XG59XG4iXX0=