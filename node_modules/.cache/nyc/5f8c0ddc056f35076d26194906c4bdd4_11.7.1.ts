"use strict";/*
 * Copyright Â© 2018 Atomist, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var cov_7h93ey0ax=function(){var path="/Users/rodjohnson/sforzando-dev/idea-projects/my-flow/src/common/command/editor/dry-run/dryRunEditor.ts",hash="2d062760539db2833dc9ea230366a3975a46ce8d",Function=function(){}.constructor,global=new Function('return this')(),gcv="__coverage__",coverageData={path:"/Users/rodjohnson/sforzando-dev/idea-projects/my-flow/src/common/command/editor/dry-run/dryRunEditor.ts",statementMap:{"0":{start:{line:17,column:0},end:{line:17,column:62}},"1":{start:{line:18,column:28},end:{line:18,column:65}},"2":{start:{line:19,column:35},end:{line:19,column:115}},"3":{start:{line:20,column:26},end:{line:20,column:95}},"4":{start:{line:21,column:16},end:{line:21,column:44}},"5":{start:{line:22,column:34},end:{line:22,column:82}},"6":{start:{line:23,column:26},end:{line:23,column:58}},"7":{start:{line:24,column:24},end:{line:24,column:51}},"8":{start:{line:25,column:25},end:{line:25,column:53}},"9":{start:{line:26,column:30},end:{line:26,column:62}},"10":{start:{line:27,column:0},end:{line:27,column:42}},"11":{start:{line:41,column:4},end:{line:43,column:5}},"12":{start:{line:42,column:8},end:{line:42,column:64}},"13":{start:{line:44,column:25},end:{line:54,column:22}},"14":{start:{line:44,column:185},end:{line:44,column:293}},"15":{start:{line:45,column:12},end:{line:45,column:111}},"16":{start:{line:46,column:32},end:{line:46,column:93}},"17":{start:{line:47,column:27},end:{line:52,column:13}},"18":{start:{line:53,column:12},end:{line:53,column:254}},"19":{start:{line:55,column:4},end:{line:55,column:176}},"20":{start:{line:57,column:0},end:{line:57,column:36}},"21":{start:{line:59,column:4},end:{line:59,column:49}}},fnMap:{"0":{name:"dryRunEditor",decl:{start:{line:40,column:9},end:{line:40,column:21}},loc:{start:{line:40,column:96},end:{line:56,column:1}},line:40},"1":{name:"(anonymous_1)",decl:{start:{line:44,column:180},end:{line:44,column:181}},loc:{start:{line:44,column:185},end:{line:44,column:293}},line:44},"2":{name:"(anonymous_2)",decl:{start:{line:44,column:306},end:{line:44,column:307}},loc:{start:{line:44,column:318},end:{line:54,column:9}},line:44},"3":{name:"toAtomistCommitMessage",decl:{start:{line:58,column:9},end:{line:58,column:31}},loc:{start:{line:58,column:51},end:{line:60,column:1}},line:58}},branchMap:{"0":{loc:{start:{line:40,column:27},end:{line:40,column:74}},type:"default-arg",locations:[{start:{line:40,column:41},end:{line:40,column:74}}],line:40},"1":{loc:{start:{line:40,column:82},end:{line:40,column:94}},type:"default-arg",locations:[{start:{line:40,column:92},end:{line:40,column:94}}],line:40},"2":{loc:{start:{line:41,column:4},end:{line:43,column:5}},type:"if",locations:[{start:{line:41,column:4},end:{line:43,column:5}},{start:{line:41,column:4},end:{line:43,column:5}}],line:41},"3":{loc:{start:{line:44,column:54},end:{line:44,column:81}},type:"binary-expr",locations:[{start:{line:44,column:54},end:{line:44,column:73}},{start:{line:44,column:77},end:{line:44,column:81}}],line:44},"4":{loc:{start:{line:46,column:32},end:{line:46,column:93}},type:"binary-expr",locations:[{start:{line:46,column:32},end:{line:46,column:62}},{start:{line:46,column:66},end:{line:46,column:85}},{start:{line:46,column:89},end:{line:46,column:93}}],line:46},"5":{loc:{start:{line:53,column:65},end:{line:53,column:121}},type:"binary-expr",locations:[{start:{line:53,column:65},end:{line:53,column:89}},{start:{line:53,column:93},end:{line:53,column:121}}],line:53},"6":{loc:{start:{line:53,column:146},end:{line:53,column:202}},type:"binary-expr",locations:[{start:{line:53,column:146},end:{line:53,column:173}},{start:{line:53,column:177},end:{line:53,column:202}}],line:53}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0},f:{"0":0,"1":0,"2":0,"3":0},b:{"0":[0],"1":[0],"2":[0,0],"3":[0,0],"4":[0,0,0],"5":[0,0],"6":[0,0]},_coverageSchema:"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c"},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();cov_7h93ey0ax.s[0]++;Object.defineProperty(exports,"__esModule",{value:true});const automation_client_1=(cov_7h93ey0ax.s[1]++,require("@atomist/automation-client"));const allReposInTeamRepoFinder_1=(cov_7h93ey0ax.s[2]++,require("@atomist/automation-client/operations/common/allReposInTeamRepoFinder"));const editorToCommand_1=(cov_7h93ey0ax.s[3]++,require("@atomist/automation-client/operations/edit/editorToCommand"));const index_1=(cov_7h93ey0ax.s[4]++,require("../../../../index"));const projectLoaderRepoLoader_1=(cov_7h93ey0ax.s[5]++,require("../../../repo/projectLoaderRepoLoader"));const EmptyParameters_1=(cov_7h93ey0ax.s[6]++,require("../../EmptyParameters"));const editorCommand_1=(cov_7h93ey0ax.s[7]++,require("../editorCommand"));const editorWrappers_1=(cov_7h93ey0ax.s[8]++,require("../editorWrappers"));const NewBranchWithStatus_1=(cov_7h93ey0ax.s[9]++,require("./NewBranchWithStatus"));cov_7h93ey0ax.s[10]++;exports.DryRunContext="atomist-dry-run";/**
 * Wrap an editor in a command handler that sets a dry run status.
 * Typically used to wait for build success or failure, resulting in issue or PR.
 * Allows use of custom parameters as in editorCommand
 * Targeting (targets property) is handled automatically if the parameters
 * do not implement TargetsParams
 * @param edd function to make a fresh editor instance from the params
 * @param name editor name
 * @param paramsMaker parameters factory, typically the name of a class with a no arg constructor
 * @param details optional details to customize behavior
 * Add intent "try edit <name>"
 */function dryRunEditor(edd,paramsMaker=(cov_7h93ey0ax.b[0][0]++,EmptyParameters_1.EmptyParameters),name,details=(cov_7h93ey0ax.b[1][0]++,{})){cov_7h93ey0ax.f[0]++;cov_7h93ey0ax.s[11]++;if(!!details.editMode){cov_7h93ey0ax.b[2][0]++;cov_7h93ey0ax.s[12]++;throw new Error("Cannot set editMode for dryRunEditor");}else{cov_7h93ey0ax.b[2][1]++;}const detailsToUse=(cov_7h93ey0ax.s[13]++,Object.assign({description:(cov_7h93ey0ax.b[3][0]++,details.description)||(cov_7h93ey0ax.b[3][1]++,name),intent:`try edit ${name}`,repoFinder:allReposInTeamRepoFinder_1.allReposInTeam(),repoLoader:p=>{cov_7h93ey0ax.f[1]++;cov_7h93ey0ax.s[14]++;return projectLoaderRepoLoader_1.projectLoaderRepoLoader(new index_1.CachingProjectLoader(),p.targets.credentials);},editMode:params=>{cov_7h93ey0ax.f[2]++;cov_7h93ey0ax.s[15]++;automation_client_1.logger.info("About to create edit mode for dry run editor: params=%j",params);const description=(cov_7h93ey0ax.s[16]++,(cov_7h93ey0ax.b[4][0]++,params.desiredPullRequestTitle)||(cov_7h93ey0ax.b[4][1]++,details.description)||(cov_7h93ey0ax.b[4][2]++,name));const status=(cov_7h93ey0ax.s[17]++,{context:exports.DryRunContext,target_url:"https://www.atomist.com",description,state:"pending"});cov_7h93ey0ax.s[18]++;return new NewBranchWithStatus_1.NewBranchWithStatus((cov_7h93ey0ax.b[5][0]++,params.desiredBranchName)||(cov_7h93ey0ax.b[5][1]++,`edit-${name}-${Date.now()}`),toAtomistCommitMessage((cov_7h93ey0ax.b[6][0]++,params.desiredCommitMessage)||(cov_7h93ey0ax.b[6][1]++,description.substr(0,50)),description),params.targets.credentials,status);}},details));cov_7h93ey0ax.s[19]++;return editorToCommand_1.editorHandler(editorWrappers_1.chattyEditorFactory(name,edd),editorCommand_1.toEditorOrReviewerParametersMaker(paramsMaker),name,detailsToUse);}cov_7h93ey0ax.s[20]++;exports.dryRunEditor=dryRunEditor;function toAtomistCommitMessage(base,description){cov_7h93ey0ax.f[3]++;cov_7h93ey0ax.s[21]++;return`${base}\n\n[atomist] ${description}`;}//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL1VzZXJzL3JvZGpvaG5zb24vc2ZvcnphbmRvLWRldi9pZGVhLXByb2plY3RzL215LWZsb3cvc3JjL2NvbW1vbi9jb21tYW5kL2VkaXRvci9kcnktcnVuL2RyeVJ1bkVkaXRvci50cyIsInNvdXJjZXMiOlsiL1VzZXJzL3JvZGpvaG5zb24vc2ZvcnphbmRvLWRldi9pZGVhLXByb2plY3RzL215LWZsb3cvc3JjL2NvbW1vbi9jb21tYW5kL2VkaXRvci9kcnktcnVuL2RyeVJ1bkVkaXRvci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7Ozs7Ozs7Ozs7Ozs7O0dBY0c7O0FBRUgsa0VBQW1FO0FBQ25FLG9IQUF1RztBQUd2RyxnR0FBaUg7QUFHakgsNkNBQXlEO0FBRXpELG1GQUFnRjtBQUNoRiwyREFBd0Q7QUFFeEQsb0RBQXFFO0FBQ3JFLHNEQUF3RDtBQUN4RCwrREFBNEQ7QUFFL0MsUUFBQSxhQUFhLEdBQUcsaUJBQWlCLENBQUM7QUFFL0M7Ozs7Ozs7Ozs7O0dBV0c7QUFDSCxzQkFBdUQsR0FBeUMsRUFDekMsY0FBNkIsaUNBQWdDLEVBQzdELElBQVksRUFDWixVQUFpRCxFQUFFO0lBQ3RHLElBQUksQ0FBQyxDQUFDLE9BQU8sQ0FBQyxRQUFRLEVBQUU7UUFDcEIsTUFBTSxJQUFJLEtBQUssQ0FBQyxzQ0FBc0MsQ0FBQyxDQUFDO0tBQzNEO0lBQ0QsTUFBTSxZQUFZLG1CQUNkLFdBQVcsRUFBRSxPQUFPLENBQUMsV0FBVyxJQUFJLElBQUksRUFDeEMsTUFBTSxFQUFFLFlBQVksSUFBSSxFQUFFLEVBQzFCLFVBQVUsRUFBRSx5Q0FBYyxFQUFFLEVBQzVCLFVBQVUsRUFDTixDQUFDLENBQUMsRUFBRSxDQUFDLGlEQUF1QixDQUFDLElBQUksNEJBQW9CLEVBQUUsRUFBRSxDQUFDLENBQUMsT0FBTyxDQUFDLFdBQVcsQ0FBQyxFQUNuRixRQUFRLEVBQUUsQ0FBQyxDQUFDLE1BQTJDLEVBQUUsRUFBRTtZQUN2RCwwQkFBTSxDQUFDLElBQUksQ0FBQyx5REFBeUQsRUFBRSxNQUFNLENBQUMsQ0FBQztZQUMvRSxNQUFNLFdBQVcsR0FBSSxNQUFvQyxDQUFDLHVCQUF1QixJQUFJLE9BQU8sQ0FBQyxXQUFXLElBQUksSUFBSSxDQUFDO1lBQ2pILE1BQU0sTUFBTSxHQUFXO2dCQUNuQixPQUFPLEVBQUUscUJBQWE7Z0JBQ3RCLFVBQVUsRUFBRSx5QkFBeUI7Z0JBQ3JDLFdBQVc7Z0JBQ1gsS0FBSyxFQUFFLFNBQVM7YUFDbkIsQ0FBQztZQUNGLE9BQU8sSUFBSSx5Q0FBbUIsQ0FDekIsTUFBb0MsQ0FBQyxpQkFBaUIsSUFBSSxRQUFRLElBQUksSUFBSSxJQUFJLENBQUMsR0FBRyxFQUFFLEVBQUUsRUFDdkYsc0JBQXNCLENBQUUsTUFBb0MsQ0FBQyxvQkFBb0IsSUFBSSxXQUFXLENBQUMsTUFBTSxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsRUFBRSxXQUFXLENBQUMsRUFDNUgsTUFBTSxDQUFDLE9BQU8sQ0FBQyxXQUFXLEVBQzFCLE1BQU0sQ0FBQyxDQUFDO1FBQ2hCLENBQUMsQ0FBQyxJQUNDLE9BQU8sQ0FDYixDQUFDO0lBQ0YsT0FBTywrQkFBYSxDQUNoQixvQ0FBbUIsQ0FBQyxJQUFJLEVBQUUsR0FBRyxDQUFRLEVBQ3JDLGlEQUFpQyxDQUFDLFdBQVcsQ0FBQyxFQUM5QyxJQUFJLEVBQ0osWUFBWSxDQUFDLENBQUM7QUFDdEIsQ0FBQztBQW5DRCxvQ0FtQ0M7QUFFRCxnQ0FBZ0MsSUFBWSxFQUFFLFdBQW1CO0lBQzdELE9BQU8sR0FBRyxJQUFJLGlCQUFpQixXQUFXLEVBQUUsQ0FBQztBQUNqRCxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLypcbiAqIENvcHlyaWdodCDCqSAyMDE4IEF0b21pc3QsIEluYy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHsgSGFuZGxlQ29tbWFuZCwgbG9nZ2VyIH0gZnJvbSBcIkBhdG9taXN0L2F1dG9tYXRpb24tY2xpZW50XCI7XG5pbXBvcnQgeyBhbGxSZXBvc0luVGVhbSB9IGZyb20gXCJAYXRvbWlzdC9hdXRvbWF0aW9uLWNsaWVudC9vcGVyYXRpb25zL2NvbW1vbi9hbGxSZXBvc0luVGVhbVJlcG9GaW5kZXJcIjtcbmltcG9ydCB7IEVkaXRvck9yUmV2aWV3ZXJQYXJhbWV0ZXJzIH0gZnJvbSBcIkBhdG9taXN0L2F1dG9tYXRpb24tY2xpZW50L29wZXJhdGlvbnMvY29tbW9uL3BhcmFtcy9CYXNlRWRpdG9yT3JSZXZpZXdlclBhcmFtZXRlcnNcIjtcbmltcG9ydCB7IEVkaXRPbmVPckFsbFBhcmFtZXRlcnMgfSBmcm9tIFwiQGF0b21pc3QvYXV0b21hdGlvbi1jbGllbnQvb3BlcmF0aW9ucy9jb21tb24vcGFyYW1zL0VkaXRPbmVPckFsbFBhcmFtZXRlcnNcIjtcbmltcG9ydCB7IEVkaXRvckNvbW1hbmREZXRhaWxzLCBlZGl0b3JIYW5kbGVyIH0gZnJvbSBcIkBhdG9taXN0L2F1dG9tYXRpb24tY2xpZW50L29wZXJhdGlvbnMvZWRpdC9lZGl0b3JUb0NvbW1hbmRcIjtcbmltcG9ydCB7IEFueVByb2plY3RFZGl0b3IgfSBmcm9tIFwiQGF0b21pc3QvYXV0b21hdGlvbi1jbGllbnQvb3BlcmF0aW9ucy9lZGl0L3Byb2plY3RFZGl0b3JcIjtcbmltcG9ydCB7IE1ha2VyIH0gZnJvbSBcIkBhdG9taXN0L2F1dG9tYXRpb24tY2xpZW50L3V0aWwvY29uc3RydWN0aW9uVXRpbHNcIjtcbmltcG9ydCB7IENhY2hpbmdQcm9qZWN0TG9hZGVyIH0gZnJvbSBcIi4uLy4uLy4uLy4uL2luZGV4XCI7XG5pbXBvcnQgeyBTdGF0dXMgfSBmcm9tIFwiLi4vLi4vLi4vLi4vdXRpbC9naXRodWIvZ2h1YlwiO1xuaW1wb3J0IHsgcHJvamVjdExvYWRlclJlcG9Mb2FkZXIgfSBmcm9tIFwiLi4vLi4vLi4vcmVwby9wcm9qZWN0TG9hZGVyUmVwb0xvYWRlclwiO1xuaW1wb3J0IHsgRW1wdHlQYXJhbWV0ZXJzIH0gZnJvbSBcIi4uLy4uL0VtcHR5UGFyYW1ldGVyc1wiO1xuaW1wb3J0IHsgRWRpdE1vZGVTdWdnZXN0aW9uIH0gZnJvbSBcIi4uL0VkaXRNb2RlU3VnZ2VzdGlvblwiO1xuaW1wb3J0IHsgdG9FZGl0b3JPclJldmlld2VyUGFyYW1ldGVyc01ha2VyIH0gZnJvbSBcIi4uL2VkaXRvckNvbW1hbmRcIjtcbmltcG9ydCB7IGNoYXR0eUVkaXRvckZhY3RvcnkgfSBmcm9tIFwiLi4vZWRpdG9yV3JhcHBlcnNcIjtcbmltcG9ydCB7IE5ld0JyYW5jaFdpdGhTdGF0dXMgfSBmcm9tIFwiLi9OZXdCcmFuY2hXaXRoU3RhdHVzXCI7XG5cbmV4cG9ydCBjb25zdCBEcnlSdW5Db250ZXh0ID0gXCJhdG9taXN0LWRyeS1ydW5cIjtcblxuLyoqXG4gKiBXcmFwIGFuIGVkaXRvciBpbiBhIGNvbW1hbmQgaGFuZGxlciB0aGF0IHNldHMgYSBkcnkgcnVuIHN0YXR1cy5cbiAqIFR5cGljYWxseSB1c2VkIHRvIHdhaXQgZm9yIGJ1aWxkIHN1Y2Nlc3Mgb3IgZmFpbHVyZSwgcmVzdWx0aW5nIGluIGlzc3VlIG9yIFBSLlxuICogQWxsb3dzIHVzZSBvZiBjdXN0b20gcGFyYW1ldGVycyBhcyBpbiBlZGl0b3JDb21tYW5kXG4gKiBUYXJnZXRpbmcgKHRhcmdldHMgcHJvcGVydHkpIGlzIGhhbmRsZWQgYXV0b21hdGljYWxseSBpZiB0aGUgcGFyYW1ldGVyc1xuICogZG8gbm90IGltcGxlbWVudCBUYXJnZXRzUGFyYW1zXG4gKiBAcGFyYW0gZWRkIGZ1bmN0aW9uIHRvIG1ha2UgYSBmcmVzaCBlZGl0b3IgaW5zdGFuY2UgZnJvbSB0aGUgcGFyYW1zXG4gKiBAcGFyYW0gbmFtZSBlZGl0b3IgbmFtZVxuICogQHBhcmFtIHBhcmFtc01ha2VyIHBhcmFtZXRlcnMgZmFjdG9yeSwgdHlwaWNhbGx5IHRoZSBuYW1lIG9mIGEgY2xhc3Mgd2l0aCBhIG5vIGFyZyBjb25zdHJ1Y3RvclxuICogQHBhcmFtIGRldGFpbHMgb3B0aW9uYWwgZGV0YWlscyB0byBjdXN0b21pemUgYmVoYXZpb3JcbiAqIEFkZCBpbnRlbnQgXCJ0cnkgZWRpdCA8bmFtZT5cIlxuICovXG5leHBvcnQgZnVuY3Rpb24gZHJ5UnVuRWRpdG9yPFBBUkFNUyA9IEVtcHR5UGFyYW1ldGVycz4oZWRkOiAocGFyYW1zOiBQQVJBTVMpID0+IEFueVByb2plY3RFZGl0b3IsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zTWFrZXI6IE1ha2VyPFBBUkFNUz4gPSBFbXB0eVBhcmFtZXRlcnMgYXMgTWFrZXI8UEFSQU1TPixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBzdHJpbmcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGV0YWlsczogUGFydGlhbDxFZGl0b3JDb21tYW5kRGV0YWlsczxQQVJBTVM+PiA9IHt9KTogSGFuZGxlQ29tbWFuZDxFZGl0T25lT3JBbGxQYXJhbWV0ZXJzPiB7XG4gICAgaWYgKCEhZGV0YWlscy5lZGl0TW9kZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDYW5ub3Qgc2V0IGVkaXRNb2RlIGZvciBkcnlSdW5FZGl0b3JcIik7XG4gICAgfVxuICAgIGNvbnN0IGRldGFpbHNUb1VzZTogRWRpdG9yQ29tbWFuZERldGFpbHMgPSB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBkZXRhaWxzLmRlc2NyaXB0aW9uIHx8IG5hbWUsXG4gICAgICAgIGludGVudDogYHRyeSBlZGl0ICR7bmFtZX1gLFxuICAgICAgICByZXBvRmluZGVyOiBhbGxSZXBvc0luVGVhbSgpLFxuICAgICAgICByZXBvTG9hZGVyOlxuICAgICAgICAgICAgcCA9PiBwcm9qZWN0TG9hZGVyUmVwb0xvYWRlcihuZXcgQ2FjaGluZ1Byb2plY3RMb2FkZXIoKSwgcC50YXJnZXRzLmNyZWRlbnRpYWxzKSxcbiAgICAgICAgZWRpdE1vZGU6ICgocGFyYW1zOiBQQVJBTVMgJiBFZGl0b3JPclJldmlld2VyUGFyYW1ldGVycykgPT4ge1xuICAgICAgICAgICAgbG9nZ2VyLmluZm8oXCJBYm91dCB0byBjcmVhdGUgZWRpdCBtb2RlIGZvciBkcnkgcnVuIGVkaXRvcjogcGFyYW1zPSVqXCIsIHBhcmFtcyk7XG4gICAgICAgICAgICBjb25zdCBkZXNjcmlwdGlvbiA9IChwYXJhbXMgYXMgYW55IGFzIEVkaXRNb2RlU3VnZ2VzdGlvbikuZGVzaXJlZFB1bGxSZXF1ZXN0VGl0bGUgfHwgZGV0YWlscy5kZXNjcmlwdGlvbiB8fCBuYW1lO1xuICAgICAgICAgICAgY29uc3Qgc3RhdHVzOiBTdGF0dXMgPSB7XG4gICAgICAgICAgICAgICAgY29udGV4dDogRHJ5UnVuQ29udGV4dCxcbiAgICAgICAgICAgICAgICB0YXJnZXRfdXJsOiBcImh0dHBzOi8vd3d3LmF0b21pc3QuY29tXCIsXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb24sXG4gICAgICAgICAgICAgICAgc3RhdGU6IFwicGVuZGluZ1wiLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiBuZXcgTmV3QnJhbmNoV2l0aFN0YXR1cyhcbiAgICAgICAgICAgICAgICAocGFyYW1zIGFzIGFueSBhcyBFZGl0TW9kZVN1Z2dlc3Rpb24pLmRlc2lyZWRCcmFuY2hOYW1lIHx8IGBlZGl0LSR7bmFtZX0tJHtEYXRlLm5vdygpfWAsXG4gICAgICAgICAgICAgICAgdG9BdG9taXN0Q29tbWl0TWVzc2FnZSgocGFyYW1zIGFzIGFueSBhcyBFZGl0TW9kZVN1Z2dlc3Rpb24pLmRlc2lyZWRDb21taXRNZXNzYWdlIHx8IGRlc2NyaXB0aW9uLnN1YnN0cigwLCA1MCksIGRlc2NyaXB0aW9uKSxcbiAgICAgICAgICAgICAgICBwYXJhbXMudGFyZ2V0cy5jcmVkZW50aWFscyxcbiAgICAgICAgICAgICAgICBzdGF0dXMpO1xuICAgICAgICB9KSxcbiAgICAgICAgLi4uZGV0YWlscyxcbiAgICB9O1xuICAgIHJldHVybiBlZGl0b3JIYW5kbGVyKFxuICAgICAgICBjaGF0dHlFZGl0b3JGYWN0b3J5KG5hbWUsIGVkZCkgYXMgYW55LFxuICAgICAgICB0b0VkaXRvck9yUmV2aWV3ZXJQYXJhbWV0ZXJzTWFrZXIocGFyYW1zTWFrZXIpLFxuICAgICAgICBuYW1lLFxuICAgICAgICBkZXRhaWxzVG9Vc2UpO1xufVxuXG5mdW5jdGlvbiB0b0F0b21pc3RDb21taXRNZXNzYWdlKGJhc2U6IHN0cmluZywgZGVzY3JpcHRpb246IHN0cmluZykge1xuICAgIHJldHVybiBgJHtiYXNlfVxcblxcblthdG9taXN0XSAke2Rlc2NyaXB0aW9ufWA7XG59XG4iXX0=